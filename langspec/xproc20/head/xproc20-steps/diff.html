<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><!--Generated by the DeltaXML.com xhtml-outfilter.xsl--><!--Using XSL Processor: Saxonica--><title>XProc 2.0: Standard Step Library</title><meta charset="utf-8" /><meta name="generator" content="DocBook XSL 2.0 Stylesheets V2.0.7" /><link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/base.css" /><link rel="stylesheet" type="text/css" href="base.css" /><link rel="stylesheet" type="text/css" href="xproc.css" /><link rel="alternate" title="XML" href="langsteps.xml" /><link rel="alternate" title="ChangeLog" href="changelog.html" /><link rel="alternate" title="Latest editor's draft" href="http://www.w3.org/XML/XProc/docs/langspec.html" /><link rel="alternate" title="Latest Public Working Draft" href="http://www.w3.org/TR/xproc/" /><script type="text/javascript" src="https://docbook.github.com/release/2.0.5/base/js/dbmodnizr.js"></script><link href="https://docbook.github.com/release/2.0.5/base/css/prism.css" rel="stylesheet" /><link href="https://docbook.github.com/release/2.0.5/base/css/db-prism.css" rel="stylesheet" /><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><script type="text/javascript">
            function view(doc) {
              var allSpans=document.getElementsByTagName("*");
              if(doc=="old") {
                for(i=0;i!=allSpans.length;i++) {
                  var displayType= "inline";
                  if (allSpans[i].localName == "tr") {
                    displayType= "table-row";
                  } else if (allSpans[i].localName == "li") {
                    displayType= "list-item";
                  }
                  var name=allSpans[i].className;
                  if(name=="deltaxml-new" || name=="deltaxml-new-img" || name=="deltaxml-new-format" || name=="add_version" || name=="modify_version") {
                    allSpans[i].style.display="none";
                  } else if (name=="deltaxml-old" || name=="deltaxml-old-img" || name=="deltaxml-old-format" || name=="delete_version") {
                    allSpans[i].style.display= displayType;
                    allSpans[i].style.background="#FFF";
                    //need to take border off images
                    var allImgs=allSpans[i].getElementsByTagName("img");
                    for(j=0;j!=allImgs.length;j++) {
                      allImgs[j].style.border="none";
                    }
                  }
                }
              } else if(doc=="new") {
                for(i=0;i!=allSpans.length;i++) {
                  var displayType= "inline";
                  if (allSpans[i].localName == "tr") {
                    displayType= "table-row";
                  } else if (allSpans[i].localName == "li") {
                    displayType= "list-item";
                  }
                  var name=allSpans[i].className;
                  if(name=="deltaxml-new" || name=="deltaxml-new-img" || name=="deltaxml-new-format" || name=="add_version") {
                    allSpans[i].style.display= displayType;
                    allSpans[i].style.background="#FFF";
                    //need to take border off images
                    var allImgs=allSpans[i].getElementsByTagName("img");
                    for(j=0;j!=allImgs.length;j++) {
                      allImgs[j].style.border="none";
                    }
                  } else if (name=="deltaxml-old" || name=="deltaxml-old-img" || name=="deltaxml-old-format" || name=="delete_version" || name=="modify_version") {
                    allSpans[i].style.display="none";
                   }
                }
              } else if(doc=="both") {
                for(i=0;i!=allSpans.length;i++) {
                  var displayType= "inline";
                  if (allSpans[i].localName == "tr") {
                    displayType= "table-row";
                  } else if (allSpans[i].localName == "li") {
                    displayType= "list-item";
                  }
                  var name=allSpans[i].className;
                  if(name=="deltaxml-new" || name=="deltaxml-new-format" || name=="deltaxml-new-img") {
                    allSpans[i].style.display= displayType;
                    allSpans[i].style.background="#90EE90";
                    //need to add border to images
                    var allImgs=allSpans[i].getElementsByTagName("img");
                    for(j=0;j!=allImgs.length;j++) {
                      allImgs[j].style.border="2px solid green";
                    }
                  } else if(name=="deltaxml-old" || name=="deltaxml-old-format" || name=="deltaxml-old-img") {
                    allSpans[i].style.display= displayType;
                    allSpans[i].style.background="#FF5555";
                    //need to add border to images
                    var allImgs=allSpans[i].getElementsByTagName("img");
                    for(j=0;j!=allImgs.length;j++) {
                      allImgs[j].style.border="2px solid red";
                    }
                  } else if (name=="add_version" || name=="delete_version") {
                    allSpans[i].style.display="none";
                  } else if (name=="modify_version") {
                    allSpans[i].style.display= displayType;
                  }
                }
              }
            }
  
        </script></head><body><div style="position:fixed; clear:both; top:0px"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a></p></div><div class="specification"><div id="spec.head" class="head"><p><a href="http://www.w3.org/"><img height="48" width="72" alt="W3C" src="http://www.w3.org/Icons/w3c_home" /></a></p><h1><div class="title">XProc 2.0: Standard Step Library</div></h1><h2>W3C Editor's Draft <time datetime="2014-12-11T14:20:53Z"><span class="deltaxml-old" style="background:#FF5555">26 November</span><span class="deltaxml-new" style="background:#90EE90">11 December</span> 2014 at <span class="deltaxml-old" style="background:#FF5555">16:03</span><span class="deltaxml-new" style="background:#90EE90">14:20</span> UTC (<a href="https://github.com/xproc/specification/commit/e6a79ea06f421adc29bef9e98580b4af8fecec22">build <span class="deltaxml-old" style="background:#FF5555">157</span><span class="deltaxml-new" style="background:#90EE90">159</span></a>)</time></h2><dl><dt>This Version:</dt><dd><a href="https://xproc.github.io/specification/langspec">https://xproc.github.io/specification/langspec</a></dd><dt>Latest Version:</dt><dd><a href="http://www.w3.org/TR/xproc20-steps/">http://www.w3.org/TR/xproc20-steps/</a></dd><dt>Editors:</dt><dd><span class="personname">Norman Walsh</span>, <span class="orgname">MarkLogic Corporation</span><code class="email">&lt;<a href="mailto:norman.walsh@marklogic.com">norman.walsh@marklogic.com</a>&gt;</code></dd><dd><span class="personname">Alex Milowski</span>, <span class="orgname">Invited expert</span><code class="email">&lt;<a href="mailto:alex@milowski.org">alex@milowski.org</a>&gt;</code></dd><dd><span class="personname">Henry S. Thompson</span>, <span class="orgname">University of Edinburgh</span><code class="email">&lt;<a href="mailto:ht@inf.ed.ac.uk">ht@inf.ed.ac.uk</a>&gt;</code></dd><dt>Repository:</dt><dd><a href="http://github.com/xproc/specification">This specification on GitHub</a></dd><dd><a href="http://github.com/xproc/specification/issues">Report an issue</a></dd><dt>Changes:</dt><dd><a href="diff.html">Diff against current “status quo” draft</a></dd><dd><a href="http://github.com/xproc/specification/commits/">Commits for this specification</a></dd></dl><p>This document is also available in these non-normative formats: <a href="langsteps.xml">XML</a>, <a href="changelog.html">ChangeLog</a>, automatic <a href="diff.html">change markup</a> from the previous draft courtesy of <a href="http://www.deltaxml.com/">DeltaXML</a>.</p><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2010 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr /><div class="abstract"><h2>Abstract</h2><p>This specification describes the standard step vocabulary of <em class="citetitle">XProc 2.0: An XML Pipeline Language</em>.</p></div><div class="status"><h2>Status of this Document</h2><p><strong>This document is an editor's draft that has no official standing.</strong></p><p><em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current W3C publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/">W3C technical reports index</a> at http://www.w3.org/TR/.</em></p><p>This document is an editor's draft without normative standing. This document is a product of the <a href="http://www.w3.org/XML/Processing/">XML Processing Model Working Group</a> as part of the W3C <a href="http://www.w3.org/XML/Activity">XML Activity</a>. </p><p>Please report errors in this document by <a href="https://github.com/xproc/specification/issues">raising issues</a> on the <a href="https://github.com/xproc/specification">specification repository</a>.</p><p>There is an <a href="http://www.w3.org/XML/XProc/2010/02/ir.html">Implementation Report for XProc 1.0</a>. It documents the performance of implementations against the <a href="http://tests.xproc.org/">XProc 1.0 Test Suite</a>. At this time, there are no such reports for XProc 2.0. </p><p>This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>. W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/38398/status">public list of any patent disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.</p></div></div><hr /><div class="toc"><h2 id="TableOfContents">Table of Contents</h2><dl class="toc"><dt><span>1 <a href="#introduction">Introduction</a></span></dt><dt><span><span class="deltaxml-old" style="background:#FF5555">2 </span><a href="#std-components"><span class="deltaxml-old" style="background:#FF5555">Standard Step Library</span></a></span></dt><dd><dl class="toc"><dt><span style="display: none;" class="delete_version"><span>2.1 <a href="#std-required">Required Steps</a></span></span><span style="display: none;" class="add_version"><span>1.1 <a href="#std-required">Required Steps</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1</span><span class="deltaxml-new" style="background:#90EE90">1.1</span> <a href="#std-required">Required Steps</a></span></span></dt><dd><dl class="toc"><dt><span style="display: none;" class="delete_version"><span>2.1.1 <a href="#c.add-attribute">p:add-attribute</a></span></span><span style="display: none;" class="add_version"><span>1.1.1 <a href="#c.add-attribute">p:add-attribute</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.1</span><span class="deltaxml-new" style="background:#90EE90">1.1.1</span> <a href="#c.add-attribute">p:add-attribute</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.2 <a href="#c.add-xml-base">p:add-xml-base</a></span></span><span style="display: none;" class="add_version"><span>1.1.2 <a href="#c.add-xml-base">p:add-xml-base</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.2</span><span class="deltaxml-new" style="background:#90EE90">1.1.2</span> <a href="#c.add-xml-base">p:add-xml-base</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.3 <a href="#c.cast-content-type">p:cast-content-type</a></span></span><span style="display: none;" class="add_version"><span>1.1.3 <a href="#c.cast-content-type">p:cast-content-type</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.3</span><span class="deltaxml-new" style="background:#90EE90">1.1.3</span> <a href="#c.cast-content-type">p:cast-content-type</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.4 <a href="#c.compare">p:compare</a></span></span><span style="display: none;" class="add_version"><span>1.1.4 <a href="#c.compare">p:compare</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.4</span><span class="deltaxml-new" style="background:#90EE90">1.1.4</span> <a href="#c.compare">p:compare</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.5 <a href="#c.count">p:count</a></span></span><span style="display: none;" class="add_version"><span>1.1.5 <a href="#c.count">p:count</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.5</span><span class="deltaxml-new" style="background:#90EE90">1.1.5</span> <a href="#c.count">p:count</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.6 <a href="#c.delete">p:delete</a></span></span><span style="display: none;" class="add_version"><span>1.1.6 <a href="#c.delete">p:delete</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.6</span><span class="deltaxml-new" style="background:#90EE90">1.1.6</span> <a href="#c.delete">p:delete</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.7 <a href="#c.directory-list">p:directory-list</a></span></span><span style="display: none;" class="add_version"><span>1.1.7 <a href="#c.directory-list">p:directory-list</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.7</span><span class="deltaxml-new" style="background:#90EE90">1.1.7</span> <a href="#c.directory-list">p:directory-list</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.8 <a href="#c.error">p:error</a></span></span><span style="display: none;" class="add_version"><span>1.1.8 <a href="#c.error">p:error</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.8</span><span class="deltaxml-new" style="background:#90EE90">1.1.8</span> <a href="#c.error">p:error</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.9 <a href="#c.escape-markup">p:escape-markup</a></span></span><span style="display: none;" class="add_version"><span>1.1.9 <a href="#c.escape-markup">p:escape-markup</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.9</span><span class="deltaxml-new" style="background:#90EE90">1.1.9</span> <a href="#c.escape-markup">p:escape-markup</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.10 <a href="#c.filter">p:filter</a></span></span><span style="display: none;" class="add_version"><span>1.1.10 <a href="#c.filter">p:filter</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.10</span><span class="deltaxml-new" style="background:#90EE90">1.1.10</span> <a href="#c.filter">p:filter</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.11 <a href="#c.http-request">p:http-request</a></span></span><span style="display: none;" class="add_version"><span>1.1.11 <a href="#c.http-request">p:http-request</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.11</span><span class="deltaxml-new" style="background:#90EE90">1.1.11</span> <a href="#c.http-request">p:http-request</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.12 <a href="#c.identity">p:identity</a></span></span><span style="display: none;" class="add_version"><span>1.1.12 <a href="#c.identity">p:identity</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.12</span><span class="deltaxml-new" style="background:#90EE90">1.1.12</span> <a href="#c.identity">p:identity</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.13 <a href="#c.insert">p:insert</a></span></span><span style="display: none;" class="add_version"><span>1.1.13 <a href="#c.insert">p:insert</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.13</span><span class="deltaxml-new" style="background:#90EE90">1.1.13</span> <a href="#c.insert">p:insert</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.14 <a href="#c.label-elements">p:label-elements</a></span></span><span style="display: none;" class="add_version"><span>1.1.14 <a href="#c.label-elements">p:label-elements</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.14</span><span class="deltaxml-new" style="background:#90EE90">1.1.14</span> <a href="#c.label-elements">p:label-elements</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.15 <a href="#c.load">p:load</a></span></span><span style="display: none;" class="add_version"><span>1.1.15 <a href="#c.load">p:load</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.15</span><span class="deltaxml-new" style="background:#90EE90">1.1.15</span> <a href="#c.load">p:load</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.16 <a href="#c.make-absolute-uris">p:make-absolute-uris</a></span></span><span style="display: none;" class="add_version"><span>1.1.16 <a href="#c.make-absolute-uris">p:make-absolute-uris</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.16</span><span class="deltaxml-new" style="background:#90EE90">1.1.16</span> <a href="#c.make-absolute-uris">p:make-absolute-uris</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.17 <a href="#c.namespace-rename">p:namespace-rename</a></span></span><span style="display: none;" class="add_version"><span>1.1.17 <a href="#c.namespace-rename">p:namespace-rename</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.17</span><span class="deltaxml-new" style="background:#90EE90">1.1.17</span> <a href="#c.namespace-rename">p:namespace-rename</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.18 <a href="#c.pack">p:pack</a></span></span><span style="display: none;" class="add_version"><span>1.1.18 <a href="#c.pack">p:pack</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.18</span><span class="deltaxml-new" style="background:#90EE90">1.1.18</span> <a href="#c.pack">p:pack</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.19 <a href="#c.parameters">p:parameters</a></span></span><span style="display: none;" class="add_version"><span>1.1.19 <a href="#c.parameters">p:parameters</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.19</span><span class="deltaxml-new" style="background:#90EE90">1.1.19</span> <a href="#c.parameters">p:parameters</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.20 <a href="#c.rename">p:rename</a></span></span><span style="display: none;" class="add_version"><span>1.1.20 <a href="#c.rename">p:rename</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.20</span><span class="deltaxml-new" style="background:#90EE90">1.1.20</span> <a href="#c.rename">p:rename</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.21 <a href="#c.replace">p:replace</a></span></span><span style="display: none;" class="add_version"><span>1.1.21 <a href="#c.replace">p:replace</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.21</span><span class="deltaxml-new" style="background:#90EE90">1.1.21</span> <a href="#c.replace">p:replace</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.22 <a href="#c.set-attributes">p:set-attributes</a></span></span><span style="display: none;" class="add_version"><span>1.1.22 <a href="#c.set-attributes">p:set-attributes</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.22</span><span class="deltaxml-new" style="background:#90EE90">1.1.22</span> <a href="#c.set-attributes">p:set-attributes</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.23 <a href="#c.set-properties">p:set-properties</a></span></span><span style="display: none;" class="add_version"><span>1.1.23 <a href="#c.set-properties">p:set-properties</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.23</span><span class="deltaxml-new" style="background:#90EE90">1.1.23</span> <a href="#c.set-properties">p:set-properties</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.24 <a href="#c.sink">p:sink</a></span></span><span style="display: none;" class="add_version"><span>1.1.24 <a href="#c.sink">p:sink</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.24</span><span class="deltaxml-new" style="background:#90EE90">1.1.24</span> <a href="#c.sink">p:sink</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.25 <a href="#c.split-sequence">p:split-sequence</a></span></span><span style="display: none;" class="add_version"><span>1.1.25 <a href="#c.split-sequence">p:split-sequence</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.25</span><span class="deltaxml-new" style="background:#90EE90">1.1.25</span> <a href="#c.split-sequence">p:split-sequence</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.26 <a href="#c.store">p:store</a></span></span><span style="display: none;" class="add_version"><span>1.1.26 <a href="#c.store">p:store</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.26</span><span class="deltaxml-new" style="background:#90EE90">1.1.26</span> <a href="#c.store">p:store</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.27 <a href="#c.string-replace">p:string-replace</a></span></span><span style="display: none;" class="add_version"><span>1.1.27 <a href="#c.string-replace">p:string-replace</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.27</span><span class="deltaxml-new" style="background:#90EE90">1.1.27</span> <a href="#c.string-replace">p:string-replace</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.28 <a href="#c.unescape-markup">p:unescape-markup</a></span></span><span style="display: none;" class="add_version"><span>1.1.28 <a href="#c.unescape-markup">p:unescape-markup</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.28</span><span class="deltaxml-new" style="background:#90EE90">1.1.28</span> <a href="#c.unescape-markup">p:unescape-markup</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.29 <a href="#c.unwrap">p:unwrap</a></span></span><span style="display: none;" class="add_version"><span>1.1.29 <a href="#c.unwrap">p:unwrap</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.29</span><span class="deltaxml-new" style="background:#90EE90">1.1.29</span> <a href="#c.unwrap">p:unwrap</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.30 <a href="#c.wrap">p:wrap</a></span></span><span style="display: none;" class="add_version"><span>1.1.30 <a href="#c.wrap">p:wrap</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.30</span><span class="deltaxml-new" style="background:#90EE90">1.1.30</span> <a href="#c.wrap">p:wrap</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.31 <a href="#c.wrap-sequence">p:wrap-sequence</a></span></span><span style="display: none;" class="add_version"><span>1.1.31 <a href="#c.wrap-sequence">p:wrap-sequence</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.31</span><span class="deltaxml-new" style="background:#90EE90">1.1.31</span> <a href="#c.wrap-sequence">p:wrap-sequence</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.32 <a href="#c.xinclude">p:xinclude</a></span></span><span style="display: none;" class="add_version"><span>1.1.32 <a href="#c.xinclude">p:xinclude</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.32</span><span class="deltaxml-new" style="background:#90EE90">1.1.32</span> <a href="#c.xinclude">p:xinclude</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.1.33 <a href="#c.xslt">p:xslt</a></span></span><span style="display: none;" class="add_version"><span>1.1.33 <a href="#c.xslt">p:xslt</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.1.33</span><span class="deltaxml-new" style="background:#90EE90">1.1.33</span> <a href="#c.xslt">p:xslt</a></span></span></dt></dl></dd><dt><span style="display: none;" class="delete_version"><span>2.2 <a href="#std-optional">Optional Steps</a></span></span><span style="display: none;" class="add_version"><span>1.2 <a href="#std-optional">Optional Steps</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2</span><span class="deltaxml-new" style="background:#90EE90">1.2</span> <a href="#std-optional">Optional Steps</a></span></span></dt><dd><dl class="toc"><dt><span style="display: none;" class="delete_version"><span>2.2.1 <a href="#c.exec">p:exec</a></span></span><span style="display: none;" class="add_version"><span>1.2.1 <a href="#c.exec">p:exec</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.1</span><span class="deltaxml-new" style="background:#90EE90">1.2.1</span> <a href="#c.exec">p:exec</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.2 <a href="#c.hash">p:hash</a></span></span><span style="display: none;" class="add_version"><span>1.2.2 <a href="#c.hash">p:hash</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.2</span><span class="deltaxml-new" style="background:#90EE90">1.2.2</span> <a href="#c.hash">p:hash</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.3 <a href="#c.in-scope-names">p:in-scope-names</a></span></span><span style="display: none;" class="add_version"><span>1.2.3 <a href="#c.in-scope-names">p:in-scope-names</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.3</span><span class="deltaxml-new" style="background:#90EE90">1.2.3</span> <a href="#c.in-scope-names">p:in-scope-names</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.4 <a href="#c.template">p:template</a></span></span><span style="display: none;" class="add_version"><span>1.2.4 <a href="#c.template">p:template</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.4</span><span class="deltaxml-new" style="background:#90EE90">1.2.4</span> <a href="#c.template">p:template</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.5 <a href="#c.uuid">p:uuid</a></span></span><span style="display: none;" class="add_version"><span>1.2.5 <a href="#c.uuid">p:uuid</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.5</span><span class="deltaxml-new" style="background:#90EE90">1.2.5</span> <a href="#c.uuid">p:uuid</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.6 <a href="#c.validate-with-relax-ng">p:validate-with-relax-ng</a></span></span><span style="display: none;" class="add_version"><span>1.2.6 <a href="#c.validate-with-relax-ng">p:validate-with-relax-ng</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.6</span><span class="deltaxml-new" style="background:#90EE90">1.2.6</span> <a href="#c.validate-with-relax-ng">p:validate-with-relax-ng</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.7 <a href="#c.validate-with-schematron">p:validate-with-schematron</a></span></span><span style="display: none;" class="add_version"><span>1.2.7 <a href="#c.validate-with-schematron">p:validate-with-schematron</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.7</span><span class="deltaxml-new" style="background:#90EE90">1.2.7</span> <a href="#c.validate-with-schematron">p:validate-with-schematron</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.8 <a href="#c.validate-with-xml-schema">p:validate-with-xml-schema</a></span></span><span style="display: none;" class="add_version"><span>1.2.8 <a href="#c.validate-with-xml-schema">p:validate-with-xml-schema</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.8</span><span class="deltaxml-new" style="background:#90EE90">1.2.8</span> <a href="#c.validate-with-xml-schema">p:validate-with-xml-schema</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.9 <a href="#c.www-form-urldecode">p:www-form-urldecode</a></span></span><span style="display: none;" class="add_version"><span>1.2.9 <a href="#c.www-form-urldecode">p:www-form-urldecode</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.9</span><span class="deltaxml-new" style="background:#90EE90">1.2.9</span> <a href="#c.www-form-urldecode">p:www-form-urldecode</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.10 <a href="#c.www-form-urlencode">p:www-form-urlencode</a></span></span><span style="display: none;" class="add_version"><span>1.2.10 <a href="#c.www-form-urlencode">p:www-form-urlencode</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.10</span><span class="deltaxml-new" style="background:#90EE90">1.2.10</span> <a href="#c.www-form-urlencode">p:www-form-urlencode</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.11 <a href="#c.xquery">p:xquery</a></span></span><span style="display: none;" class="add_version"><span>1.2.11 <a href="#c.xquery">p:xquery</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.11</span><span class="deltaxml-new" style="background:#90EE90">1.2.11</span> <a href="#c.xquery">p:xquery</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>2.2.12 <a href="#c.xsl-formatter">p:xsl-formatter</a></span></span><span style="display: none;" class="add_version"><span>1.2.12 <a href="#c.xsl-formatter">p:xsl-formatter</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.2.12</span><span class="deltaxml-new" style="background:#90EE90">1.2.12</span> <a href="#c.xsl-formatter">p:xsl-formatter</a></span></span></dt></dl></dd><dt><span style="display: none;" class="delete_version"><span>2.3 <a href="#serialization-options">Serialization Options</a></span></span><span style="display: none;" class="add_version"><span>1.3 <a href="#serialization-options">Serialization Options</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">2.3</span><span class="deltaxml-new" style="background:#90EE90">1.3</span> <a href="#serialization-options">Serialization Options</a></span></span></dt></dl></dd><dt><span style="display: none;" class="delete_version"><span>3 <a href="#errors">Errors</a></span></span><span style="display: none;" class="add_version"><span>2 <a href="#errors">Errors</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">3</span><span class="deltaxml-new" style="background:#90EE90">2</span> <a href="#errors">Errors</a></span></span></dt><dd><dl class="toc"><dt><span style="display: none;" class="delete_version"><span>3.1 <a href="#static-errors">Static Errors</a></span></span><span style="display: none;" class="add_version"><span>2.1 <a href="#static-errors">Static Errors</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">3.1</span><span class="deltaxml-new" style="background:#90EE90">2.1</span> <a href="#static-errors">Static Errors</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>3.2 <a href="#dynamic-errors">Dynamic Errors</a></span></span><span style="display: none;" class="add_version"><span>2.2 <a href="#dynamic-errors">Dynamic Errors</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">3.2</span><span class="deltaxml-new" style="background:#90EE90">2.2</span> <a href="#dynamic-errors">Dynamic Errors</a></span></span></dt><dt><span style="display: none;" class="delete_version"><span>3.3 <a href="#step-errors">Step Errors</a></span></span><span style="display: none;" class="add_version"><span>2.3 <a href="#step-errors">Step Errors</a></span></span><span class="modify_version"><span><span class="deltaxml-old" style="background:#FF5555">3.3</span><span class="deltaxml-new" style="background:#90EE90">2.3</span> <a href="#step-errors">Step Errors</a></span></span></dt></dl></dd><dt><span>A <a href="#app.step-errors">Step Errors</a></span></dt><dt><span>B <a href="#references">References</a></span></dt><dd><dl class="toc"><dt><span>1 <a href="#normative-references">Normative References</a></span></dt><dt><span>2 <a href="#informative-references">Informative References</a></span></dt></dl></dd></dl></div><section class="section" id="introduction"><div class="section-titlepage"><h2>1 Introduction</h2></div><p><span class="deltaxml-old" style="background:#FF5555">…</span></p><p><span class="deltaxml-new" style="background:#90EE90">This specification describes the standard, atomic XProc steps of [</span><a href="#xproc20"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XProc 2.0</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. </span></p><p><span class="deltaxml-new" style="background:#90EE90">Some aspects of documents are generally unchanged by steps:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">When a step in this library produces an output document, the base URI of the output is the base URI of the step's primary input document unless the step's process explicitly sets an </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute or the step's description explicitly states how the base URI is constructed.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Unless otherwise specified, steps in this library do not modify the </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-new" style="background:#90EE90">document properties</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> of the documents that flow through them.</span></p></li></ul></div><p id="cv.result"><span class="deltaxml-new" style="background:#90EE90">Also, in this specification, several steps use this element for result information:</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:result&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:result&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">When a step uses an XPath to compute an option value, the XPath context is as defined in </span><span class="xspecref"><a href="../xproc20/#xpath-context"><span class="deltaxml-new" style="background:#90EE90">Section 2.7, “XPaths in XProc”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">When a step specifies a particular version of a technology, implementations </span><span class="rfc2119" id="introduction.8.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> implement that version or a subsequent version that is backwards compatible with that version. At user-option, they may implement other non-backwards compatible versions.</span></p><section id="std-required" class="section"><div class="section-titlepage"><h3><span class="deltaxml-new" style="background:#90EE90">1.1 Required Steps</span></h3></div><p><span class="deltaxml-new" style="background:#90EE90">This section describes standard steps that must be supported by any conforming processor.</span></p><section id="c.add-attribute" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.1 p:add-attribute</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:add-attribute</span></code><span class="deltaxml-new" style="background:#90EE90"> step adds a single attribute to a set of matching elements. The input document specified on the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> is processed for matches specified by the match pattern in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option. For each of these matches, the attribute whose name is specified by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option is set to the attribute value specified by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-value</span></code><span class="deltaxml-new" style="background:#90EE90"> option. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The resulting document is produced on the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> output port and consists of a exact copy of the input with the exception of the matched elements. Each of the matched elements is copied to the output with the addition of the specified attribute with the specified value. </span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:add-attribute</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute-name</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">            </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute-value</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.add-attribute.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the match pattern does not match an element.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.add-attribute.6.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">attribute-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the attribute. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">attribute-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the attribute name. </span><a name="err.inline.D0034"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon. The corresponding expanded name is used to construct the attribute.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-value</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.add-attribute.7.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a legal attribute value according to XML.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If an attribute with the same name as the expanded name from the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option exists on the matched element, the value specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-value</span></code><span class="deltaxml-new" style="background:#90EE90"> option is used to set the value of that existing attribute. That is, the value of the existing attribute is changed to the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-value</span></code><span class="deltaxml-new" style="background:#90EE90"> value. </span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">If multiple attributes need to be set on the same element(s), the </span><a href="#c.set-attributes"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:set-attributes</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step can be used to set them all at once.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">This step cannot be used to add namespace declarations. </span><a name="err.inline.C0059"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0059"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0059</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the QName value in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option uses the prefix “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xmlns</span></code><span class="deltaxml-new" style="background:#90EE90">” or any other prefix that resolves to the namespace name “</span><code class="uri"><span class="deltaxml-new" style="background:#90EE90">http://www.w3.org/2000/xmlns/</span></code><span class="deltaxml-new" style="background:#90EE90">”. Note, however, that while namespace declarations cannot be added explicitly by this step, adding an attribute whose name is in a namespace for which there is no namespace declaration in scope on the matched element may result in a namespace binding being added by </span><span class="xspecref"><a href="../xproc20/#namespace-fixup"><span class="deltaxml-new" style="background:#90EE90">Section 2.5.1, “Namespace Fixup on XML Outputs”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If an attribute named </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> is added or changed, the base URI of the element </span><span class="rfc2119" id="c.add-attribute.11.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p></section><section id="c.add-xml-base" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.2 p:add-xml-base</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:add-xml-base</span></code><span class="deltaxml-new" style="background:#90EE90"> step exposes the base URI via explicit </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes. The input document from the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port is replicated to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port with </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes added to or corrected on each element as specified by the options on this step.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:add-xml-base</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">all</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">relative</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">   </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">all</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.add-xml-base.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">relative</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.add-xml-base.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p><p><a name="err.inline.C0058"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0058"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0058</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">all</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">relative</span></code><span class="deltaxml-new" style="background:#90EE90"> options are </span><em><span class="deltaxml-new" style="background:#90EE90">both</span></em><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:add-xml-base</span></code><span class="deltaxml-new" style="background:#90EE90"> step modifies its input as follows:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">For the document element: force the element to have an </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute with the document's [base URI] property's value as its value.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">For other elements:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">all</span></code><span class="deltaxml-new" style="background:#90EE90"> option has the value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, force the element to have an </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute with the element's [base URI] value as its value.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">If the element's [base URI] is different from the its parent's [base URI], force the element to have an </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute with the following value: if the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">relative</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, a string which, when resolved against the parent's [base URI], will give the element's [base URI], otherwise the element's [base URI].</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, if there is an </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute present, remove it. </span></p></li></ul></div></li></ul></div></section><section id="c.cast-content-type" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.3 p:cast-content-type</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:cast-content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> step changes the media type of its input.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:cast-content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The input document is transformed from one media type to another. </span><a name="err.inline.C1002"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1002"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1002</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the supplied </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> is not a valid media type of the form “</span><code class="literal"><em class="replaceable"><code><span class="deltaxml-new" style="background:#90EE90">type</span></code></em><span class="deltaxml-new" style="background:#90EE90">/</span><em class="replaceable"><code><span class="deltaxml-new" style="background:#90EE90">subtype</span></code></em><span class="deltaxml-new" style="background:#90EE90">+</span><em class="replaceable"><code><span class="deltaxml-new" style="background:#90EE90">ext</span></code></em></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">Casting from one XML media type to another simply changes the “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90">” </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-new" style="background:#90EE90">document property</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></li><li id="c.data"><p><span class="deltaxml-new" style="background:#90EE90">Casting from a non-XML media type to an XML media type produces an XML document with a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document element. The original media type will be preserved in the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute on the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:data</span><br /><span class="deltaxml-new" style="background:#90EE90">  content-type? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  charset? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  encoding? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:data&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The content of the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element is the base64 encoded representation of the non-XML content.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Casting from an XML media type to a non-XML media type </span><span class="rfc2119" id="c.cast-content-type.5.3.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> support the case where the input document is a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document. The resulting document will have the specified media type and a </span><em class="glossterm"><a href="../xproc20/#dt-representation"><span class="deltaxml-new" style="background:#90EE90">representation</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> that is the content of the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element after decoding the base64 encoded content.</span></p><p><a name="err.inline.C1004"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1004"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1004</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> contains content is not a valid base64 string.</span></p><p><a name="err.inline.C1005"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1005"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1005</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element does not have a </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute.</span></p><p><a name="err.inline.C1006"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1006"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1006</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> is supplied and is not the same as the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> specified on the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element. </span></p><p><a name="impl-1"></a><span class="deltaxml-new" style="background:#90EE90">Casting from an XML media type to a non-XML media type when the input document is not a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><a name="impl-2"></a><span class="deltaxml-new" style="background:#90EE90">What happens when one non-XML media type is cast to another non-XML media type is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span><a name="err.inline.C1003"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1003"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1003</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:cast-content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> step cannot perform the requested cast.</span></p></li></ul></div><p><a name="err.inline.C1007"></a><span class="deltaxml-new" style="background:#90EE90">In all cases except when the input document is a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:data</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element, it is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1007"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1007</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> is not supplied. </span></p></section><section id="c.compare" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.4 p:compare</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:compare</span></code><span class="deltaxml-new" style="background:#90EE90"> step compares two documents for equality.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:compare</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">alternate</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">fail-if-not-equal</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">fail-if-not-equal</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.compare.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p><p><span class="deltaxml-new" style="background:#90EE90">This step takes single documents on each of two ports and compares them using the </span><code class="function"><span class="deltaxml-new" style="background:#90EE90">fn:deep-equal</span></code><span class="deltaxml-new" style="background:#90EE90"> (as defined in [</span><a href="#xpath-functions"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XPath 2.0 Functions and Operators</span></span></a><span class="deltaxml-new" style="background:#90EE90">]). </span><a name="err.inline.C0019"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0019"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0019</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the documents are not equal, and the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">fail-if-not-equal</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">. If the documents are equal, or if the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">fail-if-not-equal</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">, a </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:result</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document is produced with contents </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90"> if the documents are equal, otherwise </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></section><section id="c.count" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.5 p:count</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:count</span></code><span class="deltaxml-new" style="background:#90EE90"> step counts the number of documents in the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> input sequence and returns a single document on </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> containing that number. The generated document contains a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:result</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element whose contents is the string representation of the number of documents in the sequence.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:count</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">limit</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">0</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">           </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">limit</span></code><span class="deltaxml-new" style="background:#90EE90"> option is specified and is greater than zero, the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:count</span></code><span class="deltaxml-new" style="background:#90EE90"> step will count at most that many documents. This provides a convenient mechanism to discover, for example, if a sequence consists of more than 1 document, without requiring every single document to be buffered before processing can continue.</span></p></section><section id="c.delete" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.6 p:delete</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:delete</span></code><span class="deltaxml-new" style="background:#90EE90"> step deletes items specified by a match pattern from the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> input document and produces the resulting document, with the deleted items removed, on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:delete</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.delete.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. A match pattern may match multiple items to be deleted.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If an element is selected by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option, the entire subtree rooted at that element is deleted.</span></p><p><span class="deltaxml-new" style="background:#90EE90">This step cannot be used to remove namespaces. </span><a name="err.inline.C0062"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0062"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0062</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option matches a namespace node. Also, note that deleting an attribute named </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> does not change the base URI of the element on which it occurred.</span></p></section><section id="c.directory-list" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.7 p:directory-list</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:directory-list</span></code><span class="deltaxml-new" style="background:#90EE90"> step produces a list of the contents of a specified directory.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:directory-list</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">path</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">include-filter</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">RegularExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">exclude-filter</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">RegularExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">path</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.directory-list.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. It is interpreted as an IRI reference. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:directory-list</span></code><span class="deltaxml-new" style="background:#90EE90"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-new" style="background:#90EE90">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> value).</span></p><p><a name="err.inline.C0017"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0017"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0017</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the absolute path does not identify a directory. </span><a name="err.inline.C0012"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0012"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0012</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the contents of the directory path are not available to the step due to access restrictions in the environment in which the pipeline is run.</span></p><p><a name="impl-3"></a><span class="deltaxml-new" style="background:#90EE90">Conformant processors </span><span class="rfc2119" id="c.directory-list.6.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> support directory paths whose scheme is </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">file</span></code><span class="deltaxml-new" style="background:#90EE90">. It is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> what other schemes are supported by </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:directory-list</span></code><span class="deltaxml-new" style="background:#90EE90">, and what the interpretation of 'directory', 'file' and 'contents' is for those schemes. </span></p><p><span class="deltaxml-new" style="background:#90EE90">If present, the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">include-filter</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">exclude-filter</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.directory-list.7.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a regular expression as specified in [</span><a href="#xpath-functions"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XPath 2.0 Functions and Operators</span></span></a><span class="deltaxml-new" style="background:#90EE90">], section 7.61 “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">Regular Expression Syntax</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">include-filter</span></code><span class="deltaxml-new" style="background:#90EE90"> pattern matches a directory entry's name, the entry is included in the output. If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">exclude-filter</span></code><span class="deltaxml-new" style="background:#90EE90"> pattern matches a directory entry's name, the entry is excluded in the output. If both options are provided, the include filter is processed first, then the exclude filter.</span></p><p id="cv.directory"><span class="deltaxml-new" style="background:#90EE90">The result document produced for the specified directory path has a </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document element whose base URI is the directory path and whose </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is the last segment of the directory path (that is, the directory's (local) name).</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:directory</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">name</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    (</span><a href="#cv.file"><span class="deltaxml-new" style="background:#90EE90">c:file</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><a href="#cv.directory"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><a href="#cv.other"><span class="deltaxml-new" style="background:#90EE90">c:other</span></a><span class="deltaxml-new" style="background:#90EE90">)*</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:directory&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">Its contents are determined as follows, based on the entries in the directory identified by the directory path. For each entry in the directory, if either no </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">filter</span></code><span class="deltaxml-new" style="background:#90EE90"> was specified, or the (local) name of the entry matches the filter pattern, a </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:file</span></code></a><span class="deltaxml-new" style="background:#90EE90">, a </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90">, or a </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:other</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element is produced, as follows: </span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">A </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90"> is produced for each subdirectory not determined to be special.</span></p></li><li><p id="cv.file"><span class="deltaxml-new" style="background:#90EE90">A </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:file</span></code></a><span class="deltaxml-new" style="background:#90EE90"> is produced for each file not determined to be special.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:file</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">name</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90"> /&gt;</span></code></p></li><li><p id="cv.other"><a name="impl-4"></a><span class="deltaxml-new" style="background:#90EE90">Any file or directory determined to be special by the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:directory-list</span></code><span class="deltaxml-new" style="background:#90EE90"> step may be output using a </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:other</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element but the criteria for marking a file as special are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:other</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">name</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90"> /&gt;</span></code></p></li></ul></div><p><span class="deltaxml-new" style="background:#90EE90">When a directory entry is a subdirectory, that directory's entries are not output as part of that entry's </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90">. A user must apply this step again to the subdirectory to list subdirectory contents.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Each of the elements </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:file</span></code></a><span class="deltaxml-new" style="background:#90EE90">, </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90">, and </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:other</span></code></a><span class="deltaxml-new" style="background:#90EE90"> has a </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute when it appears within the top-level </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element, whose value is a relative IRI reference, giving the (local) file or directory name.</span></p><p><a name="impl-5"></a><span class="deltaxml-new" style="background:#90EE90">Any attributes other than </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> on </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:file</span></code></a><span class="deltaxml-new" style="background:#90EE90">, </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:directory</span></code></a><span class="deltaxml-new" style="background:#90EE90">, or </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:other</span></code></a><span class="deltaxml-new" style="background:#90EE90"> are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></section><section id="c.error" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.8 p:error</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:error</span></code><span class="deltaxml-new" style="background:#90EE90"> step generates a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> using the input provided to the step.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:error</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">false</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">code</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">code-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                 </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">code-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">code</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.error.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">code-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the code. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">code-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the code. </span><a name="err.inline.D0034.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-new" style="background:#90EE90">This step uses the document provided on its input as the content of the error raised. An instance of the </span><a href="../xproc20/#cv.errors"><span class="deltaxml-new" style="background:#90EE90">c:errors</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> element will be produced on the error output port, as is always the case for </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic errors</span></a></em><span class="deltaxml-new" style="background:#90EE90">. The error generated can be caught by a </span><a href="../xproc20/#p.try"><span class="deltaxml-new" style="background:#90EE90">p:try</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> just like any other dynamic error.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For authoring convenience, the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:error</span></code><span class="deltaxml-new" style="background:#90EE90"> step is declared with a single, primary output port. With respect to </span><em class="glossterm"><a href="../xproc20/#dt-connection"><span class="deltaxml-new" style="background:#90EE90">connections</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">, this port behaves like any other output port even though nothing can ever appear on it since the step always fails.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For example, given the following invocation:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:error xmlns:my="http://www.example.org/error"
         name="bad-document" code="my:unk12"&gt;
   &lt;p:input port="source"&gt;
     &lt;p:inline&gt;
       &lt;message&gt;The document element is unknown.&lt;/message&gt;
     &lt;/p:inline&gt;
   &lt;/p:input&gt;
&lt;/p:error&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">The error vocabulary element (and document) generated on the error output port would be:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:errors xmlns:c="http://www.w3.org/ns/xproc-step"
          xmlns:p="http://www.w3.org/ns/xproc"
          xmlns:my="http://www.example.org/error"&gt;
 &lt;c:error name="bad-document" type="p:error"
          code="my:unk12"&gt;&lt;message&gt;The document element is unknown.&lt;/message&gt;
&lt;/c:error&gt;
&lt;/c:errors&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">line</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">column</span></code><span class="deltaxml-new" style="background:#90EE90">, or </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">offset</span></code><span class="deltaxml-new" style="background:#90EE90">, might also be present on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:error</span></code><span class="deltaxml-new" style="background:#90EE90"> to identify the location of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:error</span></code><span class="deltaxml-new" style="background:#90EE90"> element in the pipeline.</span></p></section><section id="c.escape-markup" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.9 p:escape-markup</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:escape-markup</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies XML serialization to the children of the document element and replaces those children with their serialization. The outcome is a single element with text content that represents the "escaped" syntax of the children as they were serialized.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:escape-markup</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">cdata-section-elements</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">''</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">ListOfQNames</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-public</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-system</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">escape-uri-attributes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">include-content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">indent</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">media-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">method</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'xml'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">omit-xml-declaration</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">standalone</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'omit'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">   </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">undeclare-prefixes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'1.0'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">This step supports the standard serialization options as specified in </span><a href="#serialization-options" title="Serialization Options"><span class="deltaxml-new" style="background:#90EE90">Section 1.3, “Serialization Options”</span></a><span class="deltaxml-new" style="background:#90EE90">. These options control how the output markup is produced before it is escaped. </span></p><p><span class="deltaxml-new" style="background:#90EE90">For example, the input:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;description&gt;
&lt;div xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;p&gt;This is a chunk of XHTML.&lt;/p&gt;
&lt;/div&gt;
&lt;/description&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">produces:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;description&gt;
&amp;lt;div xmlns="http://www.w3.org/1999/xhtml"&amp;gt;
&amp;lt;p&gt;This is a chunk of XHTML.&amp;lt;/p&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/description&gt;</span></code></pre><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">The result of this step is an XML document that contains the Unicode characters that are the characters that result from escaping the input. It is not encoded characters in a serialized octet stream, therefore, the serialization options related to encoding characters (</span><code class="option"><span class="deltaxml-new" style="background:#90EE90">byte-order-mark</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">normalization-form</span></code><span class="deltaxml-new" style="background:#90EE90">) do not apply. They are omitted from the standard serialization options on this step.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">By default, this step </span><span class="rfc2119" id="c.escape-markup.10.1"><span class="deltaxml-new" style="background:#90EE90">must not</span></span><span class="deltaxml-new" style="background:#90EE90"> generate an XML declaration in the escaped result.</span></p></section><section id="c.filter" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.10 p:filter</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:filter</span></code><span class="deltaxml-new" style="background:#90EE90"> step selects portions of the source document based on a (possibly dynamically constructed) XPath select expression.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:filter</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">This step behaves just like an </span><a href="../xproc20/#p.input"><span class="deltaxml-new" style="background:#90EE90">p:input</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> with a </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">select</span></code><span class="deltaxml-new" style="background:#90EE90"> expression except that the select expression is computed dynamically.</span></p></section><section id="c.http-request" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.11 p:http-request</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code><span class="deltaxml-new" style="background:#90EE90"> step provides for interaction with resources over HTTP or related protocols. The input document provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port specifies a request by a single </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element. This element specifies the method, resource, and other request properties as well as possibly including an entity body (content) for the request.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">byte-order-mark</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">            </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">cdata-section-elements</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">''</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">ListOfQNames</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-public</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-system</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">escape-uri-attributes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">include-content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">indent</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">media-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">method</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'xml'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">normalization-form</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'none'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">NormalizationForm</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">omit-xml-declaration</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">standalone</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'omit'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">   </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">undeclare-prefixes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'1.0'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The standard serialization options are provided to control the serialization of any XML content which is sent as part of the request. The effect of these options is as specified in </span><a href="#serialization-options" title="Serialization Options"><span class="deltaxml-new" style="background:#90EE90">Section 1.3, “Serialization Options”</span></a><span class="deltaxml-new" style="background:#90EE90">. See </span><a href="#c.request_body" title="Request Entity body conversion"><span class="deltaxml-new" style="background:#90EE90">Section 1.1.11.2, “Request Entity body conversion”</span></a><span class="deltaxml-new" style="background:#90EE90"> for a discussion of when serialization occurs in constructing a request.</span></p><p><a name="err.inline.C0040"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0040"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0040</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the document element of the document that arrives on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port is not </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Editorial Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">Can the input document be JSON?</span></p></div><section id="cv.request" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.11.1 Specifying a request</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">An HTTP request is represented by a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code><span class="deltaxml-new" style="background:#90EE90"> element.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:request</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">method</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">NCName</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  href? = </span><var><span class="deltaxml-new" style="background:#90EE90">anyURI</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  detailed? = </span><var><span class="deltaxml-new" style="background:#90EE90">boolean</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  status-only? = </span><var><span class="deltaxml-new" style="background:#90EE90">boolean</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  username? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  password? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  auth-method? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  send-authorization? = </span><var><span class="deltaxml-new" style="background:#90EE90">boolean</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  override-content-type? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    (</span><a href="#cv.header"><span class="deltaxml-new" style="background:#90EE90">c:header</span></a><span class="deltaxml-new" style="background:#90EE90">*,</span><br /><span class="deltaxml-new" style="background:#90EE90">     (</span><a href="#cv.multipart"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">      </span><a href="#cv.body"><span class="deltaxml-new" style="background:#90EE90">c:body</span></a><span class="deltaxml-new" style="background:#90EE90">)?)</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:request&gt;</span></code></p><p><a name="err.inline.C0006"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0006"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0006</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">method</span></code><span class="deltaxml-new" style="background:#90EE90"> is not specified on a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code><span class="deltaxml-new" style="background:#90EE90">. </span><a name="err.inline.C0005"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0005"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0005</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the request contains a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> but the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">method</span></code><span class="deltaxml-new" style="background:#90EE90"> does not allow for an entity body being sent with the request.</span></p><p><a name="err.inline.C0004"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0004"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0004</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">status-only</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute has the value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90"> and the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">detailed</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute does not have the value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">method</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute specifies the method to be used against the IRI specified by the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute, e.g. </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">GET</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">POST</span></code><span class="deltaxml-new" style="background:#90EE90"> (the value is not case-sensitive). If the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is not absolute, it will be resolved against the base URI of the element on which it is occurs.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">In the case of simple “GET” requests, implementors are encouraged to support as many protocols as practical. In particular, pipeline authors may attempt to use </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> to load documents with computed URIs using the </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">file:</span></code><span class="deltaxml-new" style="background:#90EE90"> scheme.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">username</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is specified, the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">username</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">password</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">send-authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes are used to handle authentication according to the selected authentication method.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For the purposes of avoiding an authentication challenge, if the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">send-authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute has the value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90"> and the authentication method specified by the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90"> supports generation of an </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> header without a challenge, then an </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> header is generated and sent on the first request. If the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">send-authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is absent or has the value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">, then the first request is sent without an </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> header.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the initial response to the request is an authentication challenge, the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">username</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">password</span></code><span class="deltaxml-new" style="background:#90EE90"> and any relevant data from the challenge are used to generate an </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Authorization</span></code><span class="deltaxml-new" style="background:#90EE90"> header and the request is sent again. If that authorization fails, the request is not retried.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Appropriate values for the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute are “Basic” or “Digest” but other values are allowed. If the authentication method is “Basic” or “Digest”, authentication is handled as per [</span><a href="#rfc2617"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RFC 2617</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. </span><a name="impl-6"></a><span class="deltaxml-new" style="background:#90EE90">The interpretation of </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90"> values on </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code><span class="deltaxml-new" style="background:#90EE90"> other than “Basic” or “Digest” is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><a name="err.inline.C0003"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0003"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0003</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if a </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">username</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">password</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified without specifying an </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90">, if the requested </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">auth-method</span></code><span class="deltaxml-new" style="background:#90EE90"> isn't supported, or the authentication challenge contains an authentication method that isn't supported. All implementations are required to support "Basic" and "Digest" authentication per [</span><a href="#rfc2617"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RFC 2617</span></span></a><span class="deltaxml-new" style="background:#90EE90">].</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">c:header</span></code><span class="deltaxml-new" style="background:#90EE90"> element specifies a header name and value, either for inclusion in a request, or as received in a response.</span></p><p id="cv.header" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:header</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">name</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">value</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90"> /&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The request is formulated from the attribute values on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code><span class="deltaxml-new" style="background:#90EE90"> element and its </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:header</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> or </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> children, if present, and transmitted to the host (and port, if present) specified by the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute. The details of how the request entity body, if any, is constructed are given in </span><a href="#c.response_body" title="Converting Response Entity Bodies"><span class="deltaxml-new" style="background:#90EE90">Section 1.1.11.4, “Converting Response Entity Bodies”</span></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">When the request is formulated, the step and/or protocol implementation may add headers as necessary to either complete the request or as appropriate for the content specified (e.g. transfer encodings). A user of this step is guaranteed that their requested headers and content will be sent with the exception of any conflicts with protocol-related headers.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step allows users to specify independently values that are not always independent. For example, some combinations of </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:header</span></code></a><span class="deltaxml-new" style="background:#90EE90"> values (e.g., </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90">) may be inconsistent with values that the step and/or protocol implementation must set. In a few cases, the step provides more than one mechanism to specify what is actually a single value (e.g., the boundary string in multipart messages). </span><a name="err.inline.C0020"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0020"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0020</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the the user specifies a value or values that are inconsistent with each other or with the requirements of the step or protocol. </span></p></section><section id="c.request_body" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.11.2 Request Entity body conversion</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code><span class="deltaxml-new" style="background:#90EE90"> element specifies a multi-part body, per [</span><a href="#rfc1521"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RFC 1521</span></span></a><span class="deltaxml-new" style="background:#90EE90">], either for inclusion in a request or as received in a response.</span></p><p id="cv.multipart" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:multipart</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">content-type</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">boundary</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><a href="#cv.body"><span class="deltaxml-new" style="background:#90EE90">c:body</span></a><span class="deltaxml-new" style="background:#90EE90">+</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:multipart&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">In the context of a request, the media type of the </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="rfc2119" id="c.request_body.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a multipart media type (i.e. have a main type of 'multipart'). If the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is not specified, a value of "multipart/mixed" will be assumed.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">boundary</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is required and is used to provide a multipart boundary marker. The implementation must use this boundary marker and must prefix the value with the string “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">--</span></code><span class="deltaxml-new" style="background:#90EE90">” when formulating the multipart message. </span><a name="err.inline.C0002"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0002"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0002</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the value starts with the string “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">--</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the boundary is also specified as a parameter in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> option, then the parameter value specified and the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">boundary</span></code><span class="deltaxml-new" style="background:#90EE90"> value specified </span><span class="rfc2119" id="c.request_body.6.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be the same. If the boundary is specified in both the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">boundary</span></code><span class="deltaxml-new" style="background:#90EE90"> option and the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> option then the two values </span><span class="rfc2119" id="c.request_body.6.6"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be the same.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element holds the body or body part of the message. Each of the attributes holds controls some aspect of the encoding the request body or decoding the body element's content when the request is formulated. These are specified as follows:</span></p><p id="cv.body" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:body</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">content-type</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  encoding? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  id? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  description? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  disposition? = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><var><span class="deltaxml-new" style="background:#90EE90">anyElement</span></var><span class="deltaxml-new" style="background:#90EE90">*</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:body&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute specifies the media type of the body or body part, that is, the value of its </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90"> header. If the media type is not an XML type or text, the content must already be base64-encoded.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute controls the decoding of the element content for formulating the body. A value of </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90"> indicates the element's content is a base64 encoded string whose byte stream should be sent as the message body. </span><a name="impl-7"></a><span class="deltaxml-new" style="background:#90EE90">An implementation may support encodings other than </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90"> but these encodings and their names are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span><a name="err.inline.C0052"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0052"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0052</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the encoding specified is not supported by the implementation.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step provides only a single set of serialization options for XML media types. There's no direct support for sending a multipart message with two XML parts encoded differently.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">For each body or body part, the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">id</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute specifies the value of the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-ID</span></code><span class="deltaxml-new" style="background:#90EE90"> header; the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">description</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute specifies the value of the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Description</span></code><span class="deltaxml-new" style="background:#90EE90"> header; and the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">disposition</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute specifies the value of the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Disposition</span></code><span class="deltaxml-new" style="background:#90EE90"> header. </span></p><p><span class="deltaxml-new" style="background:#90EE90">If an entity body is to be sent as part of a request (e.g. a </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">POST</span></code><span class="deltaxml-new" style="background:#90EE90">), either a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element, specifying the request entity body, or a </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element, specifying multiple entity body parts, may be used. When </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> is used it may contain multiple </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> children. A </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> specifies the construction of a body or body part as follows:</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute does not specify an XML media type, or the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90">”, then </span><a name="err.inline.C0028"></a><span class="deltaxml-new" style="background:#90EE90">it is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0028"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0028</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the content of the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element does not consist entirely of characters, and the entity body or body part will consist of exactly those characters.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise (the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute </span><em><span class="deltaxml-new" style="background:#90EE90">does</span></em><span class="deltaxml-new" style="background:#90EE90"> specify an XML media type and the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is </span><em><span class="deltaxml-new" style="background:#90EE90">not</span></em><span class="deltaxml-new" style="background:#90EE90"> 'base64'), </span><a name="err.inline.C0022"></a><span class="deltaxml-new" style="background:#90EE90">it is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0022"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0022</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the content of the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element does not consist of exactly one element, optionally preceded and/or followed by any number of processing instructions, comments or whitespace characters, and the entity body or body part will consist of the serialization of a document node containing that content. The serialization of that document is controlled by the serialization options on the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code><span class="deltaxml-new" style="background:#90EE90"> step itself.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For example, the following input to a </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code><span class="deltaxml-new" style="background:#90EE90"> step will POST a small XML document:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:request method="POST" href="http://example.com/someservice"&gt;
&lt;c:body xmlns:c="http://www.w3.org/ns/xproc-step" content-type="application/xml"&gt;
&lt;doc&gt;
&lt;title&gt;My document&lt;/title&gt;
&lt;/doc&gt;
&lt;/c:body&gt;
&lt;/c:request&gt;
</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">The corresponding request should look something like this:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">POST http://example.com/someservice HTTP/1.1
Host: example.com
Content-Type: application/xml; charset="utf-8"

&lt;?xml version='1.0'?&gt;
&lt;doc&gt;
&lt;title&gt;My document&lt;/title&gt;
&lt;/doc&gt;
</span></code></pre></section><section id="c.request_response" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.11.3 Managing the response</span></h5></div><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Editorial Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">This section hasn't been updated to reflect the fact that non-XML documents are now possible.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">The handling of the response to the request and the generation of the step's result document is controlled by the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">status-only</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">override-content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">detailed</span></code><span class="deltaxml-new" style="background:#90EE90"> attributes on the </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> input.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">override-content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute controls interpretation of the response's </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90"> header. If this attribute is present, the response will be treated as if it returned the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90"> given by its value. This original </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90"> header will however be reflected unchanged as a </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:header</span></code></a><span class="deltaxml-new" style="background:#90EE90"> in the result document. </span><a name="err.inline.C0030"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0030"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0030</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">override-content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> value cannot be used (e.g. </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">text/plain</span></code><span class="deltaxml-new" style="background:#90EE90"> to override </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">image/png</span></code><span class="deltaxml-new" style="background:#90EE90">).</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">status-only</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute has the value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, the result document will contain only header information. The entity of the response will not be processed to produce a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#c.response"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:response</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element represents an HTTP response. The response's status code is encoded in the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">status</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute and the headers and entity body are processing into </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:header</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> or </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> content.</span></p><p id="c.response" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:response</span><br /><span class="deltaxml-new" style="background:#90EE90">  status? = </span><var><span class="deltaxml-new" style="background:#90EE90">integer</span></var><span class="deltaxml-new" style="background:#90EE90">&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    (</span><a href="#cv.header"><span class="deltaxml-new" style="background:#90EE90">c:header</span></a><span class="deltaxml-new" style="background:#90EE90">*,</span><br /><span class="deltaxml-new" style="background:#90EE90">     (</span><a href="#cv.multipart"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></a><span class="deltaxml-new" style="background:#90EE90"> | </span><br /><span class="deltaxml-new" style="background:#90EE90">      </span><a href="#cv.body"><span class="deltaxml-new" style="background:#90EE90">c:body</span></a><span class="deltaxml-new" style="background:#90EE90">)?)</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:response&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">detailed</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute determines the content of the result document. If it is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, the response to the request is handled as follows:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-new" style="background:#90EE90">A single </span><a href="#c.response"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:response</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element is produced with the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">status</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute containing the status of the response received.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Each response header is translated into a </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:header</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Unless the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">status-only</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute has a value </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, the entity body of the response is converted into a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element via the rules given in </span><a href="#c.response_body" title="Converting Response Entity Bodies"><span class="deltaxml-new" style="background:#90EE90">Section 1.1.11.4, “Converting Response Entity Bodies”</span></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></li></ol></div><p><span class="deltaxml-new" style="background:#90EE90">Otherwise (the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">detailed</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is not specified or its value is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">), the response to the request is handled as follows:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-new" style="background:#90EE90">If the media type (as determined by the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">override-content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute or the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90"> response header) is an XML media type, the entity is decoded if necessary, then parsed as an XML document and produced on the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> output port as the entire output of the step.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the entity body of the response is converted into a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element via the rules given in </span><a href="#c.response_body" title="Converting Response Entity Bodies"><span class="deltaxml-new" style="background:#90EE90">Section 1.1.11.4, “Converting Response Entity Bodies”</span></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></li></ol></div><p><span class="deltaxml-new" style="background:#90EE90">In either case the base URI of the output document is the resolved value of the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute from the input </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><section id="redirects" class="section"><div class="section-titlepage"><h6><span class="deltaxml-new" style="background:#90EE90">1.1.11.3.1 Redirects</span></h6></div><p><span class="deltaxml-new" style="background:#90EE90">One possible response from an HTTP request is a redirect, indicated by a status code in the three-hundred range. The precise semantics of the 3xx return codes are laid out by section </span><em class="citetitle"><span class="deltaxml-new" style="background:#90EE90">10.3 Redirection 3xx</span></em><span class="deltaxml-new" style="background:#90EE90"> in [</span><a href="#rfc2616"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RFC 2616</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step </span><span class="rfc2119" id="redirects.3.2"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> follow redirect requests (in a manner consistent with [</span><a href="#rfc2616"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RFC 2616</span></span></a><span class="deltaxml-new" style="background:#90EE90">]) if they are returned by the server. </span></p></section><section id="cookies" class="section"><div class="section-titlepage"><h6><span class="deltaxml-new" style="background:#90EE90">1.1.11.3.2 Cookies</span></h6></div><p><span class="deltaxml-new" style="background:#90EE90">With one exception, in version 1.0 of XProc, the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step does not provide any standard mechanisms for managing cookies. </span><a name="impl-8"></a><span class="deltaxml-new" style="background:#90EE90">Pipeline authors that need to preserve cookies across several </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> calls in the same pipeline or across multiple invocations of the same or different pipelines will have to rely on </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> mechanisms. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The exception arises in the case of redirection. If a redirect response includes cookies, those cookies </span><span class="rfc2119" id="cookies.3.1"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be forwarded as appropriate to the redirected location when the redirection is followed.</span></p><p><span class="deltaxml-new" style="background:#90EE90">This behavior will allow the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step to interoperate with web services that use cookies as part of an authentication protocol.</span></p></section></section><section id="c.response_body" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.11.4 Converting Response Entity Bodies</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">The entity of a response may be multipart per [</span><a href="#rfc1521"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RFC 1521</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. In those situations, the result document will be a </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:multipart</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element that contains multiple </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements inside.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">Although it is technically possible for any of the individual parts of a multipart message to </span><em><span class="deltaxml-new" style="background:#90EE90">also</span></em><span class="deltaxml-new" style="background:#90EE90"> be multipart, XProc does not provide a standard representation for such messages. </span><a name="impl-9"></a><span class="deltaxml-new" style="background:#90EE90">The interpretation of a multipart message inside another multipart message is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">The result of the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step is an XML document. For media types (images, binaries, etc.) that can't be represented as a sequence of Unicode characters, the response is encoded as </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90"> and then returned as text children of the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element. If the content is base64-encoded, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute on </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> must be set to “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the media type of the response is a text type with a </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">charset</span></code><span class="deltaxml-new" style="background:#90EE90"> parameter that is a Unicode character encoding (per [</span><a href="#unicodetr17"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Unicode TR#17</span></span></a><span class="deltaxml-new" style="background:#90EE90">]) or is recognized as a non-XML media type whose contents are encoded as a sequence of Unicode characters (e.g. it has a character parameter or the definition of the media type is such that it requires Unicode), the content of the constructed </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element is the translation of the text into a sequence of Unicode characters.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the response is an XML media type, the content of the constructed </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element is the result of decoding the body as necessary, then parsing it with an XML parser. If the content is not well-formed, the step fails.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> in a response, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute </span><span class="rfc2119" id="c.response_body.7.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an exact copy of the value returned in the </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">Content-Type</span></code><span class="deltaxml-new" style="background:#90EE90"> header. That is, it must reflect the content type actually returned, not any override value that may have been specified, and it must include any parameters returned by the server.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In the case of a multipart response, the same rules apply when constructing a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element for each body part encountered.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">Given the above description, any content identified as </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">text/html</span></code><span class="deltaxml-new" style="background:#90EE90"> will be encoded as (escaped) text or base64-encoded in the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:body</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element, as HTML isn't always well-formed XML. A user can attempt to convert such content into XML using the </span><a href="#c.unescape-markup"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:unescape-markup</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step.</span></p></div></section><section id="example-http-request" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.11.5 HTTP Request Example</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">A simple form might be posted as follows:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:request method="POST" href="http://www.example.com/form-action" xmlns:c="http://www.w3.org/ns/xproc-step"&gt;
&lt;c:body content-type="application/x-www-form-urlencoded"&gt;
name=W3C&amp;amp;spec=XProc
&lt;/c:body&gt;
&lt;/c:request&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">and if the response was an XHTML document, the result document would be:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:response status="200" xmlns:c="http://www.w3.org/ns/xproc-step"&gt;
&lt;c:header name="Date" value=" Wed, 09 May 2007 23:12:24 GMT"/&gt;
&lt;c:header name="Server" value="Apache/1.3.37 (Unix) PHP/4.4.5"/&gt;
&lt;c:header name="Vary" value="negotiate,accept"/&gt;
&lt;c:header name="TCN" value="choice"/&gt;
&lt;c:header name="P3P" value="policyref='http://www.w3.org/2001/05/P3P/p3p.xml'"/&gt;
&lt;c:header name="Cache-Control" value="max-age=600"/&gt;
&lt;c:header name="Expires" value="Wed, 09 May 2007 23:22:24 GMT"/&gt;
&lt;c:header name="Last-Modified" value="Tue, 08 May 2007 16:10:49 GMT"/&gt;
&lt;c:header name="ETag" value="'4640a109;42380ddc'"/&gt;
&lt;c:header name="Accept-Ranges" value="bytes"/&gt;
&lt;c:header name="Keep-Alive" value="timeout=2, max=100"/&gt;
&lt;c:header name="Connection" value="Keep-Alive"/&gt;
&lt;c:body content-type="application/xhtml+xml"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;&lt;title&gt;OK&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;p&gt;OK!&lt;/p&gt;&lt;/body&gt;
&lt;/html&gt;
&lt;/c:body&gt;
&lt;/c:response&gt;</span></code></pre></section></section><section id="c.identity" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.12 p:identity</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:identity</span></code><span class="deltaxml-new" style="background:#90EE90"> step makes a verbatim copy of its input available on its output.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:identity</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">If the implementation supports passing PSVI annotations between steps, the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:identity</span></code><span class="deltaxml-new" style="background:#90EE90"> step </span><span class="rfc2119" id="c.identity.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> preserve any annotations that appear in the input.</span></p></section><section id="c.insert" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.13 p:insert</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:insert</span></code><span class="deltaxml-new" style="background:#90EE90"> step inserts the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">insertion</span></code><span class="deltaxml-new" style="background:#90EE90"> port's document into the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port's document relative to the matching elements in the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port's document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:insert</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">insertion</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'/*'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">position</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">     </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"first-child" | "last-child" | "before" | "after"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.insert.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if that pattern matches anything other than element, text, processing-instruction, or comment nodes. Multiple matches are allowed, in which case multiple copies of the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">insertion</span></code><span class="deltaxml-new" style="background:#90EE90"> documents will occur. If no elements match, then the document is unchanged.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">position</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.insert.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an NMTOKEN in the following list: </span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">“</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">first-child</span></code><span class="deltaxml-new" style="background:#90EE90">” - the insertion is made as the first child of the match;</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">“</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">last-child</span></code><span class="deltaxml-new" style="background:#90EE90">” - the insertion is made as the last child of the match;</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">“</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">before</span></code><span class="deltaxml-new" style="background:#90EE90">” - the insertion is made as the immediate preceding sibling of the match;</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">“</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">after</span></code><span class="deltaxml-new" style="background:#90EE90">” - the insertion is made as the immediate following sibling of the match.</span></p></li></ul></div><p><a name="err.inline.C0025"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0025"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0025</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the match pattern matches anything other than an element node and the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">position</span></code><span class="deltaxml-new" style="background:#90EE90"> option is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">first-child</span></code><span class="deltaxml-new" style="background:#90EE90">” or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">last-child</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p><p><span class="deltaxml-new" style="background:#90EE90">As the inserted elements are part of the output of the step they are not considered in determining matching elements. If an empty sequence appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">insertion</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the result will be the same as the source.</span></p></section><section id="c.label-elements" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.14 p:label-elements</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:label-elements</span></code><span class="deltaxml-new" style="background:#90EE90"> step generates a label for each matched element and stores that label in the specified attribute.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:label-elements</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'xml:id'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">            </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">attribute-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">label</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'concat("_",$p:index)'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'*'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">          </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.label-elements.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">attribute-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the attribute name. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">attribute-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the attribute name. </span><a name="err.inline.D0034.2"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">label</span></code><span class="deltaxml-new" style="background:#90EE90"> option is an XPath expression used to generate the value of the attribute label.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.label-elements.6.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.2"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if that expression matches anything other than element nodes.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><span class="rfc2119" id="c.label-elements.7.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean value and is used to indicate whether existing attribute values are replaced.</span></p><p><span class="deltaxml-new" style="background:#90EE90">This step operates by generating attribute labels for each element matched. For every matched element, the expression is evaluated with the context node set to the matched element. An attribute is added to the matched element using the attribute name is specified the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">attribute</span></code><span class="deltaxml-new" style="background:#90EE90"> option and the string value of result of evaluating the expression. If the attribute already exists on the matched element, the value is replaced with the string value only if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><span class="deltaxml-new" style="background:#90EE90"> option has the value of </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If this step is used to add or change the value of an attribute named “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">”, the base URI of the element </span><span class="rfc2119" id="c.label-elements.9.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p><p><span class="deltaxml-new" style="background:#90EE90">An implementation must bind the variable “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">p:index</span></code><span class="deltaxml-new" style="background:#90EE90">” in the static context of each evaluation of the XPath expression to the position of the element in the sequence of matched elements. In other words, the first element (in document order) matched gets the value “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">1</span></code><span class="deltaxml-new" style="background:#90EE90">”, the second gets the value “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">2</span></code><span class="deltaxml-new" style="background:#90EE90">”, the third, “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">3</span></code><span class="deltaxml-new" style="background:#90EE90">”, etc.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The result of the p:label-elements step is the input document with the attribute labels associated with matched elements. All other non-matching content remains the same.</span></p></section><section id="c.load" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.15 p:load</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><span class="deltaxml-new" style="background:#90EE90"> step has no inputs but produces as its result a document specified by an IRI.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">href</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">dtd-validate</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.load.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. It is interpreted as an IRI reference. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><span class="deltaxml-new" style="background:#90EE90"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-new" style="background:#90EE90">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> value).</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-validate</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.load.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><span class="deltaxml-new" style="background:#90EE90"> step is the same as </span><a href="../xproc20/#p.document"><span class="deltaxml-new" style="background:#90EE90">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> with two additions:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-new" style="background:#90EE90">The URI to be accessed can be constructed dynamically by the pipeline.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><span class="deltaxml-new" style="background:#90EE90"> step has an option to invoke DTD validation. </span></p></li></ol></div><p><span class="deltaxml-new" style="background:#90EE90">When </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-validate</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><span class="deltaxml-new" style="background:#90EE90"> processing is the same as </span><a href="../xproc20/#p.document"><span class="deltaxml-new" style="background:#90EE90">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> processing on the computed </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> value.</span></p><p><span class="deltaxml-new" style="background:#90EE90">When </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-validate</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:load</span></code><span class="deltaxml-new" style="background:#90EE90"> processing is the same as </span><a href="../xproc20/#p.document"><span class="deltaxml-new" style="background:#90EE90">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> processing on the computed </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> value but </span><span class="rfc2119" id="c.load.9.6"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> use a validating parser. </span><a name="err.inline.C0027"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0027"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0027</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the document is not valid or the step doesn't support DTD validation. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The retrieved document is produced on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port. The base URI of the result is the (absolute) IRI used to retrieve it.</span></p></section><section id="c.make-absolute-uris" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.16 p:make-absolute-uris</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:make-absolute-uris</span></code><span class="deltaxml-new" style="background:#90EE90"> step makes an element or attribute's value in the source document an absolute IRI value in the result document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:make-absolute-uris</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                    </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.make-absolute-uris.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.3"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the pattern matches anything other than element or attribute nodes.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.make-absolute-uris.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. It is interpreted as an IRI reference. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:make-absolute-uris</span></code><span class="deltaxml-new" style="background:#90EE90"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-new" style="background:#90EE90">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> value).</span></p><p><span class="deltaxml-new" style="background:#90EE90">For every element or attribute in the input document which matches the specified pattern, its XPath string-value is resolved against the specified base URI and the resulting absolute IRI is used as the matched node's entire contents in the output.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The base URI used for resolution defaults to the matched attribute's element or the matched element's base URI unless the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option is specified. When the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option is specified, the option value is used as the base URI regardless of any contextual base URI value in the document. This option value is resolved against the base URI of the </span><a href="../xproc20/#p.option"><span class="deltaxml-new" style="background:#90EE90">p:option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> element used to set the option.</span></p><p><a name="impl-10"></a><span class="deltaxml-new" style="background:#90EE90">If the IRI reference specified by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option on </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:make-absolute-uris</span></code><span class="deltaxml-new" style="background:#90EE90"> is not valid, or if it is absent and the input document has no base URI, the results are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></section><section id="c.namespace-rename" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.17 p:namespace-rename</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:namespace-rename</span></code><span class="deltaxml-new" style="background:#90EE90"> step renames any namespace declaration or use of a namespace in a document to a new IRI value.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:namespace-rename</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">from</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">to</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                          </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">apply-to</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'all'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"all" | "elements" | "attributes"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.namespace-rename.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. It </span><span class="rfc2119" id="c.namespace-rename.4.4"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be either empty or absolute, but will not be resolved in any case.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.namespace-rename.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. It </span><span class="rfc2119" id="c.namespace-rename.5.4"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be empty or absolute, but will not be resolved in any case.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">apply-to</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.namespace-rename.6.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be one of “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">all</span></code><span class="deltaxml-new" style="background:#90EE90">”, “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">elements</span></code><span class="deltaxml-new" style="background:#90EE90">”, or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">attributes</span></code><span class="deltaxml-new" style="background:#90EE90">”. If the value is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">elements</span></code><span class="deltaxml-new" style="background:#90EE90">”, only elements will be renamed, if the value is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">attributes</span></code><span class="deltaxml-new" style="background:#90EE90">”, only attributes will be renamed, if the value is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">all</span></code><span class="deltaxml-new" style="background:#90EE90">”, both elements and attributes will be renamed.</span></p><p><a name="err.inline.C0014"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0014"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0014</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the XML namespace (</span><code class="uri"><span class="deltaxml-new" style="background:#90EE90">http://www.w3.org/XML/1998/namespace</span></code><span class="deltaxml-new" style="background:#90EE90">) or the XMLNS namespace (</span><code class="uri"><span class="deltaxml-new" style="background:#90EE90">http://www.w3.org/2000/xmlns/</span></code><span class="deltaxml-new" style="background:#90EE90">) is the value of either the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option or the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is the same as the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option, the input is reproduced unchanged on the output. Otherwise, namespace bindings, namespace attributes and element and attribute names are changed as follows:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">Namespace bindings: If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is present and its value is not the empty string, then every binding of a prefix (or the default namespace) in the input document whose value is the same as the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">replaced in the output with a binding to the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option, provided it is present and not the empty string;</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">otherwise (the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option is not specified or has an empty string as its value) absent from the output.</span></p></li></ul></div><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is absent, or its value is the empty string, then no bindings are changed or removed.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Elements and attributes: If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is present and its value is not the empty string, for every element and attribute, as appropriate, in the input whose namespace name is the same as the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option, in the output its namespace name is</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">replaced with the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option, provided it is present and not the empty string;</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">otherwise (the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option is not specified or has an empty string as its value) changed to have no value.</span></p></li></ul></div><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is absent, or its value is the empty string, then for every element and attribute, as appropriate, whose namespace name has no value, in the output its namespace name is set to the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Namespace attributes: If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option is present and its value is not the empty string, for every namespace attribute in the input whose value is the same as the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option, in the output</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">the namespace attribute's value is replaced with the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option, provided it is present and not the empty string;</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">otherwise (the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option is not specified or has an empty string as its value) the namespace attribute is absent.</span></p></li></ul></div></li></ul></div><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">apply-to</span></code><span class="deltaxml-new" style="background:#90EE90"> option is primarily intended to make it possible to avoid renaming attributes when the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">from</span></code><span class="deltaxml-new" style="background:#90EE90"> option specifies no namespace, since many attributes are in no namespace.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Care should be taken when specifying no namespace with the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">to</span></code><span class="deltaxml-new" style="background:#90EE90"> option. Prefixed names in content, for example QNames and XPath expressions, may end up with no appropriate namespace binding.</span></p></div></section><section id="c.pack" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.18 p:pack</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:pack</span></code><span class="deltaxml-new" style="background:#90EE90"> step merges two document sequences in a pair-wise fashion.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:pack</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">alternate</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">           </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.pack.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">wrapper-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the wrapper. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">wrapper-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the wrapper element. </span><a name="err.inline.D0034.3"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The step takes each pair of documents, in order, one from the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port and one from the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">alternate</span></code><span class="deltaxml-new" style="background:#90EE90"> port, wraps them with a new element node whose QName is the value specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option, and writes that element to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port as a document.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the step reaches the end of one input sequence before the other, then it simply wraps each of the remaining documents in the longer sequence.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">In the common case, where the document element of a document in the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> sequence has two element children, any comments, processing instructions, or white space text nodes that occur between them may have come from either of the input documents; this step does not attempt to distinguish which one.</span></p></div></section><section id="c.parameters" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.19 p:parameters</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> step exposes a set of parameters as a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">Each parameter in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> map is converted into a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element. The resulting </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements are wrapped in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and the parameter set document is written to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span><a name="impl-11"></a><span class="deltaxml-new" style="background:#90EE90">The order in which </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements occur in the </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For consistency and user convenience, if any of the parameters have names that are in a namespace, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute on the </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element </span><span class="rfc2119" id="c.parameters.5.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used. Each </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="rfc2119" id="c.parameters.5.5"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an NCName.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The base URI of the output document is the URI of the pipeline document that contains the step.</span></p><section id="cv.param" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.19.1 The c:param element</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">A </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code><span class="deltaxml-new" style="background:#90EE90"> represents a parameter on a parameter input.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:param</span><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">name</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">QName</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  namespace? = </span><var><span class="deltaxml-new" style="background:#90EE90">anyURI</span></var><br /><span class="deltaxml-new" style="background:#90EE90">  </span><strong><span class="deltaxml-new" style="background:#90EE90">value</span></strong><span class="deltaxml-new" style="background:#90EE90"> = </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><span class="deltaxml-new" style="background:#90EE90"> /&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code><span class="deltaxml-new" style="background:#90EE90"> must have the lexical form of a QName.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is specified, then the expanded name of the parameter is constructed from the specified namespace and the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> value. </span><a name="err.inline.D0025"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0025"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0025</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is specified, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> contains a colon, and the specified namespace is not the same as the in-scope namespace binding for the specified prefix. </span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is not specified, and the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> contains a colon, then the expanded name of the parameter is constructed using the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> value and the namespace declarations in-scope on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code><span class="deltaxml-new" style="background:#90EE90"> element.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute is not specified, and the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90"> does not contain a colon, then the expanded name of the parameter is in no namespace.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Any namespace-qualified attribute names that appear on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code><span class="deltaxml-new" style="background:#90EE90"> element are ignored. </span><a name="err.inline.D0014"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0014"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0014</span></code></a><span class="deltaxml-new" style="background:#90EE90">) for any unqualified attribute names other than “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="deltaxml-new" style="background:#90EE90">”, “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90">”, or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">value</span></code><span class="deltaxml-new" style="background:#90EE90">” to appear on a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code><span class="deltaxml-new" style="background:#90EE90"> element.</span></p></section><section id="cv.param-set" class="section"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.1.19.2 The c:param-set element</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">A </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code><span class="deltaxml-new" style="background:#90EE90"> represents a set of parameters on a parameter input.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:param-set&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><a href="#cv.param"><span class="deltaxml-new" style="background:#90EE90">c:param</span></a><span class="deltaxml-new" style="background:#90EE90">*</span><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:param-set&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code><span class="deltaxml-new" style="background:#90EE90"> contains zero or more </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements. </span><a name="err.inline.D0018"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0018"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0018</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the parameter list contains any elements other than </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Any namespace-qualified attribute names that appear on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code><span class="deltaxml-new" style="background:#90EE90"> element are ignored. </span><a name="err.inline.D0014.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0014"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0014</span></code></a><span class="deltaxml-new" style="background:#90EE90">) for any unqualified attribute names to appear on a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code><span class="deltaxml-new" style="background:#90EE90"> element.</span></p></section></section><section id="c.rename" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.20 p:rename</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:rename</span></code><span class="deltaxml-new" style="background:#90EE90"> step renames elements, attributes, or processing-instruction targets in a document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:rename</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">new-name</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">     </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">new-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">new-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">               </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be an XSLTMatchPattern. </span><a name="err.inline.C0023.4"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the pattern matches anything other than element, attribute or processing instruction nodes.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">new-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">new-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the new name. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">new-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the new name. </span><a name="err.inline.D0034.4"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon. </span></p><p><span class="deltaxml-new" style="background:#90EE90">Each element, attribute, or processing-instruction in the input matched by the match pattern specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option is renamed in the output to the name specified by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">new-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option matches an attribute and if the element on which it occurs already has an attribute whose expanded name is the same as the expanded name of the specified </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">new-name</span></code><span class="deltaxml-new" style="background:#90EE90">, then the results is as if the current attribute named “</span><em class="replaceable"><code><span class="deltaxml-new" style="background:#90EE90">new-name</span></code></em><span class="deltaxml-new" style="background:#90EE90">” was deleted before renaming the matched attribute.</span></p><p><span class="deltaxml-new" style="background:#90EE90">With respect to attributes named “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">”, the following semantics apply: renaming an </span><em><span class="deltaxml-new" style="background:#90EE90">from</span></em><span class="deltaxml-new" style="background:#90EE90"> “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">” </span><em><span class="deltaxml-new" style="background:#90EE90">to</span></em><span class="deltaxml-new" style="background:#90EE90"> something else has no effect on the underlying base URI of the element; however, if an attribute is renamed </span><em><span class="deltaxml-new" style="background:#90EE90">from</span></em><span class="deltaxml-new" style="background:#90EE90"> something else </span><em><span class="deltaxml-new" style="background:#90EE90">to</span></em><span class="deltaxml-new" style="background:#90EE90"> “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">”, the base URI of the element </span><span class="rfc2119" id="c.rename.8.8"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the pattern matches processing instructions, then it is the processing instruction target that is renamed. </span><a name="err.inline.C0013"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0013"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0013</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the pattern matches a processing instruction and the new name has a non-null namespace. </span></p></section><section id="c.replace" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.21 p:replace</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:replace</span></code><span class="deltaxml-new" style="background:#90EE90"> step replaces matching nodes in its primary input with the document element of the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">replacement</span></code><span class="deltaxml-new" style="background:#90EE90"> port's document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:replace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">replacement</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.replace.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.5"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if that pattern matches anything other than element, text, processing-instruction, or comment nodes. Multiple matches are allowed, in which case multiple copies of the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">replacement</span></code><span class="deltaxml-new" style="background:#90EE90"> document will occur.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Every node in the primary input matching the specified pattern is replaced in the output is replaced by the document element of the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">replacement</span></code><span class="deltaxml-new" style="background:#90EE90"> document. Only non-nested matches are replaced. That is, once a node is replaced, its descendants cannot be matched.</span></p></section><section id="c.set-attributes" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.22 p:set-attributes</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:set-attributes</span></code><span class="deltaxml-new" style="background:#90EE90"> step sets attributes on matching elements.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:set-attributes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">attributes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.set-attributes.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.6"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if that pattern matches anything other than element nodes.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Each attribute on the document element of the document that appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">attributes</span></code><span class="deltaxml-new" style="background:#90EE90"> port is copied to each element that matches the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> expression.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If an attribute with the same name as one of the attributes to be copied already exists, the value specified on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">attribute</span></code><span class="deltaxml-new" style="background:#90EE90"> port's document is used. The result port of this step produces a copy of the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port's document with the matching elements' attributes modified.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The matching elements are specified by the match pattern in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option. All matching elements are processed. If no elements match, the step will not change any elements.</span></p><p><span class="deltaxml-new" style="background:#90EE90">This step must not copy namespace declarations. If the attributes copied from the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">attributes</span></code><span class="deltaxml-new" style="background:#90EE90"> use namespaces, prefixes, or prefixes bound to different namespaces, the document produced on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> output port will require </span><span class="xspecref"><a href="../xproc20/#namespace-fixup"><span class="deltaxml-new" style="background:#90EE90">Section 2.5.1, “Namespace Fixup on XML Outputs”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If an attribute named </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90"> is added or changed, the base URI of the element </span><span class="rfc2119" id="c.set-attributes.9.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p></section><section id="c.set-properties" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.23 p:set-properties</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:set-properties</span></code><span class="deltaxml-new" style="background:#90EE90"> step sets </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-new" style="background:#90EE90">document properties</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> on the source document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:set-properties</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">properties</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:string,xs:string)</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-new" style="background:#90EE90">document properties</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> of the document on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port are augmented with the values specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">properties</span></code><span class="deltaxml-new" style="background:#90EE90"> option. The document produced on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port has the same representation but the adjusted property values.</span></p><p><a name="err.inline.C1001"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C1001"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC1001</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">properties</span></code><span class="deltaxml-new" style="background:#90EE90"> map contains a key equal to the string “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90">”. </span></p></section><section id="c.sink" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.24 p:sink</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:sink</span></code><span class="deltaxml-new" style="background:#90EE90"> step accepts a sequence of documents and discards them. It has no output.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:sink</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p></section><section id="c.split-sequence" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.25 p:split-sequence</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:split-sequence</span></code><span class="deltaxml-new" style="background:#90EE90"> step accepts a sequence of documents and divides it into two sequences.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:split-sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">matched</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">not-matched</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">initial-only</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">test</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">test</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.split-sequence.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XPathExpression.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The XPath expression in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">test</span></code><span class="deltaxml-new" style="background:#90EE90"> option is applied to each document in the input sequence. If the effective boolean value of the expression is true, the document is copied to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">matched</span></code><span class="deltaxml-new" style="background:#90EE90"> port; otherwise it is copied to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">not-matched</span></code><span class="deltaxml-new" style="background:#90EE90"> port.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">initial-only</span></code><span class="deltaxml-new" style="background:#90EE90"> option is true, then when the first document that does not satisfy the test expression is encountered, it </span><em><span class="deltaxml-new" style="background:#90EE90">and all the documents that follow it</span></em><span class="deltaxml-new" style="background:#90EE90"> are written to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">not-matched</span></code><span class="deltaxml-new" style="background:#90EE90"> port. In other words, it only writes the initial series of matched documents (which may be empty) to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">matched</span></code><span class="deltaxml-new" style="background:#90EE90"> port. All other documents are written to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">not-matched</span></code><span class="deltaxml-new" style="background:#90EE90"> port, irrespective of whether or not they match.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><span class="xspecref"><a href="../xproc20/#xpath-context"><span class="deltaxml-new" style="background:#90EE90">XPath context</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> for the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">test</span></code><span class="deltaxml-new" style="background:#90EE90"> option changes over time. For each document that appears on the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the expression is evaluated with that document as the context document. The context position (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">position()</span></code><span class="deltaxml-new" style="background:#90EE90">) is the position of that document within the sequence and the context size (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">last()</span></code><span class="deltaxml-new" style="background:#90EE90">) is the total number of documents in the sequence.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">In principle, this component cannot stream because it must buffer all of the input sequence in order to find the context size. In practice, if the test expression does not use the </span><code class="function"><span class="deltaxml-new" style="background:#90EE90">last()</span></code><span class="deltaxml-new" style="background:#90EE90"> function, the implementation can stream and ignore the context size.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">If the implementation supports passing PSVI annotations between steps, the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:split-sequence</span></code><span class="deltaxml-new" style="background:#90EE90"> step </span><span class="rfc2119" id="c.split-sequence.9.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> preserve any annotations that appear in the input.</span></p></section><section id="c.store" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.26 p:store</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:store</span></code><span class="deltaxml-new" style="background:#90EE90"> step stores (a possibly serialized version of) its input to a URI. This step outputs a reference to the location of the stored document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:store</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">*/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">href</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">byte-order-mark</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">            </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">cdata-section-elements</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">''</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">ListOfQNames</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-public</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-system</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">escape-uri-attributes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">include-content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">indent</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">media-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">method</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'xml'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">normalization-form</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'none'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">NormalizationForm</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">omit-xml-declaration</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">standalone</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'omit'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">   </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">undeclare-prefixes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'1.0'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.store.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:store</span></code><span class="deltaxml-new" style="background:#90EE90"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-new" style="background:#90EE90">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> value).</span></p><p><span class="deltaxml-new" style="background:#90EE90">The step attempts to store the XML document to the specified URI. </span><a name="err.inline.C0050"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0050"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0050</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the URI scheme is not supported or the step cannot store to the specified location.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The output of this step is a document containing a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:result</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element whose content is the absolute URI of the document stored by the step.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The standard serialization options are provided to control the serialization of XML content when it is stored. These options are as specified in </span><a href="#serialization-options" title="Serialization Options"><span class="deltaxml-new" style="background:#90EE90">Section 1.3, “Serialization Options”</span></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></section><section id="c.string-replace" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.27 p:string-replace</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:string-replace</span></code><span class="deltaxml-new" style="background:#90EE90"> step matches nodes in the document provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port and replaces them with the string result of evaluating an XPath expression.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:string-replace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">     </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.string-replace.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.string-replace.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XPathExpression.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option. For each matching node, the XPath expression provided by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><span class="deltaxml-new" style="background:#90EE90"> option is evaluated with the matching node as the XPath context node. The string value of the result is used in the output. Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression given in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option matches an </span><em><span class="deltaxml-new" style="background:#90EE90">attribute</span></em><span class="deltaxml-new" style="background:#90EE90">, the string value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><span class="deltaxml-new" style="background:#90EE90"> expression is used as the new value of the attribute in the output. If the attribute is named “</span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">”, the base URI of the element </span><span class="rfc2119" id="c.string-replace.7.5"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-new" style="background:#90EE90">not</span></em><span class="deltaxml-new" style="background:#90EE90"> just its contents) is replaced by the string value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">replace</span></code><span class="deltaxml-new" style="background:#90EE90"> expression.</span></p></section><section id="c.unescape-markup" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.28 p:unescape-markup</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:unescape-markup</span></code><span class="deltaxml-new" style="background:#90EE90"> step takes the string value of the document element and parses the content as if it was a Unicode character stream containing serialized XML. The output consists of the same document element with children that result from the parse. This is the reverse of the </span><a href="#c.escape-markup"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:escape-markup</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:unescape-markup</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml text/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                   </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'application/xml'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">charset</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                     </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.unescape-markup.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. It </span><span class="rfc2119" id="c.unescape-markup.4.4"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be absolute, but will not be resolved.</span></p><p><span class="deltaxml-new" style="background:#90EE90">When the string value is parsed, the original document element is preserved so that the result will be well-formed XML even if the content consists of multiple, sibling elements.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> option specifies a default namespace. Elements that are in no namespace in the unescaped content will be placed into this namespace unless there is an in-scope namespace declaration that specifies a different namespace (or explicitly undeclares the default namespace).</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.unescape-markup.7.2"><span class="deltaxml-new" style="background:#90EE90">may</span></span><span class="deltaxml-new" style="background:#90EE90"> be used to specify an alternate content type for the string value. An implementation </span><span class="rfc2119" id="c.unescape-markup.7.3"><span class="deltaxml-new" style="background:#90EE90">may</span></span><span class="deltaxml-new" style="background:#90EE90"> use a different parser to produce XML content depending on the specified content-type. For example, an implementation might provide an HTML to XHTML parser (e.g. [</span><a href="#tidy"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">HTML Tidy</span></span></a><span class="deltaxml-new" style="background:#90EE90">] or [</span><a href="#tagsoup"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">TagSoup</span></span></a><span class="deltaxml-new" style="background:#90EE90">]) for the content type '</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text/html</span></code><span class="deltaxml-new" style="background:#90EE90">'.</span></p><p><span class="deltaxml-new" style="background:#90EE90">All implementations </span><span class="rfc2119" id="c.unescape-markup.8.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> support the content type </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">application/xml</span></code><span class="deltaxml-new" style="background:#90EE90">, and must use a standard XML parser for it. </span><a name="err.inline.C0051"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0051"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0051</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the content-type specified is not supported by the implementation. </span><a name="impl-12"></a><span class="deltaxml-new" style="background:#90EE90">Behavior of </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:unescape-markup</span></code><span class="deltaxml-new" style="background:#90EE90"> for </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90">s other than </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">application/xml</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> option specifies how the data is encoded. All implementations </span><span class="rfc2119" id="c.unescape-markup.9.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> support the </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90"> encoding (and the absence of an encoding option, which implies that the content is plain Unicode text). </span><a name="err.inline.C0052.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0052"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0052</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the encoding specified is not supported by the implementation.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If an </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified, a </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">charset</span></code><span class="deltaxml-new" style="background:#90EE90"> may also be specified. The character set may be specified as a parameter on the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> or via the separate </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">charset</span></code><span class="deltaxml-new" style="background:#90EE90"> option. If it is specified in both places, the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">charset</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.unescape-markup.10.6"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the specified </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90">, then the character set </span><span class="rfc2119" id="c.unescape-markup.11.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be specified. </span><a name="err.inline.C0010"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0010"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0010</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if an encoding of </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">base64</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified and the character set is not specified or if the specified character set is not supported by the implementation. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The octet-stream that results from decoding the text </span><span class="rfc2119" id="c.unescape-markup.12.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be interpreted using the character encoding named by the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">charset</span></code><span class="deltaxml-new" style="background:#90EE90"> option to produce a sequence of Unicode characters to parse.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If no </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified, the character set is ignored, irrespective of where it was specified.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For example, with the 'namespace' option set to the XHTML namespace, the following input:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;description&gt;
&amp;lt;p&gt;This is a chunk.&amp;lt;/p&gt;
&amp;lt;p&gt;This is a another chunk.&amp;lt;/p&gt;
&lt;/description&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">would produce:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;description&gt;
&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;This is a chunk.&lt;/p&gt;
&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;This is a another chunk.&lt;/p&gt;
&lt;/description&gt;</span></code></pre></section><section id="c.unwrap" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.29 p:unwrap</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:unwrap</span></code><span class="deltaxml-new" style="background:#90EE90"> step replaces matched elements with their children.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:unwrap</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.unwrap.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.7"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if that pattern matches anything other than element nodes.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Every element in the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document that matches the specified </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> pattern is replaced by its children, effectively “unwrapping” the children from their parent. Non-element nodes and unmatched elements are passed through unchanged.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">The matching applies to the entire document, not just the “top-most” matches. A pattern of the form </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">h:div</span></code><span class="deltaxml-new" style="background:#90EE90"> will replace </span><em><span class="deltaxml-new" style="background:#90EE90">all</span></em><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">h:div</span></code><span class="deltaxml-new" style="background:#90EE90"> elements, not just the top-most ones.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">This step produces a single document; if the document element is unwrapped, the result might not be well-formed XML.</span></p></section><section id="c.wrap" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.30 p:wrap</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:wrap</span></code><span class="deltaxml-new" style="background:#90EE90"> step wraps matching nodes in the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document with a new parent element.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:wrap</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">           </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.wrap.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">wrapper-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the wrapper. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">wrapper-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the wrapper element. </span><a name="err.inline.D0034.5"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.wrap.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.8"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0023</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the pattern matches anything other than document, element, text, processing instruction, and comment nodes. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.wrap.6.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XPathExpression.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the node matched is the document node (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">match="/"</span></code><span class="deltaxml-new" style="background:#90EE90">), the result is a new document where the document element is a new element node whose QName is the value specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option. That new element contains copies of all of the children of the original document node.</span></p><p><span class="deltaxml-new" style="background:#90EE90">When the match pattern does not match the document node, every node that matches the specified </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> pattern is replaced with a new element node whose QName is the value specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option. The content of that new element is a copy of the original, matching node. The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:wrap</span></code><span class="deltaxml-new" style="background:#90EE90"> step performs a "deep" wrapping, the children of the matching node and their descendants are processed and wrappers are added to all matching nodes. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><span class="deltaxml-new" style="background:#90EE90"> option can be used to group adjacent matching nodes in a single wrapper element. The specified XPath expression is evaluated for each matching node with that node as the XPath context node. Whenever two or more adjacent matching nodes have the same “group adjacent” value, they are wrapped together in a single wrapper element.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Two matching nodes are considered adjacent if and only if they are siblings and either there are no nodes between them or all intervening, non-matching nodes are whitespace text, comment, or processing instruction nodes.</span></p></section><section id="c.wrap-sequence" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.31 p:wrap-sequence</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:wrap-sequence</span></code><span class="deltaxml-new" style="background:#90EE90"> step accepts a sequence of documents and produces either a single document or a new sequence of documents.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:wrap-sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper-prefix</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrapper-namespace</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">           </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XPathExpression</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.wrap-sequence.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">wrapper-namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> may be used to specify the namespace of the wrapper. In that case, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">wrapper-prefix</span></code><span class="deltaxml-new" style="background:#90EE90"> may be specified to suggest a prefix for the wrapper element. </span><a name="err.inline.D0034.6"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.wrap-sequence.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an XPathExpression.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In its simplest form, </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:wrap-sequence</span></code><span class="deltaxml-new" style="background:#90EE90"> takes a sequence of documents and produces a single, new document by placing each document in the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> sequence inside a new document element as sequential siblings. The name of the document element is the value specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrapper</span></code><span class="deltaxml-new" style="background:#90EE90"> option.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><span class="deltaxml-new" style="background:#90EE90"> option can be used to group adjacent documents. The </span><span class="xspecref"><a href="../xproc20/#xpath-context"><span class="deltaxml-new" style="background:#90EE90">XPath context</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> for the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">group-adjacent</span></code><span class="deltaxml-new" style="background:#90EE90"> option changes over time. For each document that appears on the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the expression is evaluated with that document as the context document. The context position (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">position()</span></code><span class="deltaxml-new" style="background:#90EE90">) is the position of that document within the sequence and the context size (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">last()</span></code><span class="deltaxml-new" style="background:#90EE90">) is the total number of documents in the sequence. Whenever two or more sequentially adjacent documents have the same “group adjacent” value, they are wrapped together in a single wrapper element. </span></p></section><section id="c.xinclude" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.32 p:xinclude</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xinclude</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies [</span><a href="#xinclude"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XInclude</span></span></a><span class="deltaxml-new" style="background:#90EE90">] processing to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:xinclude</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">fixup-xml-base</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">fixup-xml-lang</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">fixup-xml-base</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.xinclude.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean. If it is true, base URI fixup will be performed as per [</span><a href="#xinclude"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XInclude</span></span></a><span class="deltaxml-new" style="background:#90EE90">].</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">fixup-xml-lang</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.xinclude.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean. If it is true, language fixup will be performed as per [</span><a href="#xinclude"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XInclude</span></span></a><span class="deltaxml-new" style="background:#90EE90">].</span></p><p><span class="deltaxml-new" style="background:#90EE90">The included documents are located with the base URI of the input document and are not provided as input to the step.</span></p><p><a name="err.inline.C0029"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0029"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0029</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if an XInclude error occurs during processing. </span></p></section><section id="c.xslt" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.1.33 p:xslt</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xslt</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies an [</span><a href="#xslt10"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XSLT 1.0</span></span></a><span class="deltaxml-new" style="background:#90EE90">] or [</span><a href="#xslt20"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XSLT 2.0</span></span></a><span class="deltaxml-new" style="background:#90EE90">] stylesheet to a document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:xslt</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">stylesheet</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">secondary</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">initial-mode</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                 </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">template-name</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">output-base-uri</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">             </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                     </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">If present, the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">initial-mode</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.xslt.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If present, the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">template-name</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.xslt.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If present, the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">output-base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.xslt.6.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xslt</span></code><span class="deltaxml-new" style="background:#90EE90"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-new" style="background:#90EE90">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> value).</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the step specifies a </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90">, then that version of XSLT </span><span class="rfc2119" id="c.xslt.7.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used to process the transformation. </span><a name="err.inline.C0038"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0038"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0038</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the specified version is not available. If the step does not specify a version, the implementation may use any version it has available and may use any means to determine what version to use, including, but not limited to, examining the version of the stylesheet.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The XSLT stylesheet provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">stylesheet</span></code><span class="deltaxml-new" style="background:#90EE90"> port is applied to the document on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. Any parameters passed in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> option are used to define top-level stylesheet parameters. The primary result document of the transformation, if there is one, appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port. At most one document can appear on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port. All other result documents appear on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">secondary</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span><a name="impl-13"></a><span class="deltaxml-new" style="background:#90EE90">The order in which result documents appear on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">secondary</span></code><span class="deltaxml-new" style="background:#90EE90"> port is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. If XSLT 1.0 is used, an empty sequence of documents </span><span class="rfc2119" id="c.xslt.8.8"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> appear on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">secondary</span></code><span class="deltaxml-new" style="background:#90EE90"> port.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If a sequence of documents is provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the first document is used as the primary input document. The whole sequence is also the default collection. If no documents are provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the primary input document is undefined and the default collection is empty. </span><a name="err.inline.C0039"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0039"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0039</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if a sequence of documents (including an empty sequence) is provided to an XSLT 1.0 step. </span></p><p><span class="deltaxml-new" style="background:#90EE90">A dynamic error occurs if the XSLT processor signals a fatal error. This includes the case where the transformation terminates due to a </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">xsl:message</span></code><span class="deltaxml-new" style="background:#90EE90"> instruction with a </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">terminate</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute value of “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">yes</span></code><span class="deltaxml-new" style="background:#90EE90">”. </span><a name="impl-14"></a><span class="deltaxml-new" style="background:#90EE90">How XSLT message termination errors are reported to the XProc processor is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The invocation of the transformation is controlled by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">initial-mode</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">template-name</span></code><span class="deltaxml-new" style="background:#90EE90"> options that set the initial mode and/or named template in the XSLT transformation where processing begins. </span><a name="err.inline.C0056"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0056"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0056</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the specified initial mode or named template cannot be applied to the specified stylesheet. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">output-base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option sets the context's output base URI per the XSLT 2.0 specification, otherwise the base URI of the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> document is the base URI of the first document in the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port's sequence. If the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">output-base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> option is not absolute, it will be resolved using the base URI of its </span><a href="../xproc20/#p.option"><span class="deltaxml-new" style="background:#90EE90">p:option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> element. An XSLT 1.0 step </span><span class="rfc2119" id="c.xslt.12.6"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> use the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">output-base-uri</span></code><span class="deltaxml-new" style="background:#90EE90"> as the base URI of its output, if the option is specified.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If XSLT 2.0 is used, the outputs of this step </span><span class="rfc2119" id="c.xslt.13.1"><span class="deltaxml-new" style="background:#90EE90">may</span></span><span class="deltaxml-new" style="background:#90EE90"> include PSVI annotations.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The static and initial dynamic contexts of the XSLT processor are the contexts defined in </span><span class="xspecref"><a href="../xproc20/#step-xpath-context-20"><span class="deltaxml-new" style="background:#90EE90">Section 2.7.2, “Step XPath Context”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> with the following adjustments.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The dynamic context is augmented as follows:</span></p><div class="variablelist"><dl><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Context item</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The first document that appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Variable values</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Any parameters passed in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> option are available as variable bindings to the XSLT processor.</span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Function implementations</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The function implementations provided by the XSLT processor.</span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Default collection</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The sequence of documents provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span></p></dd></dl></div></section></section><section id="std-optional" class="section"><div class="section-titlepage"><h3><span class="deltaxml-new" style="background:#90EE90">1.2 Optional Steps</span></h3></div><p><span class="deltaxml-new" style="background:#90EE90">The following steps are optional. If they are supported by a processor, they must conform to the semantics outlined here, but a conformant processor is not required to support all (or any) of these steps.</span></p><section id="c.exec" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.1 p:exec</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><span class="deltaxml-new" style="background:#90EE90"> step runs an external command passing the input that arrives on its </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port as standard input, reading </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> from standard output, and </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">errors</span></code><span class="deltaxml-new" style="background:#90EE90"> from standard error.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">errors</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">exit-status</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">command</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">     </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">args</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">''</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">            </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">cwd</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">source-is-xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">result-is-xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrap-result-lines</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">errors-is-xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">wrap-error-lines</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">path-separator</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">failure-threshold</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">          </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">arg-separator</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">' '</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">byte-order-mark</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">            </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">cdata-section-elements</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">''</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">ListOfQNames</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-public</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">doctype-system</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">              </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">escape-uri-attributes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">include-content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">indent</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">media-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                  </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">method</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'xml'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">normalization-form</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'none'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">NormalizationForm</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">omit-xml-declaration</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">standalone</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'omit'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">   </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">undeclare-prefixes</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">         </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'1.0'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">      </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The values of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">command</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">args</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">cwd</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">path-separator</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">arg-separator</span></code><span class="deltaxml-new" style="background:#90EE90"> options </span><span class="rfc2119" id="c.exec.4.6"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be strings.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The values of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">source-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">result-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">errors-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">fix-slashes</span></code><span class="deltaxml-new" style="background:#90EE90"> options </span><span class="rfc2119" id="c.exec.5.5"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be boolean.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><span class="deltaxml-new" style="background:#90EE90"> step executes the command passed on </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">command</span></code><span class="deltaxml-new" style="background:#90EE90"> with the arguments passed on </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">args</span></code><span class="deltaxml-new" style="background:#90EE90">. The processor does not interpolate the values of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">command</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">args</span></code><span class="deltaxml-new" style="background:#90EE90"> (for example, expanding references to environment variables). </span><a name="err.inline.C0033"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0033"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0033</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the command cannot be run. </span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">cwd</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified, then the current working directory is changed to the value of that option before execution begins. </span><a name="err.inline.C0034"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0034"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0034</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the current working directory cannot be changed to the value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">cwd</span></code><span class="deltaxml-new" style="background:#90EE90"> option. </span><a name="impl-15"></a><span class="deltaxml-new" style="background:#90EE90">If </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">cwd</span></code><span class="deltaxml-new" style="background:#90EE90"> is not specified, the current working directory is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">path-separator</span></code><span class="deltaxml-new" style="background:#90EE90"> option is specified, every occurrence of the character identified as the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">path-separator</span></code><span class="deltaxml-new" style="background:#90EE90"> character that occurs in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">command</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">args</span></code><span class="deltaxml-new" style="background:#90EE90">, or </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">cwd</span></code><span class="deltaxml-new" style="background:#90EE90"> will be replaced by the platform-specific path separator character. </span><a name="err.inline.C0063"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0063"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0063</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">path-separator</span></code><span class="deltaxml-new" style="background:#90EE90"> option is specified and is not exactly one character long. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">args</span></code><span class="deltaxml-new" style="background:#90EE90"> option is a string. In order to support passing more than one argument to a command, the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">args</span></code><span class="deltaxml-new" style="background:#90EE90"> string is broken into a sequence of values. The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">arg-separator</span></code><span class="deltaxml-new" style="background:#90EE90"> option specifies the character that is used to separate values; by default it is a single space </span><a name="err.inline.C0066"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0066"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0066</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">arg-separator</span></code><span class="deltaxml-new" style="background:#90EE90"> option is specified and is not exactly one character long. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The following examples of </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><span class="deltaxml-new" style="background:#90EE90"> are equivalent. The first uses the default </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">arg-separator</span></code><span class="deltaxml-new" style="background:#90EE90">:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:exec command="someCommand" args="arg1 arg2 arg3"/&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">The second specifies an alternate separator:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:exec command="someCommand" args="arg1,arg2,arg3"
	arg-separator=","/&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">If one of the arguments contains a space (e.g., a filename that contains a space), then you must specify an alternate separator.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port is declared to accept a sequence so that it can be empty. If no document appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, then the command receives nothing on standard input. If a document does arrive on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, it will be passed to the command as its standard input. </span><a name="err.inline.D0006"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.D0006"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XD0006</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if more than one document appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><span class="deltaxml-new" style="background:#90EE90"> step. If </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">source-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90"> is true, the serialization options are used to convert the input into serialized XML which is passed to the command, otherwise the XPath string-value of the document is passed.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The standard output of the command is read and returned on </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90">; the standard error output is read and returned on </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">errors</span></code><span class="deltaxml-new" style="background:#90EE90">. In order to assure that the result will be an XML document, each of the results will be wrapped in a </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:result</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">result-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90"> is true, the standard output of the program is assumed to be XML and will be parsed as a single document. If it is false, the output is assumed </span><em><span class="deltaxml-new" style="background:#90EE90">not</span></em><span class="deltaxml-new" style="background:#90EE90"> to be XML and will be returned as escaped text.</span></p><p id="cv.line"><span class="deltaxml-new" style="background:#90EE90">If </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrap-result-lines</span></code><span class="deltaxml-new" style="background:#90EE90"> is true, a </span><a href="#cv.line"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:line</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element will be wrapped around each line of output.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:line&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:line&gt;</span></code></p><p><a name="err.inline.C0035"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0035"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0035</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to specify both </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">result-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrap-result-lines</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The same rules apply to the standard error output of the program, with the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">errors-is-xml</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">wrap-error-lines</span></code><span class="deltaxml-new" style="background:#90EE90"> options, respectively.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If either of the results are XML, they </span><span class="rfc2119" id="c.exec.22.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be parsed with namespaces enabled and validation turned off, just like </span><a href="../xproc20/#p.document"><span class="deltaxml-new" style="background:#90EE90">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">exit-status</span></code><span class="deltaxml-new" style="background:#90EE90"> port always returns a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:result</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element which contains the system exit status that the process returned. </span><a name="impl-16"></a><span class="deltaxml-new" style="background:#90EE90">The specific exit status values returned by a process invoked with </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><span class="deltaxml-new" style="background:#90EE90"> are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If a </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">failure-threshold</span></code><span class="deltaxml-new" style="background:#90EE90"> value is supplied, and the exit status is greater than that threshold, then the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:exec</span></code><span class="deltaxml-new" style="background:#90EE90"> step </span><span class="rfc2119" id="c.exec.24.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> fail. </span><a name="err.inline.C0064"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0064"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0064</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the exit code from the command is greater than the specified </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">failure-threshold</span></code><span class="deltaxml-new" style="background:#90EE90"> value. This failure, like any step failure, can be captured with a </span><a href="../xproc20/#p.try"><span class="deltaxml-new" style="background:#90EE90">p:try</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90">.</span></p></section><section id="c.hash" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.2 p:hash</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:hash</span></code><span class="deltaxml-new" style="background:#90EE90"> step generates a hash, or digital “fingerprint”, for some value and injects it into the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:hash</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">value</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">algorithm</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:QName</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">    </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                     </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">algorithm</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be a QName. If it does not have a prefix, then it must be one of the following values: “crc”, “md”, or “sha”.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If a </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> is not specified, the default version is algorithm-defined. For “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">crc</span></code><span class="deltaxml-new" style="background:#90EE90">” it is 32, for “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">md</span></code><span class="deltaxml-new" style="background:#90EE90">” it is 5, for “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">sha</span></code><span class="deltaxml-new" style="background:#90EE90">” it is 1.</span></p><p><span class="deltaxml-new" style="background:#90EE90">A hash is constructed from the string specified in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">value</span></code><span class="deltaxml-new" style="background:#90EE90"> option using the specified algorithm and version. Implementations </span><span class="rfc2119" id="c.hash.6.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> support [</span><a href="#bib.crc"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">CRC32</span></span></a><span class="deltaxml-new" style="background:#90EE90">], [</span><a href="#rfc1321"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">MD5</span></span></a><span class="deltaxml-new" style="background:#90EE90">], and [</span><a href="#bib.sha"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">SHA1</span></span></a><span class="deltaxml-new" style="background:#90EE90">] hashes. </span><a name="impl-17"></a><span class="deltaxml-new" style="background:#90EE90">It is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> what other algorithms are supported. The resulting hash </span><span class="rfc2119" id="c.hash.6.7"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be returned as a string of hexadecimal characters. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be an XSLTMatchPattern.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The hash of the specified value is computed using the algorithm and parameters specified. </span><a name="err.inline.C0036"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0036"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0036</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the requested hash algorithm is not one that the processor understands or if the value or parameters are not appropriate for that algorithm.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option. For each matching node, the string value of the computed hash is used in the output (if more than one node matches, the </span><em><span class="deltaxml-new" style="background:#90EE90">same</span></em><span class="deltaxml-new" style="background:#90EE90"> hash value is used in each match). Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression given in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option matches an </span><em><span class="deltaxml-new" style="background:#90EE90">attribute</span></em><span class="deltaxml-new" style="background:#90EE90">, the hash is used as the new value of the attribute in the output. If the attribute is named “</span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">”, the base URI of the element </span><span class="rfc2119" id="c.hash.10.4"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-new" style="background:#90EE90">not</span></em><span class="deltaxml-new" style="background:#90EE90"> just its contents) is replaced by the hash.</span></p></section><section id="c.in-scope-names" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.3 p:in-scope-names</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:in-scope-names</span></code><span class="deltaxml-new" style="background:#90EE90"> step exposes all of the in-scope variables and options as a set of parameters in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:in-scope-names</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">false</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">Each in-scope variable and option is converted into a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element. The resulting </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements are wrapped in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and the parameter set document is written to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span><a name="impl-18"></a><span class="deltaxml-new" style="background:#90EE90">The order in which </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements occur in the </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For consistency and user convenience, if any of the variables or options have names that are in a namespace, the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">namespace</span></code><span class="deltaxml-new" style="background:#90EE90"> attribute on the </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element </span><span class="rfc2119" id="c.in-scope-names.5.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used. Each </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">name</span></code><span class="rfc2119" id="c.in-scope-names.5.5"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an NCName.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The base URI of the output document is the URI of the pipeline document that contains the step.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For consistency with the </span><a href="#c.parameters"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:parameters</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step, the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> port is not primary.</span></p><section id="ex-in-scope-names" class="section tocsuppress"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.2.3.1 Example</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">This unlikely pipeline demonstrates the behavior of </span><a href="#c.in-scope-names"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:in-scope-names</span></code></a><span class="deltaxml-new" style="background:#90EE90">: </span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                name="main" version="1.0"&gt;
&lt;p:output port="result"&gt;
  &lt;p:pipe step="vars" port="result"/&gt;
&lt;/p:output&gt;

&lt;p:option name="username" required="true"/&gt;
&lt;p:option name="password" required="true"/&gt;
&lt;p:variable name="host" select="'http://example.com/'"/&gt;

&lt;p:in-scope-names name="vars"/&gt;

&lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">Assuming the values supplied for the username and password options are “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">user</span></code><span class="deltaxml-new" style="background:#90EE90">” and “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">pass</span></code><span class="deltaxml-new" style="background:#90EE90">”, respectively, the output would be:</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:param-set xmlns:c="http://www.w3.org/ns/xproc-step"&gt;
  &lt;c:param name="username" namespace="" value="user"/&gt;
  &lt;c:param name="host" namespace="" value="http://example.com/"/&gt;
  &lt;c:param name="password" namespace="" value="pass"/&gt;
&lt;/c:param-set&gt;</span></code></pre></section></section><section id="c.template" class="section ext-optional"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.4 p:template</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">p:template</span></code><span class="deltaxml-new" style="background:#90EE90"> replaces each XPath expression, delimited with curly braces, in the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">template</span></code><span class="deltaxml-new" style="background:#90EE90"> document with the result of evaluating that expression.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:template</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">template</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr kind-attr"><span class="deltaxml-new" style="background:#90EE90">kind</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value kind-value"><span class="deltaxml-new" style="background:#90EE90">parameter</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">While evaluating each expression, the names of any parameters passed to the step are available as variable values in the XPath dynamic context.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The step searches for XPath expressions in attribute values, text content (adjacent text nodes, if they occur in the data model, must be coalesced; this step always processes maximal length text nodes), processing instruction data, and comments. XPath expressions are identified by curly braces, similar to attribute value templates in XSLT or enclosed expressions in XQuery.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In order to allow curly braces to appear literally in content, they can be escaped by doubling them. In other words, where “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">{</span></code><span class="deltaxml-new" style="background:#90EE90">” would start an XPath expression, “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">{{</span></code><span class="deltaxml-new" style="background:#90EE90">” is simply a </span><em><span class="deltaxml-new" style="background:#90EE90">single</span></em><span class="deltaxml-new" style="background:#90EE90">, literal opening curly brace. The same applies for closing curly braces.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Inside an XPath expression, strings quoted by single (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">'</span></code><span class="deltaxml-new" style="background:#90EE90">) or double (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">"</span></code><span class="deltaxml-new" style="background:#90EE90">) quotes are treated literally. Outside of quoted text, it is an error for an opening curly brace to occur. A closing curly brace ends the XPath expression (whether or not it is followed immediately by another closing curly brace).</span></p><p><span class="deltaxml-new" style="background:#90EE90">These parsing rules can be described by the following algorithm, though implementations are by no means required to implement the parsing in exactly this way, provided that they achieve the same results.</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">The parser begins in </span><em><span class="deltaxml-new" style="background:#90EE90">regular-mode</span></em><span class="deltaxml-new" style="background:#90EE90"> at the start of each unit of content where expansion may occur. In </span><em><span class="deltaxml-new" style="background:#90EE90">regular-mode</span></em><span class="deltaxml-new" style="background:#90EE90">: </span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-new" style="background:#90EE90">“</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">{{</span></code><span class="deltaxml-new" style="background:#90EE90">” is replaced by a single “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">{</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">“</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">}}</span></code><span class="deltaxml-new" style="background:#90EE90">” is replaced by a single “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">}</span></code><span class="deltaxml-new" style="background:#90EE90">”. </span></p><p><span class="deltaxml-new" style="background:#90EE90">Note: </span><a name="err.inline.C0067"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0067"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0067</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to encounter a single closing curly brace “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">}</span></code><span class="deltaxml-new" style="background:#90EE90">” that is not immediately followed by another closing curly brace. </span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">A single opening curly brace “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">{</span></code><span class="deltaxml-new" style="background:#90EE90">” (not immediately followed by another opening curly brace) is discarded and the parser moves into </span><em><span class="deltaxml-new" style="background:#90EE90">xpath-mode</span></em><span class="deltaxml-new" style="background:#90EE90">. The inital expression is empty. </span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">All other characters are copied without change.</span></p></li></ol></div></li><li><p><span class="deltaxml-new" style="background:#90EE90">In </span><em><span class="deltaxml-new" style="background:#90EE90">xpath-mode</span></em><span class="deltaxml-new" style="background:#90EE90">:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><a name="err.inline.C0067.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0067"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0067</span></code></a><span class="deltaxml-new" style="background:#90EE90">) to encounter an opening curly brace “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">{</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">A closing curly brace “</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">}</span></code><span class="deltaxml-new" style="background:#90EE90">” is discarded and ends the expression. The expression is evaluated and the result of that evaluation is copied to the output. The parser returns to </span><em><span class="deltaxml-new" style="background:#90EE90">regular-mode</span></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Note: Braces cannot be escaped by doubling them in </span><em><span class="deltaxml-new" style="background:#90EE90">xpath-mode</span></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">A single quote (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">'</span></code><span class="deltaxml-new" style="background:#90EE90">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-new" style="background:#90EE90">single-quote-mode</span></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">A double quote (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">"</span></code><span class="deltaxml-new" style="background:#90EE90">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-new" style="background:#90EE90">double-quote-mode</span></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">All other characters are appended to the current expression.</span></p></li></ol></div></li><li><p><span class="deltaxml-new" style="background:#90EE90">In </span><em><span class="deltaxml-new" style="background:#90EE90">single-quote-mode</span></em><span class="deltaxml-new" style="background:#90EE90">:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-new" style="background:#90EE90">A single quote (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">'</span></code><span class="deltaxml-new" style="background:#90EE90">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-new" style="background:#90EE90">xpath-mode</span></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">All other characters are appended to the current expression.</span></p></li></ol></div></li><li><p><span class="deltaxml-new" style="background:#90EE90">In </span><em><span class="deltaxml-new" style="background:#90EE90">double-quote-mode</span></em><span class="deltaxml-new" style="background:#90EE90">:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-new" style="background:#90EE90">A double quote (</span><code class="code"><span class="deltaxml-new" style="background:#90EE90">"</span></code><span class="deltaxml-new" style="background:#90EE90">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-new" style="background:#90EE90">xpath-mode</span></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">All other characters are appended to the current expression.</span></p></li></ol></div></li></ul></div><p><a name="err.inline.C0067.2"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0067"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0067</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the parser reaches the end of the unit of content and it is not in </span><em><span class="deltaxml-new" style="background:#90EE90">regular-mode</span></em><span class="deltaxml-new" style="background:#90EE90">. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The context node used for each expression is the document passed on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span><a name="err.inline.C0068"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0068"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0068</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if more than one document appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. In an XPath 1.0 implementation, if </span><a href="../xproc20/#p.empty"><span class="deltaxml-new" style="background:#90EE90">p:empty</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> is given or implied on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, an empty document node is used as the context node. In an XPath 2.0 implementation, the context item is undefined. </span><a name="err.inline.C0026"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0026"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0026</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if any XPath expression makes reference to the context node, size, or position when the context item is undefined.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In an attribute value, processing instruction, or comment, the string value of the XPath expression is used. In text content, an expression that selects nodes will cause those nodes to be copied into the template document.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">Depending on which version of XPath an implementation supports, and possibly on the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xpath-version</span></code><span class="deltaxml-new" style="background:#90EE90"> setting on the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:template</span></code><span class="deltaxml-new" style="background:#90EE90">, some implementations may report errors, or different results, than other implementations in those cases where the interpretation of an XPath expression differs between the versions of XPath.</span></p></div><section id="ex-in-scope-names" class="section tocsuppress"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.2.4.1 Example</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">It's quite common to construct documents using values computed by the pipeline. This is particularly (but not exclusively) the case when the pipeline uses the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step. The input to </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:http-request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> is a </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> document; attributes on the </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:request</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element control most of the request parameters; the body of the document forms the body of request.</span></p><p><span class="deltaxml-new" style="background:#90EE90">A typical example looks like this:</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:request method="POST" href="http://example.com/post"
           username="user" password="password"&gt;
&lt;c:body&gt;
  &lt;computed-content/&gt;
&lt;/c:body&gt;
&lt;/c:request&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">If we assume that the </span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> value and the computed content come from an input document, and the username and password are options, then a typical pipeline to compute the request becomes quite complex.</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:pipeline xmlns:p="http://www.w3.org/ns/xproc"
            xmlns:c="http://www.w3.org/ns/xproc-step"
            name="main" version="1.0"&gt;
&lt;p:option name="username" required="true"/&gt;
&lt;p:option name="password" required="true"/&gt;

&lt;p:identity&gt;
  &lt;p:input port="source"&gt;
    &lt;p:inline&gt;
      &lt;c:request method="POST"/&gt;
    &lt;/p:inline&gt;
  &lt;/p:input&gt;
&lt;/p:identity&gt;

&lt;p:add-attribute match="/c:request" attribute-name="href"&gt;
  &lt;p:with-option name="attribute-value" select="/doc/request/@uri"&gt;
    &lt;p:pipe step="main" port="source"/&gt;
  &lt;/p:with-option&gt;
&lt;/p:add-attribute&gt;

&lt;p:add-attribute match="/c:request" attribute-name="username"&gt;
  &lt;p:with-option name="attribute-value" select="$username"/&gt;
&lt;/p:add-attribute&gt;

&lt;p:add-attribute match="/c:request" attribute-name="password"&gt;
  &lt;p:with-option name="attribute-value" select="$password"/&gt;
&lt;/p:add-attribute&gt;

&lt;p:insert position="first-child" match="/c:request"&gt;
  &lt;p:input port="insertion" select="/doc/request"&gt;
    &lt;p:pipe step="main" port="source"/&gt;
  &lt;/p:input&gt;
&lt;/p:insert&gt;

&lt;p:unwrap match="/c:request/request"/&gt;

&lt;/p:pipeline&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">There's nothing wrong with this pipeline, but it requires several steps to accomplish with the pipeline author probably considers a single operation. What's more, the result of these steps is not immediately obvious on casual inspection.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In order to make this simple construction case both literally and conceptually simpler, this note introduces two new XProc steps in the XProc namespace. Support for these steps is optional, but we strongly encourage implementors to provide them.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The new steps are </span><a href="#c.in-scope-names"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:in-scope-names</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and </span><a href="#c.template"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:template</span></code></a><span class="deltaxml-new" style="background:#90EE90">. Taken together, they greatly simplify the pipeline:</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:pipeline xmlns:p="http://www.w3.org/ns/xproc"
            xmlns:c="http://www.w3.org/ns/xproc-step"
            name="main" version="1.0"&gt;
&lt;p:option name="username" required="true"/&gt;
&lt;p:option name="password" required="true"/&gt;

&lt;p:in-scope-names name="vars"/&gt;

&lt;p:template&gt;
  &lt;p:input port="template"&gt;
    &lt;p:inline&gt;
      &lt;c:request method="POST" href="{/doc/request/@uri}"
                 username="{$username}" password="{$password}"&gt;
        { /doc/request/node() }
      &lt;/c:request&gt;
    &lt;/p:inline&gt;
  &lt;/p:input&gt;
  &lt;p:input port="source"&gt;
    &lt;p:pipe step="main" port="source"/&gt;
  &lt;/p:input&gt;
  &lt;p:input port="parameters"&gt;
    &lt;p:pipe step="vars" port="result"/&gt;
  &lt;/p:input&gt;
&lt;/p:template&gt;

&lt;/p:pipeline&gt;</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#c.in-scope-names"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:in-scope-names</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step provides all of the in-scope options and variables in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90"> (this operation is exactly analagous to what the </span><a href="#c.parameters"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:parameters</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step does, except that it operates on the options and variables instead of on parameters).</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#c.template"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:template</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step searches for XPath expressions, delimited by curly braces, in a template document and replaces each with the result of evaluating the expression. All of the parameters passed to the </span><a href="#c.template"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:template</span></code></a><span class="deltaxml-new" style="background:#90EE90"> step are available as in-scope variable names when evaluating each XPath expression.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Where the expressions occur in attribute values, their string value is used. Where they appear in text content, their node values are used.</span></p></section></section><section id="c.uuid" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.5 p:uuid</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:uuid</span></code><span class="deltaxml-new" style="background:#90EE90"> step generates a [</span><a href="#bib.uuid"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">UUID</span></span></a><span class="deltaxml-new" style="background:#90EE90">] and injects it into the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:uuid</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                    </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be an XSLTMatchPattern. The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be an integer.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified, that version of UUID must be computed. </span><a name="err.inline.C0060"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0060"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0060</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the processor does not support the specified </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> of the UUID algorithm. </span><a name="impl-19"></a><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> is not specified, the version of UUID computed is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Implementations </span><span class="rfc2119" id="c.uuid.6.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> support version 4 UUIDs. </span><a name="impl-20"></a><span class="deltaxml-new" style="background:#90EE90">Support for other versions of UUID, and the mechanism by which the necessary inputs are made available for computing other versions, is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option. For each matching node, the generated UUID is used in the output (if more than one node matches, the </span><em><span class="deltaxml-new" style="background:#90EE90">same</span></em><span class="deltaxml-new" style="background:#90EE90"> UUID is used in each match). Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression given in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option matches an </span><em><span class="deltaxml-new" style="background:#90EE90">attribute</span></em><span class="deltaxml-new" style="background:#90EE90">, the UUID is used as the new value of the attribute in the output. If the attribute is named “</span><code class="tag-attribute"><span class="deltaxml-new" style="background:#90EE90">xml:base</span></code><span class="deltaxml-new" style="background:#90EE90">”, the base URI of the element </span><span class="rfc2119" id="c.uuid.8.4"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> also be amended accordingly.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-new" style="background:#90EE90">not</span></em><span class="deltaxml-new" style="background:#90EE90"> just its contents) is replaced by the UUID.</span></p></section><section id="c.validate-with-relax-ng" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.6 p:validate-with-relax-ng</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-relax-ng</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies [</span><a href="#iso19757-2"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RELAX NG</span></span></a><span class="deltaxml-new" style="background:#90EE90">] validation to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-relax-ng</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml */*+xml text/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">dtd-attribute-values</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">dtd-id-idref-warnings</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The values of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-attribute-values</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-id-idref-warnings</span></code><span class="deltaxml-new" style="background:#90EE90"> options </span><span class="rfc2119" id="c.validate-with-relax-ng.4.3"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be booleans.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><span class="deltaxml-new" style="background:#90EE90"> document has an XML media type, then it </span><span class="rfc2119" id="c.validate-with-relax-ng.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be interpreted as a RELAX NG Grammar. If the media type has a “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text</span></code><span class="deltaxml-new" style="background:#90EE90">” type, then it </span><span class="rfc2119" id="c.validate-with-relax-ng.5.4"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be interpreted as a [</span><a href="#relaxng-compact-syntax"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RELAX NG Compact Syntax</span></span></a><span class="deltaxml-new" style="background:#90EE90">] document for validation.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-attribute-values</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, then the attribute value defaulting conventions of [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-new" style="background:#90EE90">] are also applied.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">dtd-id-idref-warnings</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, then the validator </span><span class="rfc2119" id="c.validate-with-relax-ng.7.3"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> treat a schema that is incompatible with the ID/IDREF/IDREFs feature of [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-new" style="background:#90EE90">] as if the document was invalid. </span></p><p><a name="err.inline.C0053"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0053"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0053</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90"> and the input document is not valid.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The output from this step is a copy of the input, possibly augmented by application of the [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. The output of this step </span><span class="rfc2119" id="c.validate-with-relax-ng.9.2"><span class="deltaxml-new" style="background:#90EE90">may</span></span><span class="deltaxml-new" style="background:#90EE90"> include PSVI annotations.</span></p><p><a name="impl-21"></a><span class="deltaxml-new" style="background:#90EE90">Support for [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-new" style="background:#90EE90">] is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></section><section id="c.validate-with-schematron" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.7 p:validate-with-schematron</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-schematron</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies [</span><a href="#iso19757-3"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Schematron</span></span></a><span class="deltaxml-new" style="background:#90EE90">] processing to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-schematron</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">report</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">phase</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'#ALL'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><a name="err.inline.C0054"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0054"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0054</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90"> and any Schematron assertions fail.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">phase</span></code><span class="deltaxml-new" style="background:#90EE90"> option identifies the Schematron validation phase with which validation begins.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> option provides name/value pairs which correspond to Schematron external variables.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> output from this step is a copy of the input.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Schematron assertions and reports, if any, </span><span class="rfc2119" id="c.validate-with-schematron.8.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> appear on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">report</span></code><span class="deltaxml-new" style="background:#90EE90"> port. The output </span><span class="rfc2119" id="c.validate-with-schematron.8.3"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be in </span><em class="citetitle"><span class="deltaxml-new" style="background:#90EE90">Schematron Validation Report Language</span></em><span class="deltaxml-new" style="background:#90EE90"> (SVRL).</span></p><p><span class="deltaxml-new" style="background:#90EE90">The output of this step </span><span class="rfc2119" id="c.validate-with-schematron.9.1"><span class="deltaxml-new" style="background:#90EE90">may</span></span><span class="deltaxml-new" style="background:#90EE90"> include PSVI annotations.</span></p></section><section id="c.validate-with-xml-schema" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.8 p:validate-with-xml-schema</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-xml-schema</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies [</span><a href="#xmlschema-1"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">W3C XML Schema: Part 1</span></span></a><span class="deltaxml-new" style="background:#90EE90">] validity assessment to the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> input.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-xml-schema</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">use-location-hints</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">try-namespaces</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'false'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'true'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:boolean</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">mode</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr select-attr"><span class="deltaxml-new" style="background:#90EE90">select</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value select-value"><span class="deltaxml-new" style="background:#90EE90">'strict'</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:token</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">"strict" | "lax"</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                     </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The values of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">use-location-hints</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">try-namespaces</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><span class="deltaxml-new" style="background:#90EE90"> options </span><span class="rfc2119" id="c.validate-with-xml-schema.4.4"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be boolean.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">mode</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.validate-with-xml-schema.5.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an NMTOKEN whose value is either “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">strict</span></code><span class="deltaxml-new" style="background:#90EE90">” or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">lax</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Validation is performed against the set of schemas represented by the documents on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><span class="deltaxml-new" style="background:#90EE90"> port. These schemas must be used in preference to any schema locations provided by schema location hints encountered during schema validation, that is, schema locations supplied for </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xs:import</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xsi:schema-location</span></code><span class="deltaxml-new" style="background:#90EE90">, or determined by schema-processor-defined namespace-based strategies, for the namespaces covered by the documents available on the schemas port.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xs:include</span></code><span class="deltaxml-new" style="background:#90EE90"> elements occur within the supplied schema documents, they are treated like any other </span><span class="xspecref"><a href="../xproc20/#external-docs"><span class="deltaxml-new" style="background:#90EE90">external documents</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90">. </span><a name="impl-22"></a><span class="deltaxml-new" style="background:#90EE90">It is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90"> if the documents supplied on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">schemas</span></code><span class="deltaxml-new" style="background:#90EE90"> port are considered when resolving </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xs:include</span></code><span class="deltaxml-new" style="background:#90EE90"> elements in the schema documents provided. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">use-location-hints</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">try-namespaces</span></code><span class="deltaxml-new" style="background:#90EE90"> options allow the pipeline author to control how the schema processor should attempt to locate schema documents necessary but not provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><span class="deltaxml-new" style="background:#90EE90"> port. Any schema documents provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">schema</span></code><span class="deltaxml-new" style="background:#90EE90"> port </span><span class="rfc2119" id="c.validate-with-xml-schema.8.5"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used in preference to schema documents located by other means.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">use-location-hints</span></code><span class="deltaxml-new" style="background:#90EE90"> option is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.9.3"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> make use of schema location hints to locate schema documents. If the option is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.9.5"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> ignore any such hints.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">try-namespaces</span></code><span class="deltaxml-new" style="background:#90EE90"> option is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.10.3"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> attempt to dereference the namespace URI to locate schema documents. If the option is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.10.5"><span class="deltaxml-new" style="background:#90EE90">should not</span></span><span class="deltaxml-new" style="background:#90EE90"> dereference namespace URIs.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">mode</span></code><span class="deltaxml-new" style="background:#90EE90"> option allow the pipeline author to control how schema validation begins. The “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">strict</span></code><span class="deltaxml-new" style="background:#90EE90">” mode means that the document element must be declared and schema-valid, otherwise it will be treated as invalid. The “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">lax</span></code><span class="deltaxml-new" style="background:#90EE90">” mode means that the absence of a declaration for the document element does not itself count as an unsuccessful outcome of validation.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the step specifies a </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90">, then that version of XML Schema </span><span class="rfc2119" id="c.validate-with-xml-schema.12.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used to process the validation. </span><a name="err.inline.C0038.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0038"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0038</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the specified version is not available. If the step does not specify a version, the implementation may use any version it has available and may use any means to determine what version to use, including, but not limited to, examining the version of the schema(s).</span></p><p><a name="err.inline.C0053.1"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0053"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0053</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90"> and the input document is not valid. If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">assert-valid</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">, it is not an error for the document to be invalid. In this case, if the implementation does not support the PSVI, </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:validate-with-xml-schema</span></code><span class="deltaxml-new" style="background:#90EE90"> is essentially just an “identity” step, but if the implementation </span><em><span class="deltaxml-new" style="background:#90EE90">does</span></em><span class="deltaxml-new" style="background:#90EE90"> support the PSVI, then the resulting document will have additional type information (at least for the subtrees that are valid).</span></p><p><span class="deltaxml-new" style="background:#90EE90">When XML Schema validation assessment is performed, the processor is invoked in the mode specified by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">mode</span></code><span class="deltaxml-new" style="background:#90EE90"> option. </span><a name="err.inline.C0055"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0055"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0055</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the implementation does not support the specified mode. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> of the assessment is a document with the Post-Schema-Validation-Infoset (PSVI) ([</span><a href="#xmlschema-1"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">W3C XML Schema: Part 1</span></span></a><span class="deltaxml-new" style="background:#90EE90">]) annotations, if the pipeline implementation supports such annotations. If not, the input document is reproduced with any defaulting of attributes and elements performed as specified by the XML Schema recommendation.</span></p></section><section id="c.www-form-urldecode" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.9 p:www-form-urldecode</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:www-form-urldecode</span></code><span class="deltaxml-new" style="background:#90EE90"> step decodes a </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">x-www-form-urlencoded</span></code><span class="deltaxml-new" style="background:#90EE90"> string into an XML representation.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:www-form-urldecode</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">value</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">value</span></code><span class="deltaxml-new" style="background:#90EE90"> option is interpreted as a string of parameter values encoded using the </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">x-www-form-urlencoded</span></code><span class="deltaxml-new" style="background:#90EE90"> algorithm. Each name/value pair is written in a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element. The entire set of parameters is written (as a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param-set</span></code></a><span class="deltaxml-new" style="background:#90EE90">) on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">result</span></code><span class="deltaxml-new" style="background:#90EE90"> output port.</span></p><p><a name="err.inline.C0037"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0037"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0037</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">value</span></code><span class="deltaxml-new" style="background:#90EE90"> provided is not a properly </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">x-www-form-urlencoded</span></code><span class="deltaxml-new" style="background:#90EE90"> value. </span><a name="err.inline.C0061"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0061"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0061</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the name of any encoded parameter name is not a valid </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">xs:NCName</span></code><span class="deltaxml-new" style="background:#90EE90">. In other words, this step can only decode simple name/value pairs where the names do not contain colons or any characters that cannot be used in XML names. </span></p><p><span class="deltaxml-new" style="background:#90EE90">The order of the </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> elements in the result is the same as the order of the encoded parameters, reading from left to right.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If any parameter name occurs more than once in the encoded string, the resulting parameter set will contain a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:param</span></code></a><span class="deltaxml-new" style="background:#90EE90"> for each instance.</span></p></section><section id="c.www-form-urlencode" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.10 p:www-form-urlencode</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:www-form-urlencode</span></code><span class="deltaxml-new" style="background:#90EE90"> step encodes a set of parameter values as a </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">x-www-form-urlencoded</span></code><span class="deltaxml-new" style="background:#90EE90"> string and injects it into the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:www-form-urlencode</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">match</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code><code class="comment"><span class="deltaxml-new" style="background:#90EE90">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-new" style="background:#90EE90">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-new" style="background:#90EE90"> --&gt;</span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option must be an XSLTMatchPattern.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The set of parameters is encoded as a single </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">x-www-form-urlencoded</span></code><span class="deltaxml-new" style="background:#90EE90"> string of name/value pairs. When parameters are encoded into name/value pairs, </span><em><span class="deltaxml-new" style="background:#90EE90">only</span></em><span class="deltaxml-new" style="background:#90EE90"> the local name of each parameter is used. The namespace name is ignored and no prefix or colon appears in the name. </span></p><p><a name="impl-23"></a><span class="deltaxml-new" style="background:#90EE90">The order of the parameters is is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option. For each matching node, the encoded string is used in the output. Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the expression given in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">match</span></code><span class="deltaxml-new" style="background:#90EE90"> option matches an </span><em><span class="deltaxml-new" style="background:#90EE90">attribute</span></em><span class="deltaxml-new" style="background:#90EE90">, the encoded string is used as the new value of the attribute in the output. If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-new" style="background:#90EE90">not</span></em><span class="deltaxml-new" style="background:#90EE90"> just its contents) is replaced by the encoded string.</span></p></section><section id="c.xquery" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.11 p:xquery</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xquery</span></code><span class="deltaxml-new" style="background:#90EE90"> step applies an [</span><a href="#xquery10"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XQuery 1.0</span></span></a><span class="deltaxml-new" style="background:#90EE90">] query to the sequence of documents provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:xquery</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr primary-attr"><span class="deltaxml-new" style="background:#90EE90">primary</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value primary-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">query</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml */*+xml text/*</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr sequence-attr"><span class="deltaxml-new" style="background:#90EE90">sequence</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value sequence-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">version</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                     </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">If a sequence of documents is provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the first document is used as the initial context item. The whole sequence is also the default collection. If no documents are provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port, the initial context item is undefined and the default collection is empty.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">query</span></code><span class="deltaxml-new" style="background:#90EE90"> port must receive a single document:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">If the document root element is </span><a href="#cv.query"><code id="cv.query" class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:query</span></code></a><span class="deltaxml-new" style="background:#90EE90">, the text descendants of this element are considered the query.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-new" style="background:#90EE90">&lt;c:query&gt;</span><br /><span class="deltaxml-new" style="background:#90EE90">    </span><var><span class="deltaxml-new" style="background:#90EE90">string</span></var><br /><span class="deltaxml-new" style="background:#90EE90">&lt;/c:query&gt;</span></code></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">If the document root element is in the XQueryX namespace, the document is treated as an XQueryX-encoded query. </span><a name="impl-24"></a><span class="deltaxml-new" style="background:#90EE90">Support for XQueryX is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">query</span></code><span class="deltaxml-new" style="background:#90EE90"> document has an XML media type, then the string value of the document </span><span class="rfc2119" id="c.xquery.6.3.1.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be treated as the query. If the media type has a “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text</span></code><span class="deltaxml-new" style="background:#90EE90">” type, then it </span><span class="rfc2119" id="c.xquery.6.3.1.4"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be interpreted as the query.</span></p></li><li><p><a name="impl-25"></a><span class="deltaxml-new" style="background:#90EE90">Otherwise, the interpretation of the query is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></li></ul></div><p><span class="deltaxml-new" style="background:#90EE90">If the step specifies a </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90">, then that version of XQuery </span><span class="rfc2119" id="c.xquery.7.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be used to process the transformation. </span><a name="err.inline.C0038.2"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0038"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0038</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the specified version is not available. If the step does not specify a version, the implementation may use any version it has available and may use any means to determine what version to use, including, but not limited to, examining the version of the query.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The result of the </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xquery</span></code><span class="deltaxml-new" style="background:#90EE90"> step must be a sequence of documents. </span><a name="err.inline.C0057"></a><span class="deltaxml-new" style="background:#90EE90">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-new" style="background:#90EE90">dynamic error</span></a></em><span class="deltaxml-new" style="background:#90EE90"> (</span><a href="#err.C0057"><code class="errqname"><span class="deltaxml-new" style="background:#90EE90">err:XC0057</span></code></a><span class="deltaxml-new" style="background:#90EE90">) if the sequence that results from evaluating the XQuery contains items other than documents and elements. Any elements that appear in the result sequence will be treated as documents with the element as their document element.</span></p><p><span class="deltaxml-new" style="background:#90EE90">For example:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">
&lt;c:query&gt;
declare namespace atom="http://www.w3.org/2005/Atom";
/atom:feed/atom:entry
&lt;/c:query&gt;

</span></code></pre><p><span class="deltaxml-new" style="background:#90EE90">The output of this step </span><span class="rfc2119" id="c.xquery.11.1"><span class="deltaxml-new" style="background:#90EE90">may</span></span><span class="deltaxml-new" style="background:#90EE90"> include PSVI annotations.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The static context of the XQuery processor is augmented in the following way:</span></p><div class="variablelist"><dl><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Statically known default collection type</span></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">document()*</span></code></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Statically known namespaces:</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Unchanged from the implementation defaults. No namespace declarations in the XProc pipeline are automatically exposed in the static context. </span></p></dd></dl></div><p><span class="deltaxml-new" style="background:#90EE90">The dynamic context of the XQuery processor is augmented in the following way:</span></p><div class="variablelist"><dl><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Context item</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The first document that appears on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Context position</span></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">1</span></code></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Context size</span></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">1</span></code></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Variable values</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">Any parameters passed in the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90"> option augment any implementation-defined variable bindings known to the XQuery processor. </span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Function implementations</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The function implementations provided by the XQuery processor.</span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Current dateTime</span></span></dt><dd><p><a name="impl-26"></a><span class="deltaxml-new" style="background:#90EE90">The point in time returned as the current dateTime is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Implicit timezone</span></span></dt><dd><p><a name="impl-27"></a><span class="deltaxml-new" style="background:#90EE90">The implicit timezone is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Available documents</span></span></dt><dd><p><a name="impl-28"></a><span class="deltaxml-new" style="background:#90EE90">The set of available documents (those that may be retrieved with a URI) is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Available collections</span></span></dt><dd><p><a name="impl-29"></a><span class="deltaxml-new" style="background:#90EE90">The set of available collections is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-new" style="background:#90EE90">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></dd><dt><span class="term"><span class="deltaxml-new" style="background:#90EE90">Default collection</span></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The sequence of documents provided on the </span><code class="port"><span class="deltaxml-new" style="background:#90EE90">source</span></code><span class="deltaxml-new" style="background:#90EE90"> port. </span></p></dd></dl></div><section id="example-xquery" class="section tocsuppress"><div class="section-titlepage"><h5><span class="deltaxml-new" style="background:#90EE90">1.2.11.1 Example</span></h5></div><p><span class="deltaxml-new" style="background:#90EE90">The following pipeline applies XInclude processing and schema validation before using XQuery:</span></p><figure id="ex.c.xquery" class="example-wrapper"><div class="title"><span class="deltaxml-new" style="background:#90EE90">Example 1. A Sample Pipeline Document</span></div><div class="example"><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:pipeline xmlns:p="http://www.w3.org/ns/xproc" version="1.0"&gt;

&lt;p:xinclude/&gt;

&lt;p:validate-with-xml-schema name="validate"&gt;
  &lt;p:input port="schema"&gt;
    &lt;p:document href="http://example.com/path/to/schema.xsd"/&gt;
  &lt;/p:input&gt;
&lt;/p:validate-with-xml-schema&gt;

&lt;p:xquery&gt;
   &lt;p:input port="query"&gt;
      &lt;p:data href="countp.xq" /&gt;
   &lt;/p:input&gt;
&lt;/p:xquery&gt;

&lt;/p:pipeline&gt;</span></code></pre></div></figure><p><span class="deltaxml-new" style="background:#90EE90">Where </span><code class="filename"><span class="deltaxml-new" style="background:#90EE90">countp.xq</span></code><span class="deltaxml-new" style="background:#90EE90"> might contain:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-new" style="background:#90EE90">&lt;count&gt;{count(.//p)}&lt;/count&gt;</span></code></pre></section></section><section id="c.xsl-formatter" class="section"><div class="section-titlepage"><h4><span class="deltaxml-new" style="background:#90EE90">1.2.12 p:xsl-formatter</span></h4></div><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xsl-formatter</span></code><span class="deltaxml-new" style="background:#90EE90"> step receives an [</span><a href="#xsl11"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XSL 1.1</span></span></a><span class="deltaxml-new" style="background:#90EE90">] document and renders the content. The result of rendering is stored to the URI provided via the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> option. A reference to that result is produced on the output port.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-new" style="background:#90EE90">type</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value type-value"><span class="deltaxml-new" style="background:#90EE90">p:xsl-formatter</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">source</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr content-types-attr"><span class="deltaxml-new" style="background:#90EE90">content-types</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value content-types-value"><span class="deltaxml-new" style="background:#90EE90">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="input"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-new" style="background:#90EE90">port</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value port-value"><span class="deltaxml-new" style="background:#90EE90">result</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">map(xs:QName,item())</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">       </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-req"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">href</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr required-attr"><span class="deltaxml-new" style="background:#90EE90">required</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value required-value"><span class="deltaxml-new" style="background:#90EE90">true</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:anyURI</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">        </span></code></span><br /><span class="deltaxml-new" style="background:#90EE90">     </span><span class="opt-opt"><code><span class="deltaxml-new" style="background:#90EE90">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-new" style="background:#90EE90">name</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value name-value"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code class="attr as-attr"><span class="deltaxml-new" style="background:#90EE90">as</span></code><code><span class="deltaxml-new" style="background:#90EE90">="</span></code><code class="value as-value"><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><code><span class="deltaxml-new" style="background:#90EE90">"</span></code><code><span class="deltaxml-new" style="background:#90EE90">/&gt;</span></code><code><span class="deltaxml-new" style="background:#90EE90">                </span></code></span><br /><code><span class="deltaxml-new" style="background:#90EE90">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The value of the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">href</span></code><span class="deltaxml-new" style="background:#90EE90"> option </span><span class="rfc2119" id="c.xsl-formatter.4.2"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-new" style="background:#90EE90">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup><span class="deltaxml-new" style="background:#90EE90"> or </span><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">p:xsl-formatter</span></code><span class="deltaxml-new" style="background:#90EE90"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-new" style="background:#90EE90">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></span><span class="deltaxml-new" style="background:#90EE90"> value).</span></p><p><span class="deltaxml-new" style="background:#90EE90">The content-type of the output is controlled by the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> option. This option specifies a media type as defined by [</span><a href="#media-types"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">IANA Media Types</span></span></a><span class="deltaxml-new" style="background:#90EE90">]. The option may include media type parameters as well (e.g. "application/someformat; charset=UTF-8"). </span><a name="impl-30"></a><span class="deltaxml-new" style="background:#90EE90">The use of media type parameters on the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> option is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><a name="impl-31"></a><span class="deltaxml-new" style="background:#90EE90">If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">content-type</span></code><span class="deltaxml-new" style="background:#90EE90"> option is not specified, the output type is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. The default </span><span class="rfc2119" id="c.xsl-formatter.6.2"><span class="deltaxml-new" style="background:#90EE90">should</span></span><span class="deltaxml-new" style="background:#90EE90"> be PDF.</span></p><p><a name="impl-32"></a><span class="deltaxml-new" style="background:#90EE90">A formatter may take any number of optional rendering parameters via the step's </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">parameters</span></code><span class="deltaxml-new" style="background:#90EE90">; such parameters are defined by the XSL implementation used and are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The output of this step is a document containing a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-new" style="background:#90EE90">c:result</span></code></a><span class="deltaxml-new" style="background:#90EE90"> element whose content is the absolute URI of the document stored by the step.</span></p></section></section><section id="serialization-options" class="section"><div class="section-titlepage"><h3><span class="deltaxml-new" style="background:#90EE90">1.3 Serialization Options</span></h3></div><p><span class="deltaxml-new" style="background:#90EE90">Several steps in this step library require serialization options to control the serialization of XML. These options are used to control serialization as in the [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Serialization</span></span></a><span class="deltaxml-new" style="background:#90EE90">] specification.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The following options may be present on steps that perform serialization:</span></p><div class="variablelist"><dl><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">byte-order-mark</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.1.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean. If it's not specified, the default varies by encoding: for UTF-16 it's true, for all others, it's false.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">cdata-section-elements</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.2.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a list of </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">s. They are interpreted as elements name.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">doctype-public</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.3.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a string. The public identifier of the doctype.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">doctype-system</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.4.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">anyURI</span></code><span class="deltaxml-new" style="background:#90EE90">. The system identifier of the doctype. It need not be absolute, and is not resolved.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">A character set name. </span><a name="impl-33"></a><span class="deltaxml-new" style="background:#90EE90">If no </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> is specified, the encoding used is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. If the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">method</span></code><span class="deltaxml-new" style="background:#90EE90"> is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml</span></code><span class="deltaxml-new" style="background:#90EE90">” or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xhtml</span></code><span class="deltaxml-new" style="background:#90EE90">”, the implementation defined encoding </span><span class="rfc2119" id="serialization-options.4.5.2.1.1.6"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be either UTF-8 or UTF-16.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">escape-uri-attributes</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.6.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean. It is ignored unless the specified method is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xhtml</span></code><span class="deltaxml-new" style="background:#90EE90">” or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">html</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">include-content-type</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.7.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean. It is ignored unless the specified method is “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xhtml</span></code><span class="deltaxml-new" style="background:#90EE90">” or “</span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">html</span></code><span class="deltaxml-new" style="background:#90EE90">”.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">indent</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.8.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">media-type</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.9.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a string. It specifies the media type (MIME content type). If not specified, the default varies according to the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">method</span></code><span class="deltaxml-new" style="background:#90EE90">:</span></p><div class="variablelist"><dl><dt><span class="term"><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">application/xml</span></code></p></dd><dt><span class="term"><code class="literal"><span class="deltaxml-new" style="background:#90EE90">html</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text/html</span></code></p></dd><dt><span class="term"><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xhtml</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">application/xhtml+xml</span></code></p></dd><dt><span class="term"><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text/plain</span></code></p></dd></dl></div><p><a name="impl-34"></a><span class="deltaxml-new" style="background:#90EE90">For methods other than </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xml</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">html</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">xhtml</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code class="literal"><span class="deltaxml-new" style="background:#90EE90">text</span></code><span class="deltaxml-new" style="background:#90EE90">; the </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">media-type</span></code><span class="deltaxml-new" style="background:#90EE90"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">method</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.10.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a </span><code class="type"><span class="deltaxml-new" style="background:#90EE90">QName</span></code><span class="deltaxml-new" style="background:#90EE90">. It specifies the serialization method.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">normalization-form</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.11.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an NMTOKEN, one of the enumerated values </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">NFC</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">NFD</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">NFKC</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">NFKD</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">fully-normalized</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">none</span></code><span class="deltaxml-new" style="background:#90EE90"> or an implementation-defined value.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">omit-xml-declaration</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.12.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">standalone</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.13.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be an NMTOKEN, one of the enumerated values </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">true</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">false</span></code><span class="deltaxml-new" style="background:#90EE90">, or </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">omit</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">undeclare-prefixes</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.14.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a boolean.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-new" style="background:#90EE90">version</span></code></span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The value of this option </span><span class="rfc2119" id="serialization-options.4.15.2.1.1"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be a string.</span></p></dd></dl></div><p><span class="deltaxml-new" style="background:#90EE90">In order to be consistent with the rest of this specification, boolean values for the serialization parameters must use one of the XML Schema lexical forms for boolean: "true", "false", "1", or "0". This is different from the [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Serialization</span></span></a><span class="deltaxml-new" style="background:#90EE90">] specification which uses “yes” and “no”. No change in semantics is implied by this different spelling.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="option"><span class="deltaxml-new" style="background:#90EE90">method</span></code><span class="deltaxml-new" style="background:#90EE90"> option controls the serialization method used by this component with standard values of 'html', 'xml', 'xhtml', and 'text' but only the 'xml' value is required to be supported. The interpretation of the remaining options is as specified in [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Serialization</span></span></a><span class="deltaxml-new" style="background:#90EE90">].</span></p><p><a name="impl-35"></a><span class="deltaxml-new" style="background:#90EE90">Implementations may support other method values but their results are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-new" style="background:#90EE90">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-new" style="background:#90EE90">XP</span></a></sup></em><span class="deltaxml-new" style="background:#90EE90">. </span></p><p><span class="deltaxml-new" style="background:#90EE90">A minimally conforming implementation must support the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xml</span></code><span class="deltaxml-new" style="background:#90EE90"> output method with the following option values:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">version</span></code><span class="deltaxml-new" style="background:#90EE90"> must support the value </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">1.0</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> must support the values </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">UTF-8</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">omit-xml-declaration</span></code><span class="deltaxml-new" style="background:#90EE90"> must be supported. If the value is not specified or has the value </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">no</span></code><span class="deltaxml-new" style="background:#90EE90">, an XML declaration must be produced.</span></p></li></ul></div><p><span class="deltaxml-new" style="background:#90EE90">All other option values may be ignored for the </span><code class="code"><span class="deltaxml-new" style="background:#90EE90">xml</span></code><span class="deltaxml-new" style="background:#90EE90"> output method.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If a processor chooses to implement an option for serialization, it must conform to the semantics defined in the [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Serialization</span></span></a><span class="deltaxml-new" style="background:#90EE90">] specification.</span></p><div class="note admonition"><h3><span class="deltaxml-new" style="background:#90EE90">Note</span></h3><p><span class="deltaxml-new" style="background:#90EE90">The use-character-maps parameter in [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">Serialization</span></span></a><span class="deltaxml-new" style="background:#90EE90">] specification has not been provided in the standard serialization options provided by this specification.</span></p></div></section></section><section id="std-components" class="section"><div class="section-titlepage"><h2><span class="deltaxml-old" style="background:#FF5555">2 Standard Step Library</span></h2></div><p><span class="deltaxml-old" style="background:#FF5555">This section describes the standard XProc steps. A machine-readable description of these steps may be found in </span><a href="http://www.w3.org/2008/xproc-1.0.xpl"><span class="deltaxml-old" style="background:#FF5555">xproc-1.0.xpl</span></a><span class="deltaxml-old" style="background:#FF5555">. </span></p><p><span class="deltaxml-old" style="background:#FF5555">Some aspects of documents are generally unchanged by steps:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">When a step in this library produces an output document, the base URI of the output is the base URI of the step's primary input document unless the step's process explicitly sets an </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute or the step's description explicitly states how the base URI is constructed.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Unless otherwise specified, steps in this library do not modify the </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-old" style="background:#FF5555">document properties</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> of the documents that flow through them.</span></p></li></ul></div><p id="cv.result"><span class="deltaxml-old" style="background:#FF5555">Also, in this section, several steps use this element for result information:</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:result&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&lt;/c:result&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">When a step uses an XPath to compute an option value, the XPath context is as defined in </span><span class="xspecref"><a href="../xproc20/#xpath-context"><span class="deltaxml-old" style="background:#FF5555">Section 2.7, “XPaths in XProc”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">When a step specifies a particular version of a technology, implementations </span><span class="rfc2119" id="std-components.8.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> implement that version or a subsequent version that is backwards compatible with that version. At user-option, they may implement other non-backwards compatible versions.</span></p><section id="std-required" class="section"><div class="section-titlepage"><h3><span class="deltaxml-old" style="background:#FF5555">2.1 Required Steps</span></h3></div><p><span class="deltaxml-old" style="background:#FF5555">This section describes standard steps that must be supported by any conforming processor.</span></p><section id="c.add-attribute" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.1 p:add-attribute</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:add-attribute</span></code><span class="deltaxml-old" style="background:#FF5555"> step adds a single attribute to a set of matching elements. The input document specified on the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> is processed for matches specified by the match pattern in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option. For each of these matches, the attribute whose name is specified by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option is set to the attribute value specified by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-value</span></code><span class="deltaxml-old" style="background:#FF5555"> option. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The resulting document is produced on the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> output port and consists of a exact copy of the input with the exception of the matched elements. Each of the matched elements is copied to the output with the addition of the specified attribute with the specified value. </span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:add-attribute</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute-name</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">            </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute-value</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.add-attribute.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the match pattern does not match an element.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.add-attribute.6.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">attribute-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the attribute. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">attribute-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the attribute name. </span><a name="err.inline.D0034"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon. The corresponding expanded name is used to construct the attribute.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-value</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.add-attribute.7.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a legal attribute value according to XML.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If an attribute with the same name as the expanded name from the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option exists on the matched element, the value specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-value</span></code><span class="deltaxml-old" style="background:#FF5555"> option is used to set the value of that existing attribute. That is, the value of the existing attribute is changed to the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-value</span></code><span class="deltaxml-old" style="background:#FF5555"> value. </span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">If multiple attributes need to be set on the same element(s), the </span><a href="#c.set-attributes"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:set-attributes</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step can be used to set them all at once.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">This step cannot be used to add namespace declarations. </span><a name="err.inline.C0059"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0059"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0059</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the QName value in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option uses the prefix “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xmlns</span></code><span class="deltaxml-old" style="background:#FF5555">” or any other prefix that resolves to the namespace name “</span><code class="uri"><span class="deltaxml-old" style="background:#FF5555">http://www.w3.org/2000/xmlns/</span></code><span class="deltaxml-old" style="background:#FF5555">”. Note, however, that while namespace declarations cannot be added explicitly by this step, adding an attribute whose name is in a namespace for which there is no namespace declaration in scope on the matched element may result in a namespace binding being added by </span><span class="xspecref"><a href="../xproc20/#namespace-fixup"><span class="deltaxml-old" style="background:#FF5555">Section 2.5.1, “Namespace Fixup on XML Outputs”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If an attribute named </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> is added or changed, the base URI of the element </span><span class="rfc2119" id="c.add-attribute.11.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p></section><section id="c.add-xml-base" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.2 p:add-xml-base</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:add-xml-base</span></code><span class="deltaxml-old" style="background:#FF5555"> step exposes the base URI via explicit </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attributes. The input document from the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port is replicated to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port with </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attributes added to or corrected on each element as specified by the options on this step.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:add-xml-base</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">all</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">relative</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">   </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">all</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.add-xml-base.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">relative</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.add-xml-base.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p><p><a name="err.inline.C0058"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0058"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0058</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">all</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">relative</span></code><span class="deltaxml-old" style="background:#FF5555"> options are </span><em><span class="deltaxml-old" style="background:#FF5555">both</span></em><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:add-xml-base</span></code><span class="deltaxml-old" style="background:#FF5555"> step modifies its input as follows:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">For the document element: force the element to have an </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute with the document's [base URI] property's value as its value.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">For other elements:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">all</span></code><span class="deltaxml-old" style="background:#FF5555"> option has the value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, force the element to have an </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute with the element's [base URI] value as its value.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">If the element's [base URI] is different from the its parent's [base URI], force the element to have an </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute with the following value: if the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">relative</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, a string which, when resolved against the parent's [base URI], will give the element's [base URI], otherwise the element's [base URI].</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Otherwise, if there is an </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute present, remove it. </span></p></li></ul></div></li></ul></div></section><section id="c.cast-content-type" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.3 p:cast-content-type</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:cast-content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> step changes the media type of its input.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:cast-content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The input document is transformed from one media type to another. </span><a name="err.inline.C1002"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1002"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1002</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the supplied </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> is not a valid media type of the form “</span><code class="literal"><em class="replaceable"><code><span class="deltaxml-old" style="background:#FF5555">type</span></code></em><span class="deltaxml-old" style="background:#FF5555">/</span><em class="replaceable"><code><span class="deltaxml-old" style="background:#FF5555">subtype</span></code></em><span class="deltaxml-old" style="background:#FF5555">+</span><em class="replaceable"><code><span class="deltaxml-old" style="background:#FF5555">ext</span></code></em></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">Casting from one XML media type to another simply changes the “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555">” </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-old" style="background:#FF5555">document property</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></li><li id="c.data"><p><span class="deltaxml-old" style="background:#FF5555">Casting from a non-XML media type to an XML media type produces an XML document with a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document element. The original media type will be preserved in the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute on the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:data</span><span class="deltaxml-old" style="background:#FF5555">  content-type? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  charset? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  encoding? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&lt;/c:data&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The content of the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element is the base64 encoded representation of the non-XML content.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Casting from an XML media type to a non-XML media type </span><span class="rfc2119" id="c.cast-content-type.5.3.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> support the case where the input document is a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document. The resulting document will have the specified media type and a </span><em class="glossterm"><a href="../xproc20/#dt-representation"><span class="deltaxml-old" style="background:#FF5555">representation</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> that is the content of the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element after decoding the base64 encoded content.</span></p><p><a name="err.inline.C1004"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1004"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1004</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> contains content is not a valid base64 string.</span></p><p><a name="err.inline.C1005"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1005"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1005</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element does not have a </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute.</span></p><p><a name="err.inline.C1006"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1006"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1006</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> is supplied and is not the same as the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> specified on the </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element. </span></p><p><a name="impl-1"></a><span class="deltaxml-old" style="background:#FF5555">Casting from an XML media type to a non-XML media type when the input document is not a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><a name="impl-2"></a><span class="deltaxml-old" style="background:#FF5555">What happens when one non-XML media type is cast to another non-XML media type is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span><a name="err.inline.C1003"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1003"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1003</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:cast-content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> step cannot perform the requested cast.</span></p></li></ul></div><p><a name="err.inline.C1007"></a><span class="deltaxml-old" style="background:#FF5555">In all cases except when the input document is a </span><a href="#c.data"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:data</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element, it is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1007"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1007</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> is not supplied. </span></p></section><section id="c.compare" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.4 p:compare</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:compare</span></code><span class="deltaxml-old" style="background:#FF5555"> step compares two documents for equality.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:compare</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">alternate</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">fail-if-not-equal</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">fail-if-not-equal</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.compare.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p><p><span class="deltaxml-old" style="background:#FF5555">This step takes single documents on each of two ports and compares them using the </span><code class="function"><span class="deltaxml-old" style="background:#FF5555">fn:deep-equal</span></code><span class="deltaxml-old" style="background:#FF5555"> (as defined in [</span><a href="#xpath-functions"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XPath 2.0 Functions and Operators</span></span></a><span class="deltaxml-old" style="background:#FF5555">]). </span><a name="err.inline.C0019"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0019"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0019</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the documents are not equal, and the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">fail-if-not-equal</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">. If the documents are equal, or if the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">fail-if-not-equal</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">, a </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:result</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document is produced with contents </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555"> if the documents are equal, otherwise </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p></section><section id="c.count" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.5 p:count</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:count</span></code><span class="deltaxml-old" style="background:#FF5555"> step counts the number of documents in the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> input sequence and returns a single document on </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> containing that number. The generated document contains a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:result</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element whose contents is the string representation of the number of documents in the sequence.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:count</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">limit</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">0</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:integer</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">           </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">limit</span></code><span class="deltaxml-old" style="background:#FF5555"> option is specified and is greater than zero, the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:count</span></code><span class="deltaxml-old" style="background:#FF5555"> step will count at most that many documents. This provides a convenient mechanism to discover, for example, if a sequence consists of more than 1 document, without requiring every single document to be buffered before processing can continue.</span></p></section><section id="c.delete" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.6 p:delete</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:delete</span></code><span class="deltaxml-old" style="background:#FF5555"> step deletes items specified by a match pattern from the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> input document and produces the resulting document, with the deleted items removed, on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:delete</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.delete.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. A match pattern may match multiple items to be deleted.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If an element is selected by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option, the entire subtree rooted at that element is deleted.</span></p><p><span class="deltaxml-old" style="background:#FF5555">This step cannot be used to remove namespaces. </span><a name="err.inline.C0062"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0062"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0062</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option matches a namespace node. Also, note that deleting an attribute named </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> does not change the base URI of the element on which it occurred.</span></p></section><section id="c.directory-list" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.7 p:directory-list</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:directory-list</span></code><span class="deltaxml-old" style="background:#FF5555"> step produces a list of the contents of a specified directory.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:directory-list</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">path</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">include-filter</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">RegularExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">exclude-filter</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">RegularExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">path</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.directory-list.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. It is interpreted as an IRI reference. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:directory-list</span></code><span class="deltaxml-old" style="background:#FF5555"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-old" style="background:#FF5555">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> value).</span></p><p><a name="err.inline.C0017"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0017"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0017</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the absolute path does not identify a directory. </span><a name="err.inline.C0012"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0012"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0012</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the contents of the directory path are not available to the step due to access restrictions in the environment in which the pipeline is run.</span></p><p><a name="impl-3"></a><span class="deltaxml-old" style="background:#FF5555">Conformant processors </span><span class="rfc2119" id="c.directory-list.6.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> support directory paths whose scheme is </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">file</span></code><span class="deltaxml-old" style="background:#FF5555">. It is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> what other schemes are supported by </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:directory-list</span></code><span class="deltaxml-old" style="background:#FF5555">, and what the interpretation of 'directory', 'file' and 'contents' is for those schemes. </span></p><p><span class="deltaxml-old" style="background:#FF5555">If present, the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">include-filter</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">exclude-filter</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.directory-list.7.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a regular expression as specified in [</span><a href="#xpath-functions"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XPath 2.0 Functions and Operators</span></span></a><span class="deltaxml-old" style="background:#FF5555">], section 7.61 “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">Regular Expression Syntax</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">include-filter</span></code><span class="deltaxml-old" style="background:#FF5555"> pattern matches a directory entry's name, the entry is included in the output. If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">exclude-filter</span></code><span class="deltaxml-old" style="background:#FF5555"> pattern matches a directory entry's name, the entry is excluded in the output. If both options are provided, the include filter is processed first, then the exclude filter.</span></p><p id="cv.directory"><span class="deltaxml-old" style="background:#FF5555">The result document produced for the specified directory path has a </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document element whose base URI is the directory path and whose </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is the last segment of the directory path (that is, the directory's (local) name).</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:directory</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">name</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    (</span><a href="#cv.file"><span class="deltaxml-old" style="background:#FF5555">c:file</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">     </span><a href="#cv.directory"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">     </span><a href="#cv.other"><span class="deltaxml-old" style="background:#FF5555">c:other</span></a><span class="deltaxml-old" style="background:#FF5555">)*</span><span class="deltaxml-old" style="background:#FF5555">&lt;/c:directory&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">Its contents are determined as follows, based on the entries in the directory identified by the directory path. For each entry in the directory, if either no </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">filter</span></code><span class="deltaxml-old" style="background:#FF5555"> was specified, or the (local) name of the entry matches the filter pattern, a </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:file</span></code></a><span class="deltaxml-old" style="background:#FF5555">, a </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555">, or a </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:other</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element is produced, as follows: </span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">A </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555"> is produced for each subdirectory not determined to be special.</span></p></li><li><p id="cv.file"><span class="deltaxml-old" style="background:#FF5555">A </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:file</span></code></a><span class="deltaxml-old" style="background:#FF5555"> is produced for each file not determined to be special.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:file</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">name</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555"> /&gt;</span></code></p></li><li><p id="cv.other"><a name="impl-4"></a><span class="deltaxml-old" style="background:#FF5555">Any file or directory determined to be special by the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:directory-list</span></code><span class="deltaxml-old" style="background:#FF5555"> step may be output using a </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:other</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element but the criteria for marking a file as special are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:other</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">name</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555"> /&gt;</span></code></p></li></ul></div><p><span class="deltaxml-old" style="background:#FF5555">When a directory entry is a subdirectory, that directory's entries are not output as part of that entry's </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555">. A user must apply this step again to the subdirectory to list subdirectory contents.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Each of the elements </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:file</span></code></a><span class="deltaxml-old" style="background:#FF5555">, </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555">, and </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:other</span></code></a><span class="deltaxml-old" style="background:#FF5555"> has a </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute when it appears within the top-level </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element, whose value is a relative IRI reference, giving the (local) file or directory name.</span></p><p><a name="impl-5"></a><span class="deltaxml-old" style="background:#FF5555">Any attributes other than </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> on </span><a href="#cv.file"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:file</span></code></a><span class="deltaxml-old" style="background:#FF5555">, </span><a href="#cv.directory"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:directory</span></code></a><span class="deltaxml-old" style="background:#FF5555">, or </span><a href="#cv.other"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:other</span></code></a><span class="deltaxml-old" style="background:#FF5555"> are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></section><section id="c.error" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.8 p:error</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:error</span></code><span class="deltaxml-old" style="background:#FF5555"> step generates a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> using the input provided to the step.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:error</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">false</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">code</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">code-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                 </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">code-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">code</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.error.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">code-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the code. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">code-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the code. </span><a name="err.inline.D0034.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-old" style="background:#FF5555">This step uses the document provided on its input as the content of the error raised. An instance of the </span><a href="../xproc20/#cv.errors"><span class="deltaxml-old" style="background:#FF5555">c:errors</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> element will be produced on the error output port, as is always the case for </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic errors</span></a></em><span class="deltaxml-old" style="background:#FF5555">. The error generated can be caught by a </span><a href="../xproc20/#p.try"><span class="deltaxml-old" style="background:#FF5555">p:try</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> just like any other dynamic error.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For authoring convenience, the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:error</span></code><span class="deltaxml-old" style="background:#FF5555"> step is declared with a single, primary output port. With respect to </span><em class="glossterm"><a href="../xproc20/#dt-connection"><span class="deltaxml-old" style="background:#FF5555">connections</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">, this port behaves like any other output port even though nothing can ever appear on it since the step always fails.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For example, given the following invocation:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:error xmlns:my="http://www.example.org/error"
         name="bad-document" code="my:unk12"&gt;
   &lt;p:input port="source"&gt;
     &lt;p:inline&gt;
       &lt;message&gt;The document element is unknown.&lt;/message&gt;
     &lt;/p:inline&gt;
   &lt;/p:input&gt;
&lt;/p:error&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">The error vocabulary element (and document) generated on the error output port would be:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:errors xmlns:c="http://www.w3.org/ns/xproc-step"
          xmlns:p="http://www.w3.org/ns/xproc"
          xmlns:my="http://www.example.org/error"&gt;
 &lt;c:error name="bad-document" type="p:error"
          code="my:unk12"&gt;&lt;message&gt;The document element is unknown.&lt;/message&gt;
&lt;/c:error&gt;
&lt;/c:errors&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">line</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">column</span></code><span class="deltaxml-old" style="background:#FF5555">, or </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">offset</span></code><span class="deltaxml-old" style="background:#FF5555">, might also be present on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:error</span></code><span class="deltaxml-old" style="background:#FF5555"> to identify the location of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:error</span></code><span class="deltaxml-old" style="background:#FF5555"> element in the pipeline.</span></p></section><section id="c.escape-markup" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.9 p:escape-markup</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:escape-markup</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies XML serialization to the children of the document element and replaces those children with their serialization. The outcome is a single element with text content that represents the "escaped" syntax of the children as they were serialized.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:escape-markup</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">cdata-section-elements</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">''</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">ListOfQNames</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-public</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-system</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">escape-uri-attributes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">include-content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">indent</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">media-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">method</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'xml'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">omit-xml-declaration</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">standalone</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'omit'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">   </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">undeclare-prefixes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'1.0'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">This step supports the standard serialization options as specified in </span><a href="#serialization-options" title="Serialization Options"><span class="deltaxml-old" style="background:#FF5555">Section 2.3, “Serialization Options”</span></a><span class="deltaxml-old" style="background:#FF5555">. These options control how the output markup is produced before it is escaped. </span></p><p><span class="deltaxml-old" style="background:#FF5555">For example, the input:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;description&gt;
&lt;div xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;p&gt;This is a chunk of XHTML.&lt;/p&gt;
&lt;/div&gt;
&lt;/description&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">produces:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;description&gt;
&amp;lt;div xmlns="http://www.w3.org/1999/xhtml"&amp;gt;
&amp;lt;p&gt;This is a chunk of XHTML.&amp;lt;/p&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/description&gt;</span></code></pre><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">The result of this step is an XML document that contains the Unicode characters that are the characters that result from escaping the input. It is not encoded characters in a serialized octet stream, therefore, the serialization options related to encoding characters (</span><code class="option"><span class="deltaxml-old" style="background:#FF5555">byte-order-mark</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555">, and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">normalization-form</span></code><span class="deltaxml-old" style="background:#FF5555">) do not apply. They are omitted from the standard serialization options on this step.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">By default, this step </span><span class="rfc2119" id="c.escape-markup.10.1"><span class="deltaxml-old" style="background:#FF5555">must not</span></span><span class="deltaxml-old" style="background:#FF5555"> generate an XML declaration in the escaped result.</span></p></section><section id="c.filter" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.10 p:filter</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:filter</span></code><span class="deltaxml-old" style="background:#FF5555"> step selects portions of the source document based on a (possibly dynamically constructed) XPath select expression.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:filter</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">This step behaves just like an </span><a href="../xproc20/#p.input"><span class="deltaxml-old" style="background:#FF5555">p:input</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> with a </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">select</span></code><span class="deltaxml-old" style="background:#FF5555"> expression except that the select expression is computed dynamically.</span></p></section><section id="c.http-request" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.11 p:http-request</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code><span class="deltaxml-old" style="background:#FF5555"> step provides for interaction with resources over HTTP or related protocols. The input document provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port specifies a request by a single </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element. This element specifies the method, resource, and other request properties as well as possibly including an entity body (content) for the request.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">byte-order-mark</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">            </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">cdata-section-elements</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">''</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">ListOfQNames</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-public</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-system</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">escape-uri-attributes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">include-content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">indent</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">media-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">method</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'xml'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">normalization-form</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'none'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">NormalizationForm</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">omit-xml-declaration</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">standalone</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'omit'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">   </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">undeclare-prefixes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'1.0'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The standard serialization options are provided to control the serialization of any XML content which is sent as part of the request. The effect of these options is as specified in </span><a href="#serialization-options" title="Serialization Options"><span class="deltaxml-old" style="background:#FF5555">Section 2.3, “Serialization Options”</span></a><span class="deltaxml-old" style="background:#FF5555">. See </span><a href="#c.request_body" title="Request Entity body conversion"><span class="deltaxml-old" style="background:#FF5555">Section 2.1.11.2, “Request Entity body conversion”</span></a><span class="deltaxml-old" style="background:#FF5555"> for a discussion of when serialization occurs in constructing a request.</span></p><p><a name="err.inline.C0040"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0040"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0040</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the document element of the document that arrives on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port is not </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><section id="cv.request" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.11.1 Specifying a request</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">An HTTP request is represented by a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code><span class="deltaxml-old" style="background:#FF5555"> element.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:request</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">method</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">NCName</span></var><span class="deltaxml-old" style="background:#FF5555">  href? = </span><var><span class="deltaxml-old" style="background:#FF5555">anyURI</span></var><span class="deltaxml-old" style="background:#FF5555">  detailed? = </span><var><span class="deltaxml-old" style="background:#FF5555">boolean</span></var><span class="deltaxml-old" style="background:#FF5555">  status-only? = </span><var><span class="deltaxml-old" style="background:#FF5555">boolean</span></var><span class="deltaxml-old" style="background:#FF5555">  username? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  password? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  auth-method? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  send-authorization? = </span><var><span class="deltaxml-old" style="background:#FF5555">boolean</span></var><span class="deltaxml-old" style="background:#FF5555">  override-content-type? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    (</span><a href="#cv.header"><span class="deltaxml-old" style="background:#FF5555">c:header</span></a><span class="deltaxml-old" style="background:#FF5555">*,</span><span class="deltaxml-old" style="background:#FF5555">     (</span><a href="#cv.multipart"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">      </span><a href="#cv.body"><span class="deltaxml-old" style="background:#FF5555">c:body</span></a><span class="deltaxml-old" style="background:#FF5555">)?)</span><span class="deltaxml-old" style="background:#FF5555">&lt;/c:request&gt;</span></code></p><p><a name="err.inline.C0006"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0006"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0006</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">method</span></code><span class="deltaxml-old" style="background:#FF5555"> is not specified on a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code><span class="deltaxml-old" style="background:#FF5555">. </span><a name="err.inline.C0005"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0005"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0005</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the request contains a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> but the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">method</span></code><span class="deltaxml-old" style="background:#FF5555"> does not allow for an entity body being sent with the request.</span></p><p><a name="err.inline.C0004"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0004"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0004</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">status-only</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute has the value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555"> and the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">detailed</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute does not have the value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">method</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute specifies the method to be used against the IRI specified by the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute, e.g. </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">GET</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">POST</span></code><span class="deltaxml-old" style="background:#FF5555"> (the value is not case-sensitive). If the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is not absolute, it will be resolved against the base URI of the element on which it is occurs.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">In the case of simple “GET” requests, implementors are encouraged to support as many protocols as practical. In particular, pipeline authors may attempt to use </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> to load documents with computed URIs using the </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">file:</span></code><span class="deltaxml-old" style="background:#FF5555"> scheme.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">username</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is specified, the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">username</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">password</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555">, and </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">send-authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> attributes are used to handle authentication according to the selected authentication method.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For the purposes of avoiding an authentication challenge, if the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">send-authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute has the value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555"> and the authentication method specified by the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555"> supports generation of an </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> header without a challenge, then an </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> header is generated and sent on the first request. If the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">send-authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is absent or has the value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">, then the first request is sent without an </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> header.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the initial response to the request is an authentication challenge, the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">username</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">password</span></code><span class="deltaxml-old" style="background:#FF5555"> and any relevant data from the challenge are used to generate an </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Authorization</span></code><span class="deltaxml-old" style="background:#FF5555"> header and the request is sent again. If that authorization fails, the request is not retried.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Appropriate values for the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute are “Basic” or “Digest” but other values are allowed. If the authentication method is “Basic” or “Digest”, authentication is handled as per [</span><a href="#rfc2617"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RFC 2617</span></span></a><span class="deltaxml-old" style="background:#FF5555">]. </span><a name="impl-6"></a><span class="deltaxml-old" style="background:#FF5555">The interpretation of </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555"> values on </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code><span class="deltaxml-old" style="background:#FF5555"> other than “Basic” or “Digest” is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><a name="err.inline.C0003"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0003"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0003</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if a </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">username</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">password</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified without specifying an </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555">, if the requested </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">auth-method</span></code><span class="deltaxml-old" style="background:#FF5555"> isn't supported, or the authentication challenge contains an authentication method that isn't supported. All implementations are required to support "Basic" and "Digest" authentication per [</span><a href="#rfc2617"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RFC 2617</span></span></a><span class="deltaxml-old" style="background:#FF5555">].</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">c:header</span></code><span class="deltaxml-old" style="background:#FF5555"> element specifies a header name and value, either for inclusion in a request, or as received in a response.</span></p><p id="cv.header" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:header</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">name</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">value</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555"> /&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The request is formulated from the attribute values on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code><span class="deltaxml-old" style="background:#FF5555"> element and its </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:header</span></code></a><span class="deltaxml-old" style="background:#FF5555"> and </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> or </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> children, if present, and transmitted to the host (and port, if present) specified by the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute. The details of how the request entity body, if any, is constructed are given in </span><a href="#c.response_body" title="Converting Response Entity Bodies"><span class="deltaxml-old" style="background:#FF5555">Section 2.1.11.4, “Converting Response Entity Bodies”</span></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">When the request is formulated, the step and/or protocol implementation may add headers as necessary to either complete the request or as appropriate for the content specified (e.g. transfer encodings). A user of this step is guaranteed that their requested headers and content will be sent with the exception of any conflicts with protocol-related headers.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step allows users to specify independently values that are not always independent. For example, some combinations of </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:header</span></code></a><span class="deltaxml-old" style="background:#FF5555"> values (e.g., </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555">) may be inconsistent with values that the step and/or protocol implementation must set. In a few cases, the step provides more than one mechanism to specify what is actually a single value (e.g., the boundary string in multipart messages). </span><a name="err.inline.C0020"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0020"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0020</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the the user specifies a value or values that are inconsistent with each other or with the requirements of the step or protocol. </span></p></section><section id="c.request_body" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.11.2 Request Entity body conversion</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code><span class="deltaxml-old" style="background:#FF5555"> element specifies a multi-part body, per [</span><a href="#rfc1521"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RFC 1521</span></span></a><span class="deltaxml-old" style="background:#FF5555">], either for inclusion in a request or as received in a response.</span></p><p id="cv.multipart" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:multipart</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">content-type</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">boundary</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><a href="#cv.body"><span class="deltaxml-old" style="background:#FF5555">c:body</span></a><span class="deltaxml-old" style="background:#FF5555">+</span><span class="deltaxml-old" style="background:#FF5555">&lt;/c:multipart&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">In the context of a request, the media type of the </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="rfc2119" id="c.request_body.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a multipart media type (i.e. have a main type of 'multipart'). If the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is not specified, a value of "multipart/mixed" will be assumed.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">boundary</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is required and is used to provide a multipart boundary marker. The implementation must use this boundary marker and must prefix the value with the string “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">--</span></code><span class="deltaxml-old" style="background:#FF5555">” when formulating the multipart message. </span><a name="err.inline.C0002"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0002"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0002</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the value starts with the string “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">--</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the boundary is also specified as a parameter in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> option, then the parameter value specified and the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">boundary</span></code><span class="deltaxml-old" style="background:#FF5555"> value specified </span><span class="rfc2119" id="c.request_body.6.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be the same. If the boundary is specified in both the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">boundary</span></code><span class="deltaxml-old" style="background:#FF5555"> option and the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> option then the two values </span><span class="rfc2119" id="c.request_body.6.6"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be the same.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element holds the body or body part of the message. Each of the attributes holds controls some aspect of the encoding the request body or decoding the body element's content when the request is formulated. These are specified as follows:</span></p><p id="cv.body" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:body</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">content-type</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  encoding? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  id? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  description? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">  disposition? = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><var><span class="deltaxml-old" style="background:#FF5555">anyElement</span></var><span class="deltaxml-old" style="background:#FF5555">*</span><span class="deltaxml-old" style="background:#FF5555">&lt;/c:body&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute specifies the media type of the body or body part, that is, the value of its </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555"> header. If the media type is not an XML type or text, the content must already be base64-encoded.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute controls the decoding of the element content for formulating the body. A value of </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555"> indicates the element's content is a base64 encoded string whose byte stream should be sent as the message body. </span><a name="impl-7"></a><span class="deltaxml-old" style="background:#FF5555">An implementation may support encodings other than </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555"> but these encodings and their names are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span><a name="err.inline.C0052"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0052"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0052</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the encoding specified is not supported by the implementation.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step provides only a single set of serialization options for XML media types. There's no direct support for sending a multipart message with two XML parts encoded differently.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">For each body or body part, the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">id</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute specifies the value of the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-ID</span></code><span class="deltaxml-old" style="background:#FF5555"> header; the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">description</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute specifies the value of the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Description</span></code><span class="deltaxml-old" style="background:#FF5555"> header; and the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">disposition</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute specifies the value of the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Disposition</span></code><span class="deltaxml-old" style="background:#FF5555"> header. </span></p><p><span class="deltaxml-old" style="background:#FF5555">If an entity body is to be sent as part of a request (e.g. a </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">POST</span></code><span class="deltaxml-old" style="background:#FF5555">), either a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element, specifying the request entity body, or a </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element, specifying multiple entity body parts, may be used. When </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> is used it may contain multiple </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> children. A </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> specifies the construction of a body or body part as follows:</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute does not specify an XML media type, or the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555">”, then </span><a name="err.inline.C0028"></a><span class="deltaxml-old" style="background:#FF5555">it is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0028"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0028</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the content of the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element does not consist entirely of characters, and the entity body or body part will consist of exactly those characters.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Otherwise (the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute </span><em><span class="deltaxml-old" style="background:#FF5555">does</span></em><span class="deltaxml-old" style="background:#FF5555"> specify an XML media type and the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is </span><em><span class="deltaxml-old" style="background:#FF5555">not</span></em><span class="deltaxml-old" style="background:#FF5555"> 'base64'), </span><a name="err.inline.C0022"></a><span class="deltaxml-old" style="background:#FF5555">it is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0022"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0022</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the content of the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element does not consist of exactly one element, optionally preceded and/or followed by any number of processing instructions, comments or whitespace characters, and the entity body or body part will consist of the serialization of a document node containing that content. The serialization of that document is controlled by the serialization options on the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code><span class="deltaxml-old" style="background:#FF5555"> step itself.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For example, the following input to a </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code><span class="deltaxml-old" style="background:#FF5555"> step will POST a small XML document:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:request method="POST" href="http://example.com/someservice"&gt;
&lt;c:body xmlns:c="http://www.w3.org/ns/xproc-step" content-type="application/xml"&gt;
&lt;doc&gt;
&lt;title&gt;My document&lt;/title&gt;
&lt;/doc&gt;
&lt;/c:body&gt;
&lt;/c:request&gt;
</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">The corresponding request should look something like this:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">POST http://example.com/someservice HTTP/1.1
Host: example.com
Content-Type: application/xml; charset="utf-8"

&lt;?xml version='1.0'?&gt;
&lt;doc&gt;
&lt;title&gt;My document&lt;/title&gt;
&lt;/doc&gt;
</span></code></pre></section><section id="c.request_response" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.11.3 Managing the response</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">The handling of the response to the request and the generation of the step's result document is controlled by the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">status-only</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">override-content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">detailed</span></code><span class="deltaxml-old" style="background:#FF5555"> attributes on the </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> input.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">override-content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute controls interpretation of the response's </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555"> header. If this attribute is present, the response will be treated as if it returned the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555"> given by its value. This original </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555"> header will however be reflected unchanged as a </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:header</span></code></a><span class="deltaxml-old" style="background:#FF5555"> in the result document. </span><a name="err.inline.C0030"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0030"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0030</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">override-content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> value cannot be used (e.g. </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">text/plain</span></code><span class="deltaxml-old" style="background:#FF5555"> to override </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">image/png</span></code><span class="deltaxml-old" style="background:#FF5555">).</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">status-only</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute has the value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, the result document will contain only header information. The entity of the response will not be processed to produce a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#c.response"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:response</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element represents an HTTP response. The response's status code is encoded in the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">status</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute and the headers and entity body are processing into </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:header</span></code></a><span class="deltaxml-old" style="background:#FF5555"> and </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> or </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> content.</span></p><p id="c.response" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:response</span><span class="deltaxml-old" style="background:#FF5555">  status? = </span><var><span class="deltaxml-old" style="background:#FF5555">integer</span></var><span class="deltaxml-old" style="background:#FF5555">&gt;</span><span class="deltaxml-old" style="background:#FF5555">    (</span><a href="#cv.header"><span class="deltaxml-old" style="background:#FF5555">c:header</span></a><span class="deltaxml-old" style="background:#FF5555">*,</span><span class="deltaxml-old" style="background:#FF5555">     (</span><a href="#cv.multipart"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></a><span class="deltaxml-old" style="background:#FF5555"> | </span><span class="deltaxml-old" style="background:#FF5555">      </span><a href="#cv.body"><span class="deltaxml-old" style="background:#FF5555">c:body</span></a><span class="deltaxml-old" style="background:#FF5555">)?)</span><span class="deltaxml-old" style="background:#FF5555">&lt;/c:response&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">detailed</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute determines the content of the result document. If it is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, the response to the request is handled as follows:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-old" style="background:#FF5555">A single </span><a href="#c.response"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:response</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element is produced with the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">status</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute containing the status of the response received.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Each response header is translated into a </span><a href="#cv.header"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:header</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Unless the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">status-only</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute has a value </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, the entity body of the response is converted into a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element via the rules given in </span><a href="#c.response_body" title="Converting Response Entity Bodies"><span class="deltaxml-old" style="background:#FF5555">Section 2.1.11.4, “Converting Response Entity Bodies”</span></a><span class="deltaxml-old" style="background:#FF5555">.</span></p></li></ol></div><p><span class="deltaxml-old" style="background:#FF5555">Otherwise (the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">detailed</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is not specified or its value is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">), the response to the request is handled as follows:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-old" style="background:#FF5555">If the media type (as determined by the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">override-content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute or the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555"> response header) is an XML media type, the entity is decoded if necessary, then parsed as an XML document and produced on the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> output port as the entire output of the step.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Otherwise, the entity body of the response is converted into a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> or </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element via the rules given in </span><a href="#c.response_body" title="Converting Response Entity Bodies"><span class="deltaxml-old" style="background:#FF5555">Section 2.1.11.4, “Converting Response Entity Bodies”</span></a><span class="deltaxml-old" style="background:#FF5555">.</span></p></li></ol></div><p><span class="deltaxml-old" style="background:#FF5555">In either case the base URI of the output document is the resolved value of the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute from the input </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><section id="redirects" class="section"><div class="section-titlepage"><h6><span class="deltaxml-old" style="background:#FF5555">2.1.11.3.1 Redirects</span></h6></div><p><span class="deltaxml-old" style="background:#FF5555">One possible response from an HTTP request is a redirect, indicated by a status code in the three-hundred range. The precise semantics of the 3xx return codes are laid out by section </span><em class="citetitle"><span class="deltaxml-old" style="background:#FF5555">10.3 Redirection 3xx</span></em><span class="deltaxml-old" style="background:#FF5555"> in [</span><a href="#rfc2616"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RFC 2616</span></span></a><span class="deltaxml-old" style="background:#FF5555">]. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step </span><span class="rfc2119" id="redirects.3.2"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> follow redirect requests (in a manner consistent with [</span><a href="#rfc2616"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RFC 2616</span></span></a><span class="deltaxml-old" style="background:#FF5555">]) if they are returned by the server. </span></p></section><section id="cookies" class="section"><div class="section-titlepage"><h6><span class="deltaxml-old" style="background:#FF5555">2.1.11.3.2 Cookies</span></h6></div><p><span class="deltaxml-old" style="background:#FF5555">With one exception, in version 1.0 of XProc, the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step does not provide any standard mechanisms for managing cookies. </span><a name="impl-8"></a><span class="deltaxml-old" style="background:#FF5555">Pipeline authors that need to preserve cookies across several </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> calls in the same pipeline or across multiple invocations of the same or different pipelines will have to rely on </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> mechanisms. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The exception arises in the case of redirection. If a redirect response includes cookies, those cookies </span><span class="rfc2119" id="cookies.3.1"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be forwarded as appropriate to the redirected location when the redirection is followed.</span></p><p><span class="deltaxml-old" style="background:#FF5555">This behavior will allow the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step to interoperate with web services that use cookies as part of an authentication protocol.</span></p></section></section><section id="c.response_body" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.11.4 Converting Response Entity Bodies</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">The entity of a response may be multipart per [</span><a href="#rfc1521"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RFC 1521</span></span></a><span class="deltaxml-old" style="background:#FF5555">]. In those situations, the result document will be a </span><a href="#cv.multipart"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:multipart</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element that contains multiple </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements inside.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">Although it is technically possible for any of the individual parts of a multipart message to </span><em><span class="deltaxml-old" style="background:#FF5555">also</span></em><span class="deltaxml-old" style="background:#FF5555"> be multipart, XProc does not provide a standard representation for such messages. </span><a name="impl-9"></a><span class="deltaxml-old" style="background:#FF5555">The interpretation of a multipart message inside another multipart message is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">The result of the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step is an XML document. For media types (images, binaries, etc.) that can't be represented as a sequence of Unicode characters, the response is encoded as </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555"> and then returned as text children of the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element. If the content is base64-encoded, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute on </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> must be set to “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the media type of the response is a text type with a </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">charset</span></code><span class="deltaxml-old" style="background:#FF5555"> parameter that is a Unicode character encoding (per [</span><a href="#unicodetr17"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Unicode TR#17</span></span></a><span class="deltaxml-old" style="background:#FF5555">]) or is recognized as a non-XML media type whose contents are encoded as a sequence of Unicode characters (e.g. it has a character parameter or the definition of the media type is such that it requires Unicode), the content of the constructed </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element is the translation of the text into a sequence of Unicode characters.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the response is an XML media type, the content of the constructed </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element is the result of decoding the body as necessary, then parsing it with an XML parser. If the content is not well-formed, the step fails.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> in a response, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute </span><span class="rfc2119" id="c.response_body.7.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an exact copy of the value returned in the </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">Content-Type</span></code><span class="deltaxml-old" style="background:#FF5555"> header. That is, it must reflect the content type actually returned, not any override value that may have been specified, and it must include any parameters returned by the server.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In the case of a multipart response, the same rules apply when constructing a </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element for each body part encountered.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">Given the above description, any content identified as </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">text/html</span></code><span class="deltaxml-old" style="background:#FF5555"> will be encoded as (escaped) text or base64-encoded in the </span><a href="#cv.body"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:body</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element, as HTML isn't always well-formed XML. A user can attempt to convert such content into XML using the </span><a href="#c.unescape-markup"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:unescape-markup</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step.</span></p></div></section><section id="example-http-request" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.11.5 HTTP Request Example</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">A simple form might be posted as follows:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:request method="POST" href="http://www.example.com/form-action" xmlns:c="http://www.w3.org/ns/xproc-step"&gt;
&lt;c:body content-type="application/x-www-form-urlencoded"&gt;
name=W3C&amp;amp;spec=XProc
&lt;/c:body&gt;
&lt;/c:request&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">and if the response was an XHTML document, the result document would be:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:response status="200" xmlns:c="http://www.w3.org/ns/xproc-step"&gt;
&lt;c:header name="Date" value=" Wed, 09 May 2007 23:12:24 GMT"/&gt;
&lt;c:header name="Server" value="Apache/1.3.37 (Unix) PHP/4.4.5"/&gt;
&lt;c:header name="Vary" value="negotiate,accept"/&gt;
&lt;c:header name="TCN" value="choice"/&gt;
&lt;c:header name="P3P" value="policyref='http://www.w3.org/2001/05/P3P/p3p.xml'"/&gt;
&lt;c:header name="Cache-Control" value="max-age=600"/&gt;
&lt;c:header name="Expires" value="Wed, 09 May 2007 23:22:24 GMT"/&gt;
&lt;c:header name="Last-Modified" value="Tue, 08 May 2007 16:10:49 GMT"/&gt;
&lt;c:header name="ETag" value="'4640a109;42380ddc'"/&gt;
&lt;c:header name="Accept-Ranges" value="bytes"/&gt;
&lt;c:header name="Keep-Alive" value="timeout=2, max=100"/&gt;
&lt;c:header name="Connection" value="Keep-Alive"/&gt;
&lt;c:body content-type="application/xhtml+xml"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;&lt;title&gt;OK&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;p&gt;OK!&lt;/p&gt;&lt;/body&gt;
&lt;/html&gt;
&lt;/c:body&gt;
&lt;/c:response&gt;</span></code></pre></section></section><section id="c.identity" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.12 p:identity</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:identity</span></code><span class="deltaxml-old" style="background:#FF5555"> step makes a verbatim copy of its input available on its output.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:identity</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">If the implementation supports passing PSVI annotations between steps, the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:identity</span></code><span class="deltaxml-old" style="background:#FF5555"> step </span><span class="rfc2119" id="c.identity.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> preserve any annotations that appear in the input.</span></p></section><section id="c.insert" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.13 p:insert</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:insert</span></code><span class="deltaxml-old" style="background:#FF5555"> step inserts the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">insertion</span></code><span class="deltaxml-old" style="background:#FF5555"> port's document into the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port's document relative to the matching elements in the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port's document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:insert</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">insertion</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'/*'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">position</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">     </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"first-child" | "last-child" | "before" | "after"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.insert.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if that pattern matches anything other than element, text, processing-instruction, or comment nodes. Multiple matches are allowed, in which case multiple copies of the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">insertion</span></code><span class="deltaxml-old" style="background:#FF5555"> documents will occur. If no elements match, then the document is unchanged.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">position</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.insert.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an NMTOKEN in the following list: </span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">“</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">first-child</span></code><span class="deltaxml-old" style="background:#FF5555">” - the insertion is made as the first child of the match;</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">“</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">last-child</span></code><span class="deltaxml-old" style="background:#FF5555">” - the insertion is made as the last child of the match;</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">“</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">before</span></code><span class="deltaxml-old" style="background:#FF5555">” - the insertion is made as the immediate preceding sibling of the match;</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">“</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">after</span></code><span class="deltaxml-old" style="background:#FF5555">” - the insertion is made as the immediate following sibling of the match.</span></p></li></ul></div><p><a name="err.inline.C0025"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0025"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0025</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the match pattern matches anything other than an element node and the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">position</span></code><span class="deltaxml-old" style="background:#FF5555"> option is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">first-child</span></code><span class="deltaxml-old" style="background:#FF5555">” or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">last-child</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p><p><span class="deltaxml-old" style="background:#FF5555">As the inserted elements are part of the output of the step they are not considered in determining matching elements. If an empty sequence appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">insertion</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the result will be the same as the source.</span></p></section><section id="c.label-elements" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.14 p:label-elements</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:label-elements</span></code><span class="deltaxml-old" style="background:#FF5555"> step generates a label for each matched element and stores that label in the specified attribute.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:label-elements</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'xml:id'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">            </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">attribute-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">label</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'concat("_",$p:index)'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'*'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">          </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.label-elements.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">attribute-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the attribute name. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">attribute-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the attribute name. </span><a name="err.inline.D0034.2"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">label</span></code><span class="deltaxml-old" style="background:#FF5555"> option is an XPath expression used to generate the value of the attribute label.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.label-elements.6.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.2"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if that expression matches anything other than element nodes.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><span class="rfc2119" id="c.label-elements.7.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean value and is used to indicate whether existing attribute values are replaced.</span></p><p><span class="deltaxml-old" style="background:#FF5555">This step operates by generating attribute labels for each element matched. For every matched element, the expression is evaluated with the context node set to the matched element. An attribute is added to the matched element using the attribute name is specified the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">attribute</span></code><span class="deltaxml-old" style="background:#FF5555"> option and the string value of result of evaluating the expression. If the attribute already exists on the matched element, the value is replaced with the string value only if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><span class="deltaxml-old" style="background:#FF5555"> option has the value of </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If this step is used to add or change the value of an attribute named “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">”, the base URI of the element </span><span class="rfc2119" id="c.label-elements.9.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p><p><span class="deltaxml-old" style="background:#FF5555">An implementation must bind the variable “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">p:index</span></code><span class="deltaxml-old" style="background:#FF5555">” in the static context of each evaluation of the XPath expression to the position of the element in the sequence of matched elements. In other words, the first element (in document order) matched gets the value “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">1</span></code><span class="deltaxml-old" style="background:#FF5555">”, the second gets the value “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">2</span></code><span class="deltaxml-old" style="background:#FF5555">”, the third, “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">3</span></code><span class="deltaxml-old" style="background:#FF5555">”, etc.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The result of the p:label-elements step is the input document with the attribute labels associated with matched elements. All other non-matching content remains the same.</span></p></section><section id="c.load" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.15 p:load</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><span class="deltaxml-old" style="background:#FF5555"> step has no inputs but produces as its result an XML resource specified by an IRI.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">href</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">dtd-validate</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.load.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. It is interpreted as an IRI reference. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><span class="deltaxml-old" style="background:#FF5555"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-old" style="background:#FF5555">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> value).</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-validate</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.load.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><span class="deltaxml-old" style="background:#FF5555"> step is the same as </span><a href="../xproc20/#p.document"><span class="deltaxml-old" style="background:#FF5555">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> with two additions:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-old" style="background:#FF5555">The URI to be accessed can be constructed dynamically by the pipeline.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><span class="deltaxml-old" style="background:#FF5555"> step has an option to invoke DTD validation. </span></p></li></ol></div><p><span class="deltaxml-old" style="background:#FF5555">When </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-validate</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><span class="deltaxml-old" style="background:#FF5555"> processing is the same as </span><a href="../xproc20/#p.document"><span class="deltaxml-old" style="background:#FF5555">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> processing on the computed </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> value.</span></p><p><span class="deltaxml-old" style="background:#FF5555">When </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-validate</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:load</span></code><span class="deltaxml-old" style="background:#FF5555"> processing is the same as </span><a href="../xproc20/#p.document"><span class="deltaxml-old" style="background:#FF5555">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> processing on the computed </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> value but </span><span class="rfc2119" id="c.load.9.6"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> use a validating parser. </span><a name="err.inline.C0027"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0027"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0027</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the document is not valid or the step doesn't support DTD validation. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The retrieved document is produced on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port. The base URI of the result is the (absolute) IRI used to retrieve it.</span></p></section><section id="c.make-absolute-uris" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.16 p:make-absolute-uris</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:make-absolute-uris</span></code><span class="deltaxml-old" style="background:#FF5555"> step makes an element or attribute's value in the source document an absolute IRI value in the result document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:make-absolute-uris</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">base-uri</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                    </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.make-absolute-uris.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.3"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the pattern matches anything other than element or attribute nodes.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.make-absolute-uris.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. It is interpreted as an IRI reference. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:make-absolute-uris</span></code><span class="deltaxml-old" style="background:#FF5555"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-old" style="background:#FF5555">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> value).</span></p><p><span class="deltaxml-old" style="background:#FF5555">For every element or attribute in the input document which matches the specified pattern, its XPath string-value is resolved against the specified base URI and the resulting absolute IRI is used as the matched node's entire contents in the output.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The base URI used for resolution defaults to the matched attribute's element or the matched element's base URI unless the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option is specified. When the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option is specified, the option value is used as the base URI regardless of any contextual base URI value in the document. This option value is resolved against the base URI of the </span><a href="../xproc20/#p.option"><span class="deltaxml-old" style="background:#FF5555">p:option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> element used to set the option.</span></p><p><a name="impl-10"></a><span class="deltaxml-old" style="background:#FF5555">If the IRI reference specified by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option on </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:make-absolute-uris</span></code><span class="deltaxml-old" style="background:#FF5555"> is not valid, or if it is absent and the input document has no base URI, the results are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></section><section id="c.namespace-rename" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.17 p:namespace-rename</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:namespace-rename</span></code><span class="deltaxml-old" style="background:#FF5555"> step renames any namespace declaration or use of a namespace in a document to a new IRI value.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:namespace-rename</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">from</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">to</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                          </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">apply-to</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'all'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"all" | "elements" | "attributes"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.namespace-rename.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. It </span><span class="rfc2119" id="c.namespace-rename.4.4"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be either empty or absolute, but will not be resolved in any case.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.namespace-rename.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. It </span><span class="rfc2119" id="c.namespace-rename.5.4"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be empty or absolute, but will not be resolved in any case.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">apply-to</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.namespace-rename.6.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be one of “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">all</span></code><span class="deltaxml-old" style="background:#FF5555">”, “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">elements</span></code><span class="deltaxml-old" style="background:#FF5555">”, or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">attributes</span></code><span class="deltaxml-old" style="background:#FF5555">”. If the value is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">elements</span></code><span class="deltaxml-old" style="background:#FF5555">”, only elements will be renamed, if the value is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">attributes</span></code><span class="deltaxml-old" style="background:#FF5555">”, only attributes will be renamed, if the value is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">all</span></code><span class="deltaxml-old" style="background:#FF5555">”, both elements and attributes will be renamed.</span></p><p><a name="err.inline.C0014"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0014"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0014</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the XML namespace (</span><code class="uri"><span class="deltaxml-old" style="background:#FF5555">http://www.w3.org/XML/1998/namespace</span></code><span class="deltaxml-old" style="background:#FF5555">) or the XMLNS namespace (</span><code class="uri"><span class="deltaxml-old" style="background:#FF5555">http://www.w3.org/2000/xmlns/</span></code><span class="deltaxml-old" style="background:#FF5555">) is the value of either the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option or the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is the same as the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option, the input is reproduced unchanged on the output. Otherwise, namespace bindings, namespace attributes and element and attribute names are changed as follows:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">Namespace bindings: If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is present and its value is not the empty string, then every binding of a prefix (or the default namespace) in the input document whose value is the same as the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">replaced in the output with a binding to the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option, provided it is present and not the empty string;</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">otherwise (the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option is not specified or has an empty string as its value) absent from the output.</span></p></li></ul></div><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is absent, or its value is the empty string, then no bindings are changed or removed.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Elements and attributes: If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is present and its value is not the empty string, for every element and attribute, as appropriate, in the input whose namespace name is the same as the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option, in the output its namespace name is</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">replaced with the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option, provided it is present and not the empty string;</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">otherwise (the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option is not specified or has an empty string as its value) changed to have no value.</span></p></li></ul></div><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is absent, or its value is the empty string, then for every element and attribute, as appropriate, whose namespace name has no value, in the output its namespace name is set to the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Namespace attributes: If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option is present and its value is not the empty string, for every namespace attribute in the input whose value is the same as the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option, in the output</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">the namespace attribute's value is replaced with the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option, provided it is present and not the empty string;</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">otherwise (the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option is not specified or has an empty string as its value) the namespace attribute is absent.</span></p></li></ul></div></li></ul></div><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">apply-to</span></code><span class="deltaxml-old" style="background:#FF5555"> option is primarily intended to make it possible to avoid renaming attributes when the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">from</span></code><span class="deltaxml-old" style="background:#FF5555"> option specifies no namespace, since many attributes are in no namespace.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Care should be taken when specifying no namespace with the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">to</span></code><span class="deltaxml-old" style="background:#FF5555"> option. Prefixed names in content, for example QNames and XPath expressions, may end up with no appropriate namespace binding.</span></p></div></section><section id="c.pack" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.18 p:pack</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:pack</span></code><span class="deltaxml-old" style="background:#FF5555"> step merges two document sequences in a pair-wise fashion.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:pack</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">alternate</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">           </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.pack.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">wrapper-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the wrapper. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">wrapper-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the wrapper element. </span><a name="err.inline.D0034.3"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The step takes each pair of documents, in order, one from the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port and one from the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">alternate</span></code><span class="deltaxml-old" style="background:#FF5555"> port, wraps them with a new element node whose QName is the value specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option, and writes that element to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port as a document.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the step reaches the end of one input sequence before the other, then it simply wraps each of the remaining documents in the longer sequence.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">In the common case, where the document element of a document in the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> sequence has two element children, any comments, processing instructions, or white space text nodes that occur between them may have come from either of the input documents; this step does not attempt to distinguish which one.</span></p></div></section><section id="c.parameters" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.19 p:parameters</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> step exposes a set of parameters as a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">Each parameter in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> map is converted into a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element. The resulting </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements are wrapped in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> and the parameter set document is written to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span><a name="impl-11"></a><span class="deltaxml-old" style="background:#FF5555">The order in which </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements occur in the </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For consistency and user convenience, if any of the parameters have names that are in a namespace, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute on the </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element </span><span class="rfc2119" id="c.parameters.5.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used. Each </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="rfc2119" id="c.parameters.5.5"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an NCName.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The base URI of the output document is the URI of the pipeline document that contains the step.</span></p><section id="cv.param" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.19.1 The c:param element</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">A </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code><span class="deltaxml-old" style="background:#FF5555"> represents a parameter on a parameter input.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:param</span><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">name</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">QName</span></var><span class="deltaxml-old" style="background:#FF5555">  namespace? = </span><var><span class="deltaxml-old" style="background:#FF5555">anyURI</span></var><span class="deltaxml-old" style="background:#FF5555">  </span><strong><span class="deltaxml-old" style="background:#FF5555">value</span></strong><span class="deltaxml-old" style="background:#FF5555"> = </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555"> /&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code><span class="deltaxml-old" style="background:#FF5555"> must have the lexical form of a QName.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is specified, then the expanded name of the parameter is constructed from the specified namespace and the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> value. </span><a name="err.inline.D0025"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0025"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0025</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is specified, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> contains a colon, and the specified namespace is not the same as the in-scope namespace binding for the specified prefix. </span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is not specified, and the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> contains a colon, then the expanded name of the parameter is constructed using the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> value and the namespace declarations in-scope on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code><span class="deltaxml-old" style="background:#FF5555"> element.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute is not specified, and the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555"> does not contain a colon, then the expanded name of the parameter is in no namespace.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Any namespace-qualified attribute names that appear on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code><span class="deltaxml-old" style="background:#FF5555"> element are ignored. </span><a name="err.inline.D0014"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0014"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0014</span></code></a><span class="deltaxml-old" style="background:#FF5555">) for any unqualified attribute names other than “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="deltaxml-old" style="background:#FF5555">”, “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555">”, or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">value</span></code><span class="deltaxml-old" style="background:#FF5555">” to appear on a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code><span class="deltaxml-old" style="background:#FF5555"> element.</span></p></section><section id="cv.param-set" class="section"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.1.19.2 The c:param-set element</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">A </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code><span class="deltaxml-old" style="background:#FF5555"> represents a set of parameters on a parameter input.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:param-set&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><a href="#cv.param"><span class="deltaxml-old" style="background:#FF5555">c:param</span></a><span class="deltaxml-old" style="background:#FF5555">*</span><span class="deltaxml-old" style="background:#FF5555">&lt;/c:param-set&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code><span class="deltaxml-old" style="background:#FF5555"> contains zero or more </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements. </span><a name="err.inline.D0018"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0018"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0018</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the parameter list contains any elements other than </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Any namespace-qualified attribute names that appear on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code><span class="deltaxml-old" style="background:#FF5555"> element are ignored. </span><a name="err.inline.D0014.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0014"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0014</span></code></a><span class="deltaxml-old" style="background:#FF5555">) for any unqualified attribute names to appear on a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code><span class="deltaxml-old" style="background:#FF5555"> element.</span></p></section></section><section id="c.rename" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.20 p:rename</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:rename</span></code><span class="deltaxml-old" style="background:#FF5555"> step renames elements, attributes, or processing-instruction targets in a document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:rename</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">new-name</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">     </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">new-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">new-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">               </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be an XSLTMatchPattern. </span><a name="err.inline.C0023.4"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the pattern matches anything other than element, attribute or processing instruction nodes.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">new-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">new-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the new name. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">new-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the new name. </span><a name="err.inline.D0034.4"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon. </span></p><p><span class="deltaxml-old" style="background:#FF5555">Each element, attribute, or processing-instruction in the input matched by the match pattern specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option is renamed in the output to the name specified by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">new-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option matches an attribute and if the element on which it occurs already has an attribute whose expanded name is the same as the expanded name of the specified </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">new-name</span></code><span class="deltaxml-old" style="background:#FF5555">, then the results is as if the current attribute named “</span><em class="replaceable"><code><span class="deltaxml-old" style="background:#FF5555">new-name</span></code></em><span class="deltaxml-old" style="background:#FF5555">” was deleted before renaming the matched attribute.</span></p><p><span class="deltaxml-old" style="background:#FF5555">With respect to attributes named “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">”, the following semantics apply: renaming an </span><em><span class="deltaxml-old" style="background:#FF5555">from</span></em><span class="deltaxml-old" style="background:#FF5555"> “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">” </span><em><span class="deltaxml-old" style="background:#FF5555">to</span></em><span class="deltaxml-old" style="background:#FF5555"> something else has no effect on the underlying base URI of the element; however, if an attribute is renamed </span><em><span class="deltaxml-old" style="background:#FF5555">from</span></em><span class="deltaxml-old" style="background:#FF5555"> something else </span><em><span class="deltaxml-old" style="background:#FF5555">to</span></em><span class="deltaxml-old" style="background:#FF5555"> “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">”, the base URI of the element </span><span class="rfc2119" id="c.rename.8.8"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the pattern matches processing instructions, then it is the processing instruction target that is renamed. </span><a name="err.inline.C0013"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0013"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0013</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the pattern matches a processing instruction and the new name has a non-null namespace. </span></p></section><section id="c.replace" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.21 p:replace</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:replace</span></code><span class="deltaxml-old" style="background:#FF5555"> step replaces matching nodes in its primary input with the document element of the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">replacement</span></code><span class="deltaxml-old" style="background:#FF5555"> port's document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:replace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">replacement</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.replace.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.5"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if that pattern matches anything other than element, text, processing-instruction, or comment nodes. Multiple matches are allowed, in which case multiple copies of the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">replacement</span></code><span class="deltaxml-old" style="background:#FF5555"> document will occur.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Every node in the primary input matching the specified pattern is replaced in the output is replaced by the document element of the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">replacement</span></code><span class="deltaxml-old" style="background:#FF5555"> document. Only non-nested matches are replaced. That is, once a node is replaced, its descendants cannot be matched.</span></p></section><section id="c.set-attributes" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.22 p:set-attributes</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:set-attributes</span></code><span class="deltaxml-old" style="background:#FF5555"> step sets attributes on matching elements.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:set-attributes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">attributes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.set-attributes.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.6"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if that pattern matches anything other than element nodes.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Each attribute on the document element of the document that appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">attributes</span></code><span class="deltaxml-old" style="background:#FF5555"> port is copied to each element that matches the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> expression.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If an attribute with the same name as one of the attributes to be copied already exists, the value specified on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">attribute</span></code><span class="deltaxml-old" style="background:#FF5555"> port's document is used. The result port of this step produces a copy of the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port's document with the matching elements' attributes modified.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The matching elements are specified by the match pattern in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option. All matching elements are processed. If no elements match, the step will not change any elements.</span></p><p><span class="deltaxml-old" style="background:#FF5555">This step must not copy namespace declarations. If the attributes copied from the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">attributes</span></code><span class="deltaxml-old" style="background:#FF5555"> use namespaces, prefixes, or prefixes bound to different namespaces, the document produced on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> output port will require </span><span class="xspecref"><a href="../xproc20/#namespace-fixup"><span class="deltaxml-old" style="background:#FF5555">Section 2.5.1, “Namespace Fixup on XML Outputs”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If an attribute named </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555"> is added or changed, the base URI of the element </span><span class="rfc2119" id="c.set-attributes.9.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p></section><section id="c.set-properties" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.23 p:set-properties</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:set-properties</span></code><span class="deltaxml-old" style="background:#FF5555"> step sets </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-old" style="background:#FF5555">document properties</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> on the source document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:set-properties</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">properties</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:string,xs:string)</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><em class="glossterm"><a href="../xproc20/#dt-document-properties"><span class="deltaxml-old" style="background:#FF5555">document properties</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> of the document on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port are augmented with the values specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">properties</span></code><span class="deltaxml-old" style="background:#FF5555"> option. The document produced on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port has the same representation but the adjusted property values.</span></p><p><a name="err.inline.C1001"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C1001"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC1001</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">properties</span></code><span class="deltaxml-old" style="background:#FF5555"> map contains a key equal to the string “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555">”. </span></p></section><section id="c.sink" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.24 p:sink</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:sink</span></code><span class="deltaxml-old" style="background:#FF5555"> step accepts a sequence of documents and discards them. It has no output.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:sink</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p></section><section id="c.split-sequence" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.25 p:split-sequence</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:split-sequence</span></code><span class="deltaxml-old" style="background:#FF5555"> step accepts a sequence of documents and divides it into two sequences.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:split-sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">matched</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">not-matched</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">initial-only</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">test</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">test</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.split-sequence.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XPathExpression.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The XPath expression in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">test</span></code><span class="deltaxml-old" style="background:#FF5555"> option is applied to each document in the input sequence. If the effective boolean value of the expression is true, the document is copied to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">matched</span></code><span class="deltaxml-old" style="background:#FF5555"> port; otherwise it is copied to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">not-matched</span></code><span class="deltaxml-old" style="background:#FF5555"> port.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">initial-only</span></code><span class="deltaxml-old" style="background:#FF5555"> option is true, then when the first document that does not satisfy the test expression is encountered, it </span><em><span class="deltaxml-old" style="background:#FF5555">and all the documents that follow it</span></em><span class="deltaxml-old" style="background:#FF5555"> are written to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">not-matched</span></code><span class="deltaxml-old" style="background:#FF5555"> port. In other words, it only writes the initial series of matched documents (which may be empty) to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">matched</span></code><span class="deltaxml-old" style="background:#FF5555"> port. All other documents are written to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">not-matched</span></code><span class="deltaxml-old" style="background:#FF5555"> port, irrespective of whether or not they match.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><span class="xspecref"><a href="../xproc20/#xpath-context"><span class="deltaxml-old" style="background:#FF5555">XPath context</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> for the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">test</span></code><span class="deltaxml-old" style="background:#FF5555"> option changes over time. For each document that appears on the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the expression is evaluated with that document as the context document. The context position (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">position()</span></code><span class="deltaxml-old" style="background:#FF5555">) is the position of that document within the sequence and the context size (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">last()</span></code><span class="deltaxml-old" style="background:#FF5555">) is the total number of documents in the sequence.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">In principle, this component cannot stream because it must buffer all of the input sequence in order to find the context size. In practice, if the test expression does not use the </span><code class="function"><span class="deltaxml-old" style="background:#FF5555">last()</span></code><span class="deltaxml-old" style="background:#FF5555"> function, the implementation can stream and ignore the context size.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">If the implementation supports passing PSVI annotations between steps, the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:split-sequence</span></code><span class="deltaxml-old" style="background:#FF5555"> step </span><span class="rfc2119" id="c.split-sequence.9.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> preserve any annotations that appear in the input.</span></p></section><section id="c.store" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.26 p:store</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:store</span></code><span class="deltaxml-old" style="background:#FF5555"> step stores a serialized version of its input to a URI. This step outputs a reference to the location of the stored document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:store</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">*/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">href</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">byte-order-mark</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">            </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">cdata-section-elements</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">''</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">ListOfQNames</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-public</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-system</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">escape-uri-attributes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">include-content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">indent</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">media-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">method</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'xml'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">normalization-form</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'none'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">NormalizationForm</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">omit-xml-declaration</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">standalone</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'omit'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">   </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">undeclare-prefixes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'1.0'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.store.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:store</span></code><span class="deltaxml-old" style="background:#FF5555"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-old" style="background:#FF5555">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> value).</span></p><p><span class="deltaxml-old" style="background:#FF5555">The step attempts to store the XML document to the specified URI. </span><a name="err.inline.C0050"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0050"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0050</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the URI scheme is not supported or the step cannot store to the specified location.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The output of this step is a document containing a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:result</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element whose content is the absolute URI of the document stored by the step.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The standard serialization options are provided to control the serialization of XML content when it is stored. These options are as specified in </span><a href="#serialization-options" title="Serialization Options"><span class="deltaxml-old" style="background:#FF5555">Section 2.3, “Serialization Options”</span></a><span class="deltaxml-old" style="background:#FF5555">.</span></p></section><section id="c.string-replace" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.27 p:string-replace</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:string-replace</span></code><span class="deltaxml-old" style="background:#FF5555"> step matches nodes in the document provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port and replaces them with the string result of evaluating an XPath expression.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:string-replace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">     </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.string-replace.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.string-replace.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XPathExpression.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option. For each matching node, the XPath expression provided by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><span class="deltaxml-old" style="background:#FF5555"> option is evaluated with the matching node as the XPath context node. The string value of the result is used in the output. Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression given in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option matches an </span><em><span class="deltaxml-old" style="background:#FF5555">attribute</span></em><span class="deltaxml-old" style="background:#FF5555">, the string value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><span class="deltaxml-old" style="background:#FF5555"> expression is used as the new value of the attribute in the output. If the attribute is named “</span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">”, the base URI of the element </span><span class="rfc2119" id="c.string-replace.7.5"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-old" style="background:#FF5555">not</span></em><span class="deltaxml-old" style="background:#FF5555"> just its contents) is replaced by the string value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">replace</span></code><span class="deltaxml-old" style="background:#FF5555"> expression.</span></p></section><section id="c.unescape-markup" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.28 p:unescape-markup</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:unescape-markup</span></code><span class="deltaxml-old" style="background:#FF5555"> step takes the string value of the document element and parses the content as if it was a Unicode character stream containing serialized XML. The output consists of the same document element with children that result from the parse. This is the reverse of the </span><a href="#c.escape-markup"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:escape-markup</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:unescape-markup</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml text/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                   </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'application/xml'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">charset</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                     </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.unescape-markup.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. It </span><span class="rfc2119" id="c.unescape-markup.4.4"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be absolute, but will not be resolved.</span></p><p><span class="deltaxml-old" style="background:#FF5555">When the string value is parsed, the original document element is preserved so that the result will be well-formed XML even if the content consists of multiple, sibling elements.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> option specifies a default namespace. Elements that are in no namespace in the unescaped content will be placed into this namespace unless there is an in-scope namespace declaration that specifies a different namespace (or explicitly undeclares the default namespace).</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.unescape-markup.7.2"><span class="deltaxml-old" style="background:#FF5555">may</span></span><span class="deltaxml-old" style="background:#FF5555"> be used to specify an alternate content type for the string value. An implementation </span><span class="rfc2119" id="c.unescape-markup.7.3"><span class="deltaxml-old" style="background:#FF5555">may</span></span><span class="deltaxml-old" style="background:#FF5555"> use a different parser to produce XML content depending on the specified content-type. For example, an implementation might provide an HTML to XHTML parser (e.g. [</span><a href="#tidy"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">HTML Tidy</span></span></a><span class="deltaxml-old" style="background:#FF5555">] or [</span><a href="#tagsoup"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">TagSoup</span></span></a><span class="deltaxml-old" style="background:#FF5555">]) for the content type '</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text/html</span></code><span class="deltaxml-old" style="background:#FF5555">'.</span></p><p><span class="deltaxml-old" style="background:#FF5555">All implementations </span><span class="rfc2119" id="c.unescape-markup.8.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> support the content type </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">application/xml</span></code><span class="deltaxml-old" style="background:#FF5555">, and must use a standard XML parser for it. </span><a name="err.inline.C0051"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0051"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0051</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the content-type specified is not supported by the implementation. </span><a name="impl-12"></a><span class="deltaxml-old" style="background:#FF5555">Behavior of </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:unescape-markup</span></code><span class="deltaxml-old" style="background:#FF5555"> for </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555">s other than </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">application/xml</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> option specifies how the data is encoded. All implementations </span><span class="rfc2119" id="c.unescape-markup.9.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> support the </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555"> encoding (and the absence of an encoding option, which implies that the content is plain Unicode text). </span><a name="err.inline.C0052.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0052"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0052</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the encoding specified is not supported by the implementation.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If an </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, a </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">charset</span></code><span class="deltaxml-old" style="background:#FF5555"> may also be specified. The character set may be specified as a parameter on the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> or via the separate </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">charset</span></code><span class="deltaxml-old" style="background:#FF5555"> option. If it is specified in both places, the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">charset</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.unescape-markup.10.6"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the specified </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555">, then the character set </span><span class="rfc2119" id="c.unescape-markup.11.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be specified. </span><a name="err.inline.C0010"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0010"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0010</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if an encoding of </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">base64</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified and the character set is not specified or if the specified character set is not supported by the implementation. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The octet-stream that results from decoding the text </span><span class="rfc2119" id="c.unescape-markup.12.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be interpreted using the character encoding named by the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">charset</span></code><span class="deltaxml-old" style="background:#FF5555"> option to produce a sequence of Unicode characters to parse.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If no </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, the character set is ignored, irrespective of where it was specified.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For example, with the 'namespace' option set to the XHTML namespace, the following input:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;description&gt;
&amp;lt;p&gt;This is a chunk.&amp;lt;/p&gt;
&amp;lt;p&gt;This is a another chunk.&amp;lt;/p&gt;
&lt;/description&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">would produce:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;description&gt;
&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;This is a chunk.&lt;/p&gt;
&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;This is a another chunk.&lt;/p&gt;
&lt;/description&gt;</span></code></pre></section><section id="c.unwrap" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.29 p:unwrap</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:unwrap</span></code><span class="deltaxml-old" style="background:#FF5555"> step replaces matched elements with their children.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:unwrap</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.unwrap.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.7"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if that pattern matches anything other than element nodes.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Every element in the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document that matches the specified </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> pattern is replaced by its children, effectively “unwrapping” the children from their parent. Non-element nodes and unmatched elements are passed through unchanged.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">The matching applies to the entire document, not just the “top-most” matches. A pattern of the form </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">h:div</span></code><span class="deltaxml-old" style="background:#FF5555"> will replace </span><em><span class="deltaxml-old" style="background:#FF5555">all</span></em><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">h:div</span></code><span class="deltaxml-old" style="background:#FF5555"> elements, not just the top-most ones.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">This step produces a single document; if the document element is unwrapped, the result might not be well-formed XML.</span></p></section><section id="c.wrap" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.30 p:wrap</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:wrap</span></code><span class="deltaxml-old" style="background:#FF5555"> step wraps matching nodes in the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document with a new parent element.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:wrap</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">           </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.wrap.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">wrapper-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the wrapper. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">wrapper-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the wrapper element. </span><a name="err.inline.D0034.5"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.wrap.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XSLTMatchPattern. </span><a name="err.inline.C0023.8"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0023"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0023</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the pattern matches anything other than document, element, text, processing instruction, and comment nodes. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.wrap.6.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XPathExpression.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the node matched is the document node (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">match="/"</span></code><span class="deltaxml-old" style="background:#FF5555">), the result is a new document where the document element is a new element node whose QName is the value specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option. That new element contains copies of all of the children of the original document node.</span></p><p><span class="deltaxml-old" style="background:#FF5555">When the match pattern does not match the document node, every node that matches the specified </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> pattern is replaced with a new element node whose QName is the value specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option. The content of that new element is a copy of the original, matching node. The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:wrap</span></code><span class="deltaxml-old" style="background:#FF5555"> step performs a "deep" wrapping, the children of the matching node and their descendants are processed and wrappers are added to all matching nodes. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><span class="deltaxml-old" style="background:#FF5555"> option can be used to group adjacent matching nodes in a single wrapper element. The specified XPath expression is evaluated for each matching node with that node as the XPath context node. Whenever two or more adjacent matching nodes have the same “group adjacent” value, they are wrapped together in a single wrapper element.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Two matching nodes are considered adjacent if and only if they are siblings and either there are no nodes between them or all intervening, non-matching nodes are whitespace text, comment, or processing instruction nodes.</span></p></section><section id="c.wrap-sequence" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.31 p:wrap-sequence</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:wrap-sequence</span></code><span class="deltaxml-old" style="background:#FF5555"> step accepts a sequence of documents and produces either a single document or a new sequence of documents.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:wrap-sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper-prefix</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrapper-namespace</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">           </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XPathExpression</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.wrap-sequence.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. If the lexical value does not contain a colon, then the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">wrapper-namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> may be used to specify the namespace of the wrapper. In that case, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">wrapper-prefix</span></code><span class="deltaxml-old" style="background:#FF5555"> may be specified to suggest a prefix for the wrapper element. </span><a name="err.inline.D0034.6"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify a new namespace or prefix if the lexical value of the specified name contains a colon.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.wrap-sequence.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an XPathExpression.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In its simplest form, </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:wrap-sequence</span></code><span class="deltaxml-old" style="background:#FF5555"> takes a sequence of documents and produces a single, new document by placing each document in the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> sequence inside a new document element as sequential siblings. The name of the document element is the value specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrapper</span></code><span class="deltaxml-old" style="background:#FF5555"> option.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><span class="deltaxml-old" style="background:#FF5555"> option can be used to group adjacent documents. The </span><span class="xspecref"><a href="../xproc20/#xpath-context"><span class="deltaxml-old" style="background:#FF5555">XPath context</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> for the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">group-adjacent</span></code><span class="deltaxml-old" style="background:#FF5555"> option changes over time. For each document that appears on the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the expression is evaluated with that document as the context document. The context position (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">position()</span></code><span class="deltaxml-old" style="background:#FF5555">) is the position of that document within the sequence and the context size (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">last()</span></code><span class="deltaxml-old" style="background:#FF5555">) is the total number of documents in the sequence. Whenever two or more sequentially adjacent documents have the same “group adjacent” value, they are wrapped together in a single wrapper element. </span></p></section><section id="c.xinclude" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.32 p:xinclude</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xinclude</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies [</span><a href="#xinclude"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XInclude</span></span></a><span class="deltaxml-old" style="background:#FF5555">] processing to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:xinclude</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">fixup-xml-base</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">fixup-xml-lang</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">fixup-xml-base</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.xinclude.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean. If it is true, base URI fixup will be performed as per [</span><a href="#xinclude"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XInclude</span></span></a><span class="deltaxml-old" style="background:#FF5555">].</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">fixup-xml-lang</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.xinclude.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean. If it is true, language fixup will be performed as per [</span><a href="#xinclude"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XInclude</span></span></a><span class="deltaxml-old" style="background:#FF5555">].</span></p><p><span class="deltaxml-old" style="background:#FF5555">The included documents are located with the base URI of the input document and are not provided as input to the step.</span></p><p><a name="err.inline.C0029"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0029"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0029</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if an XInclude error occurs during processing. </span></p></section><section id="c.xslt" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.1.33 p:xslt</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xslt</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies an [</span><a href="#xslt10"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XSLT 1.0</span></span></a><span class="deltaxml-old" style="background:#FF5555">] or [</span><a href="#xslt20"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XSLT 2.0</span></span></a><span class="deltaxml-old" style="background:#FF5555">] stylesheet to a document.</span></p><p class="element-syntax element-syntax-declare-step-rqd"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:xslt</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">stylesheet</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">secondary</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">initial-mode</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                 </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">template-name</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">output-base-uri</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">             </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                     </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">If present, the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">initial-mode</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.xslt.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If present, the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">template-name</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.xslt.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If present, the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">output-base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.xslt.6.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xslt</span></code><span class="deltaxml-old" style="background:#FF5555"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-old" style="background:#FF5555">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> value).</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the step specifies a </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555">, then that version of XSLT </span><span class="rfc2119" id="c.xslt.7.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used to process the transformation. </span><a name="err.inline.C0038"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0038"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0038</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the specified version is not available. If the step does not specify a version, the implementation may use any version it has available and may use any means to determine what version to use, including, but not limited to, examining the version of the stylesheet.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The XSLT stylesheet provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">stylesheet</span></code><span class="deltaxml-old" style="background:#FF5555"> port is applied to the document on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. Any parameters passed in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> option are used to define top-level stylesheet parameters. The primary result document of the transformation, if there is one, appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port. At most one document can appear on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port. All other result documents appear on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">secondary</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span><a name="impl-13"></a><span class="deltaxml-old" style="background:#FF5555">The order in which result documents appear on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">secondary</span></code><span class="deltaxml-old" style="background:#FF5555"> port is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. If XSLT 1.0 is used, an empty sequence of documents </span><span class="rfc2119" id="c.xslt.8.8"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> appear on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">secondary</span></code><span class="deltaxml-old" style="background:#FF5555"> port.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If a sequence of documents is provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the first document is used as the primary input document. The whole sequence is also the default collection. If no documents are provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the primary input document is undefined and the default collection is empty. </span><a name="err.inline.C0039"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0039"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0039</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if a sequence of documents (including an empty sequence) is provided to an XSLT 1.0 step. </span></p><p><span class="deltaxml-old" style="background:#FF5555">A dynamic error occurs if the XSLT processor signals a fatal error. This includes the case where the transformation terminates due to a </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">xsl:message</span></code><span class="deltaxml-old" style="background:#FF5555"> instruction with a </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">terminate</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute value of “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">yes</span></code><span class="deltaxml-old" style="background:#FF5555">”. </span><a name="impl-14"></a><span class="deltaxml-old" style="background:#FF5555">How XSLT message termination errors are reported to the XProc processor is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The invocation of the transformation is controlled by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">initial-mode</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">template-name</span></code><span class="deltaxml-old" style="background:#FF5555"> options that set the initial mode and/or named template in the XSLT transformation where processing begins. </span><a name="err.inline.C0056"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0056"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0056</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the specified initial mode or named template cannot be applied to the specified stylesheet. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">output-base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option sets the context's output base URI per the XSLT 2.0 specification, otherwise the base URI of the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> document is the base URI of the first document in the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port's sequence. If the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">output-base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> option is not absolute, it will be resolved using the base URI of its </span><a href="../xproc20/#p.option"><span class="deltaxml-old" style="background:#FF5555">p:option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> element. An XSLT 1.0 step </span><span class="rfc2119" id="c.xslt.12.6"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> use the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">output-base-uri</span></code><span class="deltaxml-old" style="background:#FF5555"> as the base URI of its output, if the option is specified.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If XSLT 2.0 is used, the outputs of this step </span><span class="rfc2119" id="c.xslt.13.1"><span class="deltaxml-old" style="background:#FF5555">may</span></span><span class="deltaxml-old" style="background:#FF5555"> include PSVI annotations.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The static and initial dynamic contexts of the XSLT processor are the contexts defined in </span><span class="xspecref"><a href="../xproc20/#step-xpath-context-20"><span class="deltaxml-old" style="background:#FF5555">Section 2.7.2, “Step XPath Context”</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> with the following adjustments.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The dynamic context is augmented as follows:</span></p><div class="variablelist"><dl><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Context item</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The first document that appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Variable values</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Any parameters passed in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> option are available as variable bindings to the XSLT processor.</span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Function implementations</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The function implementations provided by the XSLT processor.</span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Default collection</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The sequence of documents provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span></p></dd></dl></div></section></section><section id="std-optional" class="section"><div class="section-titlepage"><h3><span class="deltaxml-old" style="background:#FF5555">2.2 Optional Steps</span></h3></div><p><span class="deltaxml-old" style="background:#FF5555">The following steps are optional. If they are supported by a processor, they must conform to the semantics outlined here, but a conformant processor is not required to support all (or any) of these steps.</span></p><section id="c.exec" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.1 p:exec</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><span class="deltaxml-old" style="background:#FF5555"> step runs an external command passing the input that arrives on its </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port as standard input, reading </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> from standard output, and </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">errors</span></code><span class="deltaxml-old" style="background:#FF5555"> from standard error.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">errors</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">exit-status</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">command</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">     </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">args</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">''</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">            </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">cwd</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">source-is-xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">result-is-xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrap-result-lines</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">errors-is-xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">wrap-error-lines</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">path-separator</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">failure-threshold</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:integer</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">          </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">arg-separator</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">' '</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">byte-order-mark</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">            </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">cdata-section-elements</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">''</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">ListOfQNames</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-public</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">doctype-system</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">              </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">escape-uri-attributes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">include-content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">indent</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">media-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                  </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">method</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'xml'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">normalization-form</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'none'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">NormalizationForm</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">omit-xml-declaration</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">standalone</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'omit'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">   </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"true" | "false" | "omit"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">undeclare-prefixes</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">         </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'1.0'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">      </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The values of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">command</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">args</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">cwd</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">path-separator</span></code><span class="deltaxml-old" style="background:#FF5555">, and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">arg-separator</span></code><span class="deltaxml-old" style="background:#FF5555"> options </span><span class="rfc2119" id="c.exec.4.6"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be strings.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The values of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">source-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">result-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">errors-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555">, and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">fix-slashes</span></code><span class="deltaxml-old" style="background:#FF5555"> options </span><span class="rfc2119" id="c.exec.5.5"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be boolean.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><span class="deltaxml-old" style="background:#FF5555"> step executes the command passed on </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">command</span></code><span class="deltaxml-old" style="background:#FF5555"> with the arguments passed on </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">args</span></code><span class="deltaxml-old" style="background:#FF5555">. The processor does not interpolate the values of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">command</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">args</span></code><span class="deltaxml-old" style="background:#FF5555"> (for example, expanding references to environment variables). </span><a name="err.inline.C0033"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0033"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0033</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the command cannot be run. </span></p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">cwd</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, then the current working directory is changed to the value of that option before execution begins. </span><a name="err.inline.C0034"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0034"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0034</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the current working directory cannot be changed to the value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">cwd</span></code><span class="deltaxml-old" style="background:#FF5555"> option. </span><a name="impl-15"></a><span class="deltaxml-old" style="background:#FF5555">If </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">cwd</span></code><span class="deltaxml-old" style="background:#FF5555"> is not specified, the current working directory is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">path-separator</span></code><span class="deltaxml-old" style="background:#FF5555"> option is specified, every occurrence of the character identified as the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">path-separator</span></code><span class="deltaxml-old" style="background:#FF5555"> character that occurs in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">command</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">args</span></code><span class="deltaxml-old" style="background:#FF5555">, or </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">cwd</span></code><span class="deltaxml-old" style="background:#FF5555"> will be replaced by the platform-specific path separator character. </span><a name="err.inline.C0063"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0063"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0063</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">path-separator</span></code><span class="deltaxml-old" style="background:#FF5555"> option is specified and is not exactly one character long. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">args</span></code><span class="deltaxml-old" style="background:#FF5555"> option is a string. In order to support passing more than one argument to a command, the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">args</span></code><span class="deltaxml-old" style="background:#FF5555"> string is broken into a sequence of values. The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">arg-separator</span></code><span class="deltaxml-old" style="background:#FF5555"> option specifies the character that is used to separate values; by default it is a single space </span><a name="err.inline.C0066"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0066"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0066</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">arg-separator</span></code><span class="deltaxml-old" style="background:#FF5555"> option is specified and is not exactly one character long. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The following examples of </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><span class="deltaxml-old" style="background:#FF5555"> are equivalent. The first uses the default </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">arg-separator</span></code><span class="deltaxml-old" style="background:#FF5555">:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:exec command="someCommand" args="arg1 arg2 arg3"/&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">The second specifies an alternate separator:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:exec command="someCommand" args="arg1,arg2,arg3"
	arg-separator=","/&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">If one of the arguments contains a space (e.g., a filename that contains a space), then you must specify an alternate separator.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port is declared to accept a sequence so that it can be empty. If no document appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, then the command receives nothing on standard input. If a document does arrive on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, it will be passed to the command as its standard input. </span><a name="err.inline.D0006"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.D0006"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XD0006</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if more than one document appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><span class="deltaxml-old" style="background:#FF5555"> step. If </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">source-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555"> is true, the serialization options are used to convert the input into serialized XML which is passed to the command, otherwise the XPath string-value of the document is passed.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The standard output of the command is read and returned on </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555">; the standard error output is read and returned on </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">errors</span></code><span class="deltaxml-old" style="background:#FF5555">. In order to assure that the result will be an XML document, each of the results will be wrapped in a </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:result</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">result-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555"> is true, the standard output of the program is assumed to be XML and will be parsed as a single document. If it is false, the output is assumed </span><em><span class="deltaxml-old" style="background:#FF5555">not</span></em><span class="deltaxml-old" style="background:#FF5555"> to be XML and will be returned as escaped text.</span></p><p id="cv.line"><span class="deltaxml-old" style="background:#FF5555">If </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrap-result-lines</span></code><span class="deltaxml-old" style="background:#FF5555"> is true, a </span><a href="#cv.line"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:line</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element will be wrapped around each line of output.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:line&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&lt;/c:line&gt;</span></code></p><p><a name="err.inline.C0035"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0035"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0035</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to specify both </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">result-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrap-result-lines</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The same rules apply to the standard error output of the program, with the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">errors-is-xml</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">wrap-error-lines</span></code><span class="deltaxml-old" style="background:#FF5555"> options, respectively.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If either of the results are XML, they </span><span class="rfc2119" id="c.exec.22.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be parsed with namespaces enabled and validation turned off, just like </span><a href="../xproc20/#p.document"><span class="deltaxml-old" style="background:#FF5555">p:document</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">exit-status</span></code><span class="deltaxml-old" style="background:#FF5555"> port always returns a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:result</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element which contains the system exit status that the process returned. </span><a name="impl-16"></a><span class="deltaxml-old" style="background:#FF5555">The specific exit status values returned by a process invoked with </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><span class="deltaxml-old" style="background:#FF5555"> are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If a </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">failure-threshold</span></code><span class="deltaxml-old" style="background:#FF5555"> value is supplied, and the exit status is greater than that threshold, then the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:exec</span></code><span class="deltaxml-old" style="background:#FF5555"> step </span><span class="rfc2119" id="c.exec.24.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> fail. </span><a name="err.inline.C0064"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0064"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0064</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the exit code from the command is greater than the specified </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">failure-threshold</span></code><span class="deltaxml-old" style="background:#FF5555"> value. This failure, like any step failure, can be captured with a </span><a href="../xproc20/#p.try"><span class="deltaxml-old" style="background:#FF5555">p:try</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555">.</span></p></section><section id="c.hash" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.2 p:hash</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:hash</span></code><span class="deltaxml-old" style="background:#FF5555"> step generates a hash, or digital “fingerprint”, for some value and injects it into the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:hash</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">value</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">algorithm</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:QName</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">    </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                     </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">algorithm</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be a QName. If it does not have a prefix, then it must be one of the following values: “crc”, “md”, or “sha”.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If a </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> is not specified, the default version is algorithm-defined. For “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">crc</span></code><span class="deltaxml-old" style="background:#FF5555">” it is 32, for “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">md</span></code><span class="deltaxml-old" style="background:#FF5555">” it is 5, for “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">sha</span></code><span class="deltaxml-old" style="background:#FF5555">” it is 1.</span></p><p><span class="deltaxml-old" style="background:#FF5555">A hash is constructed from the string specified in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">value</span></code><span class="deltaxml-old" style="background:#FF5555"> option using the specified algorithm and version. Implementations </span><span class="rfc2119" id="c.hash.6.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> support [</span><a href="#bib.crc"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">CRC32</span></span></a><span class="deltaxml-old" style="background:#FF5555">], [</span><a href="#rfc1321"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">MD5</span></span></a><span class="deltaxml-old" style="background:#FF5555">], and [</span><a href="#bib.sha"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">SHA1</span></span></a><span class="deltaxml-old" style="background:#FF5555">] hashes. </span><a name="impl-17"></a><span class="deltaxml-old" style="background:#FF5555">It is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> what other algorithms are supported. The resulting hash </span><span class="rfc2119" id="c.hash.6.7"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be returned as a string of hexadecimal characters. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be an XSLTMatchPattern.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The hash of the specified value is computed using the algorithm and parameters specified. </span><a name="err.inline.C0036"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0036"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0036</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the requested hash algorithm is not one that the processor understands or if the value or parameters are not appropriate for that algorithm.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option. For each matching node, the string value of the computed hash is used in the output (if more than one node matches, the </span><em><span class="deltaxml-old" style="background:#FF5555">same</span></em><span class="deltaxml-old" style="background:#FF5555"> hash value is used in each match). Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression given in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option matches an </span><em><span class="deltaxml-old" style="background:#FF5555">attribute</span></em><span class="deltaxml-old" style="background:#FF5555">, the hash is used as the new value of the attribute in the output. If the attribute is named “</span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">”, the base URI of the element </span><span class="rfc2119" id="c.hash.10.4"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-old" style="background:#FF5555">not</span></em><span class="deltaxml-old" style="background:#FF5555"> just its contents) is replaced by the hash.</span></p></section><section id="c.in-scope-names" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.3 p:in-scope-names</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:in-scope-names</span></code><span class="deltaxml-old" style="background:#FF5555"> step exposes all of the in-scope variables and options as a set of parameters in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:in-scope-names</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">false</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">Each in-scope variable and option is converted into a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element. The resulting </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements are wrapped in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> and the parameter set document is written to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span><a name="impl-18"></a><span class="deltaxml-old" style="background:#FF5555">The order in which </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements occur in the </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For consistency and user convenience, if any of the variables or options have names that are in a namespace, the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">namespace</span></code><span class="deltaxml-old" style="background:#FF5555"> attribute on the </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element </span><span class="rfc2119" id="c.in-scope-names.5.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used. Each </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">name</span></code><span class="rfc2119" id="c.in-scope-names.5.5"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an NCName.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The base URI of the output document is the URI of the pipeline document that contains the step.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For consistency with the </span><a href="#c.parameters"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:parameters</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step, the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> port is not primary.</span></p><section id="ex-in-scope-names" class="section tocsuppress"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.2.3.1 Example</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">This unlikely pipeline demonstrates the behavior of </span><a href="#c.in-scope-names"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:in-scope-names</span></code></a><span class="deltaxml-old" style="background:#FF5555">: </span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
                name="main" version="1.0"&gt;
&lt;p:output port="result"&gt;
  &lt;p:pipe step="vars" port="result"/&gt;
&lt;/p:output&gt;

&lt;p:option name="username" required="true"/&gt;
&lt;p:option name="password" required="true"/&gt;
&lt;p:variable name="host" select="'http://example.com/'"/&gt;

&lt;p:in-scope-names name="vars"/&gt;

&lt;/p:declare-step&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">Assuming the values supplied for the username and password options are “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">user</span></code><span class="deltaxml-old" style="background:#FF5555">” and “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">pass</span></code><span class="deltaxml-old" style="background:#FF5555">”, respectively, the output would be:</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:param-set xmlns:c="http://www.w3.org/ns/xproc-step"&gt;
  &lt;c:param name="username" namespace="" value="user"/&gt;
  &lt;c:param name="host" namespace="" value="http://example.com/"/&gt;
  &lt;c:param name="password" namespace="" value="pass"/&gt;
&lt;/c:param-set&gt;</span></code></pre></section></section><section id="c.template" class="section ext-optional"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.4 p:template</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">p:template</span></code><span class="deltaxml-old" style="background:#FF5555"> replaces each XPath expression, delimited with curly braces, in the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">template</span></code><span class="deltaxml-old" style="background:#FF5555"> document with the result of evaluating that expression.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:template</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">template</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr kind-attr"><span class="deltaxml-old" style="background:#FF5555">kind</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value kind-value"><span class="deltaxml-old" style="background:#FF5555">parameter</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">While evaluating each expression, the names of any parameters passed to the step are available as variable values in the XPath dynamic context.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The step searches for XPath expressions in attribute values, text content (adjacent text nodes, if they occur in the data model, must be coalesced; this step always processes maximal length text nodes), processing instruction data, and comments. XPath expressions are identified by curly braces, similar to attribute value templates in XSLT or enclosed expressions in XQuery.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In order to allow curly braces to appear literally in content, they can be escaped by doubling them. In other words, where “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">{</span></code><span class="deltaxml-old" style="background:#FF5555">” would start an XPath expression, “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">{{</span></code><span class="deltaxml-old" style="background:#FF5555">” is simply a </span><em><span class="deltaxml-old" style="background:#FF5555">single</span></em><span class="deltaxml-old" style="background:#FF5555">, literal opening curly brace. The same applies for closing curly braces.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Inside an XPath expression, strings quoted by single (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">'</span></code><span class="deltaxml-old" style="background:#FF5555">) or double (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">"</span></code><span class="deltaxml-old" style="background:#FF5555">) quotes are treated literally. Outside of quoted text, it is an error for an opening curly brace to occur. A closing curly brace ends the XPath expression (whether or not it is followed immediately by another closing curly brace).</span></p><p><span class="deltaxml-old" style="background:#FF5555">These parsing rules can be described by the following algorithm, though implementations are by no means required to implement the parsing in exactly this way, provided that they achieve the same results.</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">The parser begins in </span><em><span class="deltaxml-old" style="background:#FF5555">regular-mode</span></em><span class="deltaxml-old" style="background:#FF5555"> at the start of each unit of content where expansion may occur. In </span><em><span class="deltaxml-old" style="background:#FF5555">regular-mode</span></em><span class="deltaxml-old" style="background:#FF5555">: </span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-old" style="background:#FF5555">“</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">{{</span></code><span class="deltaxml-old" style="background:#FF5555">” is replaced by a single “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">{</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">“</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">}}</span></code><span class="deltaxml-old" style="background:#FF5555">” is replaced by a single “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">}</span></code><span class="deltaxml-old" style="background:#FF5555">”. </span></p><p><span class="deltaxml-old" style="background:#FF5555">Note: </span><a name="err.inline.C0067"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0067"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0067</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to encounter a single closing curly brace “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">}</span></code><span class="deltaxml-old" style="background:#FF5555">” that is not immediately followed by another closing curly brace. </span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">A single opening curly brace “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">{</span></code><span class="deltaxml-old" style="background:#FF5555">” (not immediately followed by another opening curly brace) is discarded and the parser moves into </span><em><span class="deltaxml-old" style="background:#FF5555">xpath-mode</span></em><span class="deltaxml-old" style="background:#FF5555">. The inital expression is empty. </span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">All other characters are copied without change.</span></p></li></ol></div></li><li><p><span class="deltaxml-old" style="background:#FF5555">In </span><em><span class="deltaxml-old" style="background:#FF5555">xpath-mode</span></em><span class="deltaxml-old" style="background:#FF5555">:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><a name="err.inline.C0067.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0067"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0067</span></code></a><span class="deltaxml-old" style="background:#FF5555">) to encounter an opening curly brace “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">{</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">A closing curly brace “</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">}</span></code><span class="deltaxml-old" style="background:#FF5555">” is discarded and ends the expression. The expression is evaluated and the result of that evaluation is copied to the output. The parser returns to </span><em><span class="deltaxml-old" style="background:#FF5555">regular-mode</span></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Note: Braces cannot be escaped by doubling them in </span><em><span class="deltaxml-old" style="background:#FF5555">xpath-mode</span></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">A single quote (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">'</span></code><span class="deltaxml-old" style="background:#FF5555">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-old" style="background:#FF5555">single-quote-mode</span></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">A double quote (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">"</span></code><span class="deltaxml-old" style="background:#FF5555">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-old" style="background:#FF5555">double-quote-mode</span></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">All other characters are appended to the current expression.</span></p></li></ol></div></li><li><p><span class="deltaxml-old" style="background:#FF5555">In </span><em><span class="deltaxml-old" style="background:#FF5555">single-quote-mode</span></em><span class="deltaxml-old" style="background:#FF5555">:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-old" style="background:#FF5555">A single quote (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">'</span></code><span class="deltaxml-old" style="background:#FF5555">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-old" style="background:#FF5555">xpath-mode</span></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">All other characters are appended to the current expression.</span></p></li></ol></div></li><li><p><span class="deltaxml-old" style="background:#FF5555">In </span><em><span class="deltaxml-old" style="background:#FF5555">double-quote-mode</span></em><span class="deltaxml-old" style="background:#FF5555">:</span></p><div class="orderedlist"><ol style="list-style: decimal;"><li><p><span class="deltaxml-old" style="background:#FF5555">A double quote (</span><code class="code"><span class="deltaxml-old" style="background:#FF5555">"</span></code><span class="deltaxml-old" style="background:#FF5555">) is added to the current expression and the parser moves to </span><em><span class="deltaxml-old" style="background:#FF5555">xpath-mode</span></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">All other characters are appended to the current expression.</span></p></li></ol></div></li></ul></div><p><a name="err.inline.C0067.2"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0067"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0067</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the parser reaches the end of the unit of content and it is not in </span><em><span class="deltaxml-old" style="background:#FF5555">regular-mode</span></em><span class="deltaxml-old" style="background:#FF5555">. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The context node used for each expression is the document passed on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span><a name="err.inline.C0068"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0068"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0068</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if more than one document appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. In an XPath 1.0 implementation, if </span><a href="../xproc20/#p.empty"><span class="deltaxml-old" style="background:#FF5555">p:empty</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> is given or implied on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, an empty document node is used as the context node. In an XPath 2.0 implementation, the context item is undefined. </span><a name="err.inline.C0026"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0026"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0026</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if any XPath expression makes reference to the context node, size, or position when the context item is undefined.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In an attribute value, processing instruction, or comment, the string value of the XPath expression is used. In text content, an expression that selects nodes will cause those nodes to be copied into the template document.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">Depending on which version of XPath an implementation supports, and possibly on the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xpath-version</span></code><span class="deltaxml-old" style="background:#FF5555"> setting on the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:template</span></code><span class="deltaxml-old" style="background:#FF5555">, some implementations may report errors, or different results, than other implementations in those cases where the interpretation of an XPath expression differs between the versions of XPath.</span></p></div><section id="ex-in-scope-names" class="section tocsuppress"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.2.4.1 Example</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">It's quite common to construct documents using values computed by the pipeline. This is particularly (but not exclusively) the case when the pipeline uses the </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step. The input to </span><a href="#c.http-request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:http-request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> is a </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> document; attributes on the </span><a href="#cv.request"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:request</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element control most of the request parameters; the body of the document forms the body of request.</span></p><p><span class="deltaxml-old" style="background:#FF5555">A typical example looks like this:</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:request method="POST" href="http://example.com/post"
           username="user" password="password"&gt;
&lt;c:body&gt;
  &lt;computed-content/&gt;
&lt;/c:body&gt;
&lt;/c:request&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">If we assume that the </span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> value and the computed content come from an input document, and the username and password are options, then a typical pipeline to compute the request becomes quite complex.</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:pipeline xmlns:p="http://www.w3.org/ns/xproc"
            xmlns:c="http://www.w3.org/ns/xproc-step"
            name="main" version="1.0"&gt;
&lt;p:option name="username" required="true"/&gt;
&lt;p:option name="password" required="true"/&gt;

&lt;p:identity&gt;
  &lt;p:input port="source"&gt;
    &lt;p:inline&gt;
      &lt;c:request method="POST"/&gt;
    &lt;/p:inline&gt;
  &lt;/p:input&gt;
&lt;/p:identity&gt;

&lt;p:add-attribute match="/c:request" attribute-name="href"&gt;
  &lt;p:with-option name="attribute-value" select="/doc/request/@uri"&gt;
    &lt;p:pipe step="main" port="source"/&gt;
  &lt;/p:with-option&gt;
&lt;/p:add-attribute&gt;

&lt;p:add-attribute match="/c:request" attribute-name="username"&gt;
  &lt;p:with-option name="attribute-value" select="$username"/&gt;
&lt;/p:add-attribute&gt;

&lt;p:add-attribute match="/c:request" attribute-name="password"&gt;
  &lt;p:with-option name="attribute-value" select="$password"/&gt;
&lt;/p:add-attribute&gt;

&lt;p:insert position="first-child" match="/c:request"&gt;
  &lt;p:input port="insertion" select="/doc/request"&gt;
    &lt;p:pipe step="main" port="source"/&gt;
  &lt;/p:input&gt;
&lt;/p:insert&gt;

&lt;p:unwrap match="/c:request/request"/&gt;

&lt;/p:pipeline&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">There's nothing wrong with this pipeline, but it requires several steps to accomplish with the pipeline author probably considers a single operation. What's more, the result of these steps is not immediately obvious on casual inspection.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In order to make this simple construction case both literally and conceptually simpler, this note introduces two new XProc steps in the XProc namespace. Support for these steps is optional, but we strongly encourage implementors to provide them.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The new steps are </span><a href="#c.in-scope-names"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:in-scope-names</span></code></a><span class="deltaxml-old" style="background:#FF5555"> and </span><a href="#c.template"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:template</span></code></a><span class="deltaxml-old" style="background:#FF5555">. Taken together, they greatly simplify the pipeline:</span></p><pre xml:space="preserve" class="programlisting line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:pipeline xmlns:p="http://www.w3.org/ns/xproc"
            xmlns:c="http://www.w3.org/ns/xproc-step"
            name="main" version="1.0"&gt;
&lt;p:option name="username" required="true"/&gt;
&lt;p:option name="password" required="true"/&gt;

&lt;p:in-scope-names name="vars"/&gt;

&lt;p:template&gt;
  &lt;p:input port="template"&gt;
    &lt;p:inline&gt;
      &lt;c:request method="POST" href="{/doc/request/@uri}"
                 username="{$username}" password="{$password}"&gt;
        { /doc/request/node() }
      &lt;/c:request&gt;
    &lt;/p:inline&gt;
  &lt;/p:input&gt;
  &lt;p:input port="source"&gt;
    &lt;p:pipe step="main" port="source"/&gt;
  &lt;/p:input&gt;
  &lt;p:input port="parameters"&gt;
    &lt;p:pipe step="vars" port="result"/&gt;
  &lt;/p:input&gt;
&lt;/p:template&gt;

&lt;/p:pipeline&gt;</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#c.in-scope-names"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:in-scope-names</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step provides all of the in-scope options and variables in a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555"> (this operation is exactly analagous to what the </span><a href="#c.parameters"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:parameters</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step does, except that it operates on the options and variables instead of on parameters).</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#c.template"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:template</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step searches for XPath expressions, delimited by curly braces, in a template document and replaces each with the result of evaluating the expression. All of the parameters passed to the </span><a href="#c.template"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:template</span></code></a><span class="deltaxml-old" style="background:#FF5555"> step are available as in-scope variable names when evaluating each XPath expression.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Where the expressions occur in attribute values, their string value is used. Where they appear in text content, their node values are used.</span></p></section></section><section id="c.uuid" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.5 p:uuid</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:uuid</span></code><span class="deltaxml-old" style="background:#FF5555"> step generates a [</span><a href="#bib.uuid"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">UUID</span></span></a><span class="deltaxml-old" style="background:#FF5555">] and injects it into the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:uuid</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:integer</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                    </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be an XSLTMatchPattern. The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be an integer.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, that version of UUID must be computed. </span><a name="err.inline.C0060"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0060"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0060</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the processor does not support the specified </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> of the UUID algorithm. </span><a name="impl-19"></a><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> is not specified, the version of UUID computed is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Implementations </span><span class="rfc2119" id="c.uuid.6.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> support version 4 UUIDs. </span><a name="impl-20"></a><span class="deltaxml-old" style="background:#FF5555">Support for other versions of UUID, and the mechanism by which the necessary inputs are made available for computing other versions, is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option. For each matching node, the generated UUID is used in the output (if more than one node matches, the </span><em><span class="deltaxml-old" style="background:#FF5555">same</span></em><span class="deltaxml-old" style="background:#FF5555"> UUID is used in each match). Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression given in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option matches an </span><em><span class="deltaxml-old" style="background:#FF5555">attribute</span></em><span class="deltaxml-old" style="background:#FF5555">, the UUID is used as the new value of the attribute in the output. If the attribute is named “</span><code class="tag-attribute"><span class="deltaxml-old" style="background:#FF5555">xml:base</span></code><span class="deltaxml-old" style="background:#FF5555">”, the base URI of the element </span><span class="rfc2119" id="c.uuid.8.4"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> also be amended accordingly.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-old" style="background:#FF5555">not</span></em><span class="deltaxml-old" style="background:#FF5555"> just its contents) is replaced by the UUID.</span></p></section><section id="c.validate-with-relax-ng" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.6 p:validate-with-relax-ng</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-relax-ng</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies [</span><a href="#iso19757-2"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RELAX NG</span></span></a><span class="deltaxml-old" style="background:#FF5555">] validation to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-relax-ng</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml */*+xml text/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">dtd-attribute-values</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">dtd-id-idref-warnings</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The values of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-attribute-values</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-id-idref-warnings</span></code><span class="deltaxml-old" style="background:#FF5555"> options </span><span class="rfc2119" id="c.validate-with-relax-ng.4.3"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be booleans.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><span class="deltaxml-old" style="background:#FF5555"> document has an XML media type, then it </span><span class="rfc2119" id="c.validate-with-relax-ng.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be interpreted as a RELAX NG Grammar. If the media type has a “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text</span></code><span class="deltaxml-old" style="background:#FF5555">” type, then it </span><span class="rfc2119" id="c.validate-with-relax-ng.5.4"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be interpreted as a [</span><a href="#relaxng-compact-syntax"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RELAX NG Compact Syntax</span></span></a><span class="deltaxml-old" style="background:#FF5555">] document for validation.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-attribute-values</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, then the attribute value defaulting conventions of [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-old" style="background:#FF5555">] are also applied.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">dtd-id-idref-warnings</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, then the validator </span><span class="rfc2119" id="c.validate-with-relax-ng.7.3"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> treat a schema that is incompatible with the ID/IDREF/IDREFs feature of [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-old" style="background:#FF5555">] as if the document was invalid. </span></p><p><a name="err.inline.C0053"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0053"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0053</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555"> and the input document is not valid.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The output from this step is a copy of the input, possibly augmented by application of the [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-old" style="background:#FF5555">]. The output of this step </span><span class="rfc2119" id="c.validate-with-relax-ng.9.2"><span class="deltaxml-old" style="background:#FF5555">may</span></span><span class="deltaxml-old" style="background:#FF5555"> include PSVI annotations.</span></p><p><a name="impl-21"></a><span class="deltaxml-old" style="background:#FF5555">Support for [</span><a href="#relaxng-dtd-compat"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">RELAX NG DTD Compatibility</span></span></a><span class="deltaxml-old" style="background:#FF5555">] is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></section><section id="c.validate-with-schematron" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.7 p:validate-with-schematron</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-schematron</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies [</span><a href="#iso19757-3"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Schematron</span></span></a><span class="deltaxml-old" style="background:#FF5555">] processing to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-schematron</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">report</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">phase</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'#ALL'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><a name="err.inline.C0054"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0054"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0054</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555"> and any Schematron assertions fail.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">phase</span></code><span class="deltaxml-old" style="background:#FF5555"> option identifies the Schematron validation phase with which validation begins.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> option provides name/value pairs which correspond to Schematron external variables.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> output from this step is a copy of the input.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Schematron assertions and reports, if any, </span><span class="rfc2119" id="c.validate-with-schematron.8.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> appear on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">report</span></code><span class="deltaxml-old" style="background:#FF5555"> port. The output </span><span class="rfc2119" id="c.validate-with-schematron.8.3"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be in </span><em class="citetitle"><span class="deltaxml-old" style="background:#FF5555">Schematron Validation Report Language</span></em><span class="deltaxml-old" style="background:#FF5555"> (SVRL).</span></p><p><span class="deltaxml-old" style="background:#FF5555">The output of this step </span><span class="rfc2119" id="c.validate-with-schematron.9.1"><span class="deltaxml-old" style="background:#FF5555">may</span></span><span class="deltaxml-old" style="background:#FF5555"> include PSVI annotations.</span></p></section><section id="c.validate-with-xml-schema" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.8 p:validate-with-xml-schema</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-xml-schema</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies [</span><a href="#xmlschema-1"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">W3C XML Schema: Part 1</span></span></a><span class="deltaxml-old" style="background:#FF5555">] validity assessment to the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> input.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-xml-schema</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">use-location-hints</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">try-namespaces</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'false'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'true'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:boolean</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">mode</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr select-attr"><span class="deltaxml-old" style="background:#FF5555">select</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value select-value"><span class="deltaxml-old" style="background:#FF5555">'strict'</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:token</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">"strict" | "lax"</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                     </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The values of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">use-location-hints</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">try-namespaces</span></code><span class="deltaxml-old" style="background:#FF5555">, and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><span class="deltaxml-old" style="background:#FF5555"> options </span><span class="rfc2119" id="c.validate-with-xml-schema.4.4"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be boolean.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">mode</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.validate-with-xml-schema.5.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an NMTOKEN whose value is either “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">strict</span></code><span class="deltaxml-old" style="background:#FF5555">” or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">lax</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Validation is performed against the set of schemas represented by the documents on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><span class="deltaxml-old" style="background:#FF5555"> port. These schemas must be used in preference to any schema locations provided by schema location hints encountered during schema validation, that is, schema locations supplied for </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xs:import</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xsi:schema-location</span></code><span class="deltaxml-old" style="background:#FF5555">, or determined by schema-processor-defined namespace-based strategies, for the namespaces covered by the documents available on the schemas port.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xs:include</span></code><span class="deltaxml-old" style="background:#FF5555"> elements occur within the supplied schema documents, they are treated like any other </span><span class="xspecref"><a href="../xproc20/#external-docs"><span class="deltaxml-old" style="background:#FF5555">external documents</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555">. </span><a name="impl-22"></a><span class="deltaxml-old" style="background:#FF5555">It is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555"> if the documents supplied on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">schemas</span></code><span class="deltaxml-old" style="background:#FF5555"> port are considered when resolving </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xs:include</span></code><span class="deltaxml-old" style="background:#FF5555"> elements in the schema documents provided. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">use-location-hints</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">try-namespaces</span></code><span class="deltaxml-old" style="background:#FF5555"> options allow the pipeline author to control how the schema processor should attempt to locate schema documents necessary but not provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><span class="deltaxml-old" style="background:#FF5555"> port. Any schema documents provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">schema</span></code><span class="deltaxml-old" style="background:#FF5555"> port </span><span class="rfc2119" id="c.validate-with-xml-schema.8.5"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used in preference to schema documents located by other means.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">use-location-hints</span></code><span class="deltaxml-old" style="background:#FF5555"> option is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.9.3"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> make use of schema location hints to locate schema documents. If the option is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.9.5"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> ignore any such hints.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">try-namespaces</span></code><span class="deltaxml-old" style="background:#FF5555"> option is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.10.3"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> attempt to dereference the namespace URI to locate schema documents. If the option is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">”, the processor </span><span class="rfc2119" id="c.validate-with-xml-schema.10.5"><span class="deltaxml-old" style="background:#FF5555">should not</span></span><span class="deltaxml-old" style="background:#FF5555"> dereference namespace URIs.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">mode</span></code><span class="deltaxml-old" style="background:#FF5555"> option allow the pipeline author to control how schema validation begins. The “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">strict</span></code><span class="deltaxml-old" style="background:#FF5555">” mode means that the document element must be declared and schema-valid, otherwise it will be treated as invalid. The “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">lax</span></code><span class="deltaxml-old" style="background:#FF5555">” mode means that the absence of a declaration for the document element does not itself count as an unsuccessful outcome of validation.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the step specifies a </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555">, then that version of XML Schema </span><span class="rfc2119" id="c.validate-with-xml-schema.12.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used to process the validation. </span><a name="err.inline.C0038.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0038"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0038</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the specified version is not available. If the step does not specify a version, the implementation may use any version it has available and may use any means to determine what version to use, including, but not limited to, examining the version of the schema(s).</span></p><p><a name="err.inline.C0053.1"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0053"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0053</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555"> and the input document is not valid. If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">assert-valid</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">, it is not an error for the document to be invalid. In this case, if the implementation does not support the PSVI, </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:validate-with-xml-schema</span></code><span class="deltaxml-old" style="background:#FF5555"> is essentially just an “identity” step, but if the implementation </span><em><span class="deltaxml-old" style="background:#FF5555">does</span></em><span class="deltaxml-old" style="background:#FF5555"> support the PSVI, then the resulting document will have additional type information (at least for the subtrees that are valid).</span></p><p><span class="deltaxml-old" style="background:#FF5555">When XML Schema validation assessment is performed, the processor is invoked in the mode specified by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">mode</span></code><span class="deltaxml-old" style="background:#FF5555"> option. </span><a name="err.inline.C0055"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0055"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0055</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the implementation does not support the specified mode. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> of the assessment is a document with the Post-Schema-Validation-Infoset (PSVI) ([</span><a href="#xmlschema-1"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">W3C XML Schema: Part 1</span></span></a><span class="deltaxml-old" style="background:#FF5555">]) annotations, if the pipeline implementation supports such annotations. If not, the input document is reproduced with any defaulting of attributes and elements performed as specified by the XML Schema recommendation.</span></p></section><section id="c.www-form-urldecode" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.9 p:www-form-urldecode</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:www-form-urldecode</span></code><span class="deltaxml-old" style="background:#FF5555"> step decodes a </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">x-www-form-urlencoded</span></code><span class="deltaxml-old" style="background:#FF5555"> string into an XML representation.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:www-form-urldecode</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">value</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">value</span></code><span class="deltaxml-old" style="background:#FF5555"> option is interpreted as a string of parameter values encoded using the </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">x-www-form-urlencoded</span></code><span class="deltaxml-old" style="background:#FF5555"> algorithm. Each name/value pair is written in a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element. The entire set of parameters is written (as a </span><a href="#cv.param-set"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param-set</span></code></a><span class="deltaxml-old" style="background:#FF5555">) on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">result</span></code><span class="deltaxml-old" style="background:#FF5555"> output port.</span></p><p><a name="err.inline.C0037"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0037"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0037</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">value</span></code><span class="deltaxml-old" style="background:#FF5555"> provided is not a properly </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">x-www-form-urlencoded</span></code><span class="deltaxml-old" style="background:#FF5555"> value. </span><a name="err.inline.C0061"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0061"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0061</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the name of any encoded parameter name is not a valid </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">xs:NCName</span></code><span class="deltaxml-old" style="background:#FF5555">. In other words, this step can only decode simple name/value pairs where the names do not contain colons or any characters that cannot be used in XML names. </span></p><p><span class="deltaxml-old" style="background:#FF5555">The order of the </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> elements in the result is the same as the order of the encoded parameters, reading from left to right.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If any parameter name occurs more than once in the encoded string, the resulting parameter set will contain a </span><a href="#cv.param"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:param</span></code></a><span class="deltaxml-old" style="background:#FF5555"> for each instance.</span></p></section><section id="c.www-form-urlencode" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.10 p:www-form-urlencode</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:www-form-urlencode</span></code><span class="deltaxml-old" style="background:#FF5555"> step encodes a set of parameter values as a </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">x-www-form-urlencoded</span></code><span class="deltaxml-old" style="background:#FF5555"> string and injects it into the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> document.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:www-form-urlencode</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">match</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code><code class="comment"><span class="deltaxml-old" style="background:#FF5555">&lt;!-- </span></code><span class="opt-type"><span class="deltaxml-old" style="background:#FF5555">XSLTMatchPattern</span></span><code class="comment"><span class="deltaxml-old" style="background:#FF5555"> --&gt;</span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option must be an XSLTMatchPattern.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The set of parameters is encoded as a single </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">x-www-form-urlencoded</span></code><span class="deltaxml-old" style="background:#FF5555"> string of name/value pairs. When parameters are encoded into name/value pairs, </span><em><span class="deltaxml-old" style="background:#FF5555">only</span></em><span class="deltaxml-old" style="background:#FF5555"> the local name of each parameter is used. The namespace name is ignored and no prefix or colon appears in the name. </span></p><p><a name="impl-23"></a><span class="deltaxml-old" style="background:#FF5555">The order of the parameters is is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The matched nodes are specified with the match pattern in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option. For each matching node, the encoded string is used in the output. Nodes that do not match are copied without change.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the expression given in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">match</span></code><span class="deltaxml-old" style="background:#FF5555"> option matches an </span><em><span class="deltaxml-old" style="background:#FF5555">attribute</span></em><span class="deltaxml-old" style="background:#FF5555">, the encoded string is used as the new value of the attribute in the output. If the expression matches any other kind of node, the entire node (and </span><em><span class="deltaxml-old" style="background:#FF5555">not</span></em><span class="deltaxml-old" style="background:#FF5555"> just its contents) is replaced by the encoded string.</span></p></section><section id="c.xquery" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.11 p:xquery</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xquery</span></code><span class="deltaxml-old" style="background:#FF5555"> step applies an [</span><a href="#xquery10"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XQuery 1.0</span></span></a><span class="deltaxml-old" style="background:#FF5555">] query to the sequence of documents provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:xquery</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr primary-attr"><span class="deltaxml-old" style="background:#FF5555">primary</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value primary-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">query</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml */*+xml text/*</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr sequence-attr"><span class="deltaxml-old" style="background:#FF5555">sequence</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value sequence-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">version</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                     </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">If a sequence of documents is provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the first document is used as the initial context item. The whole sequence is also the default collection. If no documents are provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port, the initial context item is undefined and the default collection is empty.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">query</span></code><span class="deltaxml-old" style="background:#FF5555"> port must receive a single document:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">If the document root element is </span><a href="#cv.query"><code id="cv.query" class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:query</span></code></a><span class="deltaxml-old" style="background:#FF5555">, the text descendants of this element are considered the query.</span></p><p id="R.1" prefix="c" class="element-syntax element-syntax-step-vocabulary"><code><span class="deltaxml-old" style="background:#FF5555">&lt;c:query&gt;</span><span class="deltaxml-old" style="background:#FF5555">    </span><var><span class="deltaxml-old" style="background:#FF5555">string</span></var><span class="deltaxml-old" style="background:#FF5555">&lt;/c:query&gt;</span></code></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">If the document root element is in the XQueryX namespace, the document is treated as an XQueryX-encoded query. </span><a name="impl-24"></a><span class="deltaxml-old" style="background:#FF5555">Support for XQueryX is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">query</span></code><span class="deltaxml-old" style="background:#FF5555"> document has an XML media type, then the string value of the document </span><span class="rfc2119" id="c.xquery.6.3.1.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be treated as the query. If the media type has a “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text</span></code><span class="deltaxml-old" style="background:#FF5555">” type, then it </span><span class="rfc2119" id="c.xquery.6.3.1.4"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be interpreted as the query.</span></p></li><li><p><a name="impl-25"></a><span class="deltaxml-old" style="background:#FF5555">Otherwise, the interpretation of the query is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></li></ul></div><p><span class="deltaxml-old" style="background:#FF5555">If the step specifies a </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555">, then that version of XQuery </span><span class="rfc2119" id="c.xquery.7.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be used to process the transformation. </span><a name="err.inline.C0038.2"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0038"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0038</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the specified version is not available. If the step does not specify a version, the implementation may use any version it has available and may use any means to determine what version to use, including, but not limited to, examining the version of the query.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The result of the </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xquery</span></code><span class="deltaxml-old" style="background:#FF5555"> step must be a sequence of documents. </span><a name="err.inline.C0057"></a><span class="deltaxml-old" style="background:#FF5555">It is a </span><em class="glossterm"><a href="#dt-dynamic-error"><span class="deltaxml-old" style="background:#FF5555">dynamic error</span></a></em><span class="deltaxml-old" style="background:#FF5555"> (</span><a href="#err.C0057"><code class="errqname"><span class="deltaxml-old" style="background:#FF5555">err:XC0057</span></code></a><span class="deltaxml-old" style="background:#FF5555">) if the sequence that results from evaluating the XQuery contains items other than documents and elements. Any elements that appear in the result sequence will be treated as documents with the element as their document element.</span></p><p><span class="deltaxml-old" style="background:#FF5555">For example:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">
&lt;c:query&gt;
declare namespace atom="http://www.w3.org/2005/Atom";
/atom:feed/atom:entry
&lt;/c:query&gt;

</span></code></pre><p><span class="deltaxml-old" style="background:#FF5555">The output of this step </span><span class="rfc2119" id="c.xquery.11.1"><span class="deltaxml-old" style="background:#FF5555">may</span></span><span class="deltaxml-old" style="background:#FF5555"> include PSVI annotations.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The static context of the XQuery processor is augmented in the following way:</span></p><div class="variablelist"><dl><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Statically known default collection type</span></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">document()*</span></code></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Statically known namespaces:</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Unchanged from the implementation defaults. No namespace declarations in the XProc pipeline are automatically exposed in the static context. </span></p></dd></dl></div><p><span class="deltaxml-old" style="background:#FF5555">The dynamic context of the XQuery processor is augmented in the following way:</span></p><div class="variablelist"><dl><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Context item</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The first document that appears on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Context position</span></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">1</span></code></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Context size</span></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">1</span></code></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Variable values</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Any parameters passed in the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555"> option augment any implementation-defined variable bindings known to the XQuery processor. </span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Function implementations</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The function implementations provided by the XQuery processor.</span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Current dateTime</span></span></dt><dd><p><a name="impl-26"></a><span class="deltaxml-old" style="background:#FF5555">The point in time returned as the current dateTime is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Implicit timezone</span></span></dt><dd><p><a name="impl-27"></a><span class="deltaxml-old" style="background:#FF5555">The implicit timezone is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Available documents</span></span></dt><dd><p><a name="impl-28"></a><span class="deltaxml-old" style="background:#FF5555">The set of available documents (those that may be retrieved with a URI) is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Available collections</span></span></dt><dd><p><a name="impl-29"></a><span class="deltaxml-old" style="background:#FF5555">The set of available collections is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-dependent"><span class="deltaxml-old" style="background:#FF5555">implementation-dependent</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></dd><dt><span class="term"><span class="deltaxml-old" style="background:#FF5555">Default collection</span></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The sequence of documents provided on the </span><code class="port"><span class="deltaxml-old" style="background:#FF5555">source</span></code><span class="deltaxml-old" style="background:#FF5555"> port. </span></p></dd></dl></div><section id="example-xquery" class="section tocsuppress"><div class="section-titlepage"><h5><span class="deltaxml-old" style="background:#FF5555">2.2.11.1 Example</span></h5></div><p><span class="deltaxml-old" style="background:#FF5555">The following pipeline applies XInclude processing and schema validation before using XQuery:</span></p><figure id="ex.c.xquery" class="example-wrapper"><div class="title"><span class="deltaxml-old" style="background:#FF5555">Example 1. A Sample Pipeline Document</span></div><div class="example"><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:pipeline xmlns:p="http://www.w3.org/ns/xproc" version="1.0"&gt;

&lt;p:xinclude/&gt;

&lt;p:validate-with-xml-schema name="validate"&gt;
  &lt;p:input port="schema"&gt;
    &lt;p:document href="http://example.com/path/to/schema.xsd"/&gt;
  &lt;/p:input&gt;
&lt;/p:validate-with-xml-schema&gt;

&lt;p:xquery&gt;
   &lt;p:input port="query"&gt;
      &lt;p:data href="countp.xq" /&gt;
   &lt;/p:input&gt;
&lt;/p:xquery&gt;

&lt;/p:pipeline&gt;</span></code></pre></div></figure><p><span class="deltaxml-old" style="background:#FF5555">Where </span><code class="filename"><span class="deltaxml-old" style="background:#FF5555">countp.xq</span></code><span class="deltaxml-old" style="background:#FF5555"> might contain:</span></p><pre xml:space="preserve" class="programlisting language-markup line-numbers"><code><span class="deltaxml-old" style="background:#FF5555">&lt;count&gt;{count(.//p)}&lt;/count&gt;</span></code></pre></section></section><section id="c.xsl-formatter" class="section"><div class="section-titlepage"><h4><span class="deltaxml-old" style="background:#FF5555">2.2.12 p:xsl-formatter</span></h4></div><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xsl-formatter</span></code><span class="deltaxml-old" style="background:#FF5555"> step receives an [</span><a href="#xsl11"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">XSL 1.1</span></span></a><span class="deltaxml-old" style="background:#FF5555">] document and renders the content. The result of rendering is stored to the URI provided via the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> option. A reference to that result is produced on the output port.</span></p><p class="element-syntax element-syntax-declare-step-opt"><span class="decl"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:declare-step</span></code><code class="attr type-attr"><span class="deltaxml-old" style="background:#FF5555">type</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value type-value"><span class="deltaxml-old" style="background:#FF5555">p:xsl-formatter</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:input</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">source</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr content-types-attr"><span class="deltaxml-old" style="background:#FF5555">content-types</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value content-types-value"><span class="deltaxml-old" style="background:#FF5555">application/xml text/xml */*+xml</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="input"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:output</span></code><code class="attr port-attr"><span class="deltaxml-old" style="background:#FF5555">port</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value port-value"><span class="deltaxml-old" style="background:#FF5555">result</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">map(xs:QName,item())</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">       </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-req"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">href</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr required-attr"><span class="deltaxml-old" style="background:#FF5555">required</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value required-value"><span class="deltaxml-old" style="background:#FF5555">true</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:anyURI</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">        </span></code></span><span class="deltaxml-old" style="background:#FF5555">     </span><span class="opt-opt"><code><span class="deltaxml-old" style="background:#FF5555">&lt;p:option</span></code><code class="attr name-attr"><span class="deltaxml-old" style="background:#FF5555">name</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value name-value"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code class="attr as-attr"><span class="deltaxml-old" style="background:#FF5555">as</span></code><code><span class="deltaxml-old" style="background:#FF5555">="</span></code><code class="value as-value"><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><code><span class="deltaxml-old" style="background:#FF5555">"</span></code><code><span class="deltaxml-old" style="background:#FF5555">/&gt;</span></code><code><span class="deltaxml-old" style="background:#FF5555">                </span></code></span><code><span class="deltaxml-old" style="background:#FF5555">&lt;/p:declare-step&gt;</span></code></p><p><span class="deltaxml-old" style="background:#FF5555">The value of the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">href</span></code><span class="deltaxml-old" style="background:#FF5555"> option </span><span class="rfc2119" id="c.xsl-formatter.4.2"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. If it is relative, it is made absolute against the base URI of the element on which it is specified (</span><a href="../xproc20/#p.with-option"><span class="deltaxml-old" style="background:#FF5555">p:with-option</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup><span class="deltaxml-old" style="background:#FF5555"> or </span><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">p:xsl-formatter</span></code><span class="deltaxml-old" style="background:#FF5555"> in the case of a </span><span class="xspecref"><a href="../xproc20/#option-shortcut"><span class="deltaxml-old" style="background:#FF5555">syntactic shortcut</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></span><span class="deltaxml-old" style="background:#FF5555"> value).</span></p><p><span class="deltaxml-old" style="background:#FF5555">The content-type of the output is controlled by the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> option. This option specifies a media type as defined by [</span><a href="#media-types"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">IANA Media Types</span></span></a><span class="deltaxml-old" style="background:#FF5555">]. The option may include media type parameters as well (e.g. "application/someformat; charset=UTF-8"). </span><a name="impl-30"></a><span class="deltaxml-old" style="background:#FF5555">The use of media type parameters on the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> option is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><a name="impl-31"></a><span class="deltaxml-old" style="background:#FF5555">If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">content-type</span></code><span class="deltaxml-old" style="background:#FF5555"> option is not specified, the output type is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. The default </span><span class="rfc2119" id="c.xsl-formatter.6.2"><span class="deltaxml-old" style="background:#FF5555">should</span></span><span class="deltaxml-old" style="background:#FF5555"> be PDF.</span></p><p><a name="impl-32"></a><span class="deltaxml-old" style="background:#FF5555">A formatter may take any number of optional rendering parameters via the step's </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">parameters</span></code><span class="deltaxml-old" style="background:#FF5555">; such parameters are defined by the XSL implementation used and are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The output of this step is a document containing a single </span><a href="#cv.result"><code class="tag-element"><span class="deltaxml-old" style="background:#FF5555">c:result</span></code></a><span class="deltaxml-old" style="background:#FF5555"> element whose content is the absolute URI of the document stored by the step.</span></p></section></section><section id="serialization-options" class="section"><div class="section-titlepage"><h3><span class="deltaxml-old" style="background:#FF5555">2.3 Serialization Options</span></h3></div><p><span class="deltaxml-old" style="background:#FF5555">Several steps in this step library require serialization options to control the serialization of XML. These options are used to control serialization as in the [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Serialization</span></span></a><span class="deltaxml-old" style="background:#FF5555">] specification.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The following options may be present on steps that perform serialization:</span></p><div class="variablelist"><dl><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">byte-order-mark</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.1.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean. If it's not specified, the default varies by encoding: for UTF-16 it's true, for all others, it's false.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">cdata-section-elements</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.2.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a list of </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">s. They are interpreted as elements name.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">doctype-public</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.3.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a string. The public identifier of the doctype.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">doctype-system</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.4.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">anyURI</span></code><span class="deltaxml-old" style="background:#FF5555">. The system identifier of the doctype. It need not be absolute, and is not resolved.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">A character set name. </span><a name="impl-33"></a><span class="deltaxml-old" style="background:#FF5555">If no </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, the encoding used is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. If the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">method</span></code><span class="deltaxml-old" style="background:#FF5555"> is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml</span></code><span class="deltaxml-old" style="background:#FF5555">” or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xhtml</span></code><span class="deltaxml-old" style="background:#FF5555">”, the implementation defined encoding </span><span class="rfc2119" id="serialization-options.4.5.2.1.1.6"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be either UTF-8 or UTF-16.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">escape-uri-attributes</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.6.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean. It is ignored unless the specified method is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xhtml</span></code><span class="deltaxml-old" style="background:#FF5555">” or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">html</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">include-content-type</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.7.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean. It is ignored unless the specified method is “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xhtml</span></code><span class="deltaxml-old" style="background:#FF5555">” or “</span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">html</span></code><span class="deltaxml-old" style="background:#FF5555">”.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">indent</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.8.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">media-type</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.9.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a string. It specifies the media type (MIME content type). If not specified, the default varies according to the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">method</span></code><span class="deltaxml-old" style="background:#FF5555">:</span></p><div class="variablelist"><dl><dt><span class="term"><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">application/xml</span></code></p></dd><dt><span class="term"><code class="literal"><span class="deltaxml-old" style="background:#FF5555">html</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text/html</span></code></p></dd><dt><span class="term"><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xhtml</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">application/xhtml+xml</span></code></p></dd><dt><span class="term"><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text</span></code></span></dt><dd><p><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text/plain</span></code></p></dd></dl></div><p><a name="impl-34"></a><span class="deltaxml-old" style="background:#FF5555">For methods other than </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xml</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">html</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">xhtml</span></code><span class="deltaxml-old" style="background:#FF5555">, and </span><code class="literal"><span class="deltaxml-old" style="background:#FF5555">text</span></code><span class="deltaxml-old" style="background:#FF5555">; the </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">media-type</span></code><span class="deltaxml-old" style="background:#FF5555"> is </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">method</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.10.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a </span><code class="type"><span class="deltaxml-old" style="background:#FF5555">QName</span></code><span class="deltaxml-old" style="background:#FF5555">. It specifies the serialization method.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">normalization-form</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.11.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an NMTOKEN, one of the enumerated values </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">NFC</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">NFD</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">NFKC</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">NFKD</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">fully-normalized</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">none</span></code><span class="deltaxml-old" style="background:#FF5555"> or an implementation-defined value.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">omit-xml-declaration</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.12.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">standalone</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.13.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be an NMTOKEN, one of the enumerated values </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">true</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">false</span></code><span class="deltaxml-old" style="background:#FF5555">, or </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">omit</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">undeclare-prefixes</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.14.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a boolean.</span></p></dd><dt><span class="term"><code class="option"><span class="deltaxml-old" style="background:#FF5555">version</span></code></span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The value of this option </span><span class="rfc2119" id="serialization-options.4.15.2.1.1"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a string.</span></p></dd></dl></div><p><span class="deltaxml-old" style="background:#FF5555">In order to be consistent with the rest of this specification, boolean values for the serialization parameters must use one of the XML Schema lexical forms for boolean: "true", "false", "1", or "0". This is different from the [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Serialization</span></span></a><span class="deltaxml-old" style="background:#FF5555">] specification which uses “yes” and “no”. No change in semantics is implied by this different spelling.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="option"><span class="deltaxml-old" style="background:#FF5555">method</span></code><span class="deltaxml-old" style="background:#FF5555"> option controls the serialization method used by this component with standard values of 'html', 'xml', 'xhtml', and 'text' but only the 'xml' value is required to be supported. The interpretation of the remaining options is as specified in [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Serialization</span></span></a><span class="deltaxml-old" style="background:#FF5555">].</span></p><p><a name="impl-35"></a><span class="deltaxml-old" style="background:#FF5555">Implementations may support other method values but their results are </span><em class="glossterm"><a href="../xproc20/#dt-implementation-defined"><span class="deltaxml-old" style="background:#FF5555">implementation-defined</span></a><sup class="xrefspec"><a href="../xproc20/"><span class="deltaxml-old" style="background:#FF5555">XP</span></a></sup></em><span class="deltaxml-old" style="background:#FF5555">. </span></p><p><span class="deltaxml-old" style="background:#FF5555">A minimally conforming implementation must support the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xml</span></code><span class="deltaxml-old" style="background:#FF5555"> output method with the following option values:</span></p><div class="itemizedlist"><ul><li><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">version</span></code><span class="deltaxml-old" style="background:#FF5555"> must support the value </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">1.0</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">encoding</span></code><span class="deltaxml-old" style="background:#FF5555"> must support the values </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">UTF-8</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">The </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">omit-xml-declaration</span></code><span class="deltaxml-old" style="background:#FF5555"> must be supported. If the value is not specified or has the value </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">no</span></code><span class="deltaxml-old" style="background:#FF5555">, an XML declaration must be produced.</span></p></li></ul></div><p><span class="deltaxml-old" style="background:#FF5555">All other option values may be ignored for the </span><code class="code"><span class="deltaxml-old" style="background:#FF5555">xml</span></code><span class="deltaxml-old" style="background:#FF5555"> output method.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If a processor chooses to implement an option for serialization, it must conform to the semantics defined in the [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Serialization</span></span></a><span class="deltaxml-old" style="background:#FF5555">] specification.</span></p><div class="note admonition"><h3><span class="deltaxml-old" style="background:#FF5555">Note</span></h3><p><span class="deltaxml-old" style="background:#FF5555">The use-character-maps parameter in [</span><a href="#xml-serialization"><span class="abbrev"><span class="deltaxml-old" style="background:#FF5555">Serialization</span></span></a><span class="deltaxml-old" style="background:#FF5555">] specification has not been provided in the standard serialization options provided by this specification.</span></p></div></section></section><section id="errors" class="section"><div class="section-titlepage"><h2><span class="deltaxml-old" style="background:#FF5555">3</span><span class="deltaxml-new" style="background:#90EE90">2</span> Errors</h2></div><p>Errors in a pipeline can be divided into two classes: static errors and dynamic errors.</p><section id="static-errors" class="section"><div class="section-titlepage"><h3><span class="deltaxml-old" style="background:#FF5555">3.1</span><span class="deltaxml-new" style="background:#90EE90">2.1</span> Static Errors</h3></div><p><span id="dt-static-error" class="termdef">[Definition: A <em class="glossterm">static error</em> is one which can be detected before pipeline evaluation is even attempted.]</span> Examples of static errors include cycles and incorrect specification of inputs and outputs. </p><p>Static errors are fatal and must be detected before any steps are evaluated.</p><p>For a complete list of static errors, see <a href="../xproc20/#app.static-errors">Section 1, “Static Errors”</a><sup class="xrefspec"><a href="../xproc20/">XP</a></sup>.</p></section><section class="section" id="dynamic-errors"><div class="section-titlepage"><h3><span class="deltaxml-old" style="background:#FF5555">3.2</span><span class="deltaxml-new" style="background:#90EE90">2.2</span> Dynamic Errors</h3></div><p>A <span id="dt-dynamic-error" class="termdef">[Definition: A <em class="glossterm">dynamic error</em> is one which occurs while a pipeline is being evaluated.]</span> Examples of dynamic errors include references to URIs that cannot be resolved, steps which fail, and pipelines that exhaust the capacity of an implementation (such as memory or disk space).</p><p>If a step fails due to a dynamic error, failure propagates upwards until either a <a href="../xproc20/#p.try">p:try</a><sup class="xrefspec"><a href="../xproc20/">XP</a></sup> is encountered or the entire pipeline fails. In other words, outside of a <a href="../xproc20/#p.try">p:try</a><sup class="xrefspec"><a href="../xproc20/">XP</a></sup>, step failure causes the entire pipeline to fail.</p><p>For a complete list of dynamic errors, see <a href="../xproc20/#app.dynamic-errors">Section 2, “Dynamic Errors”</a><sup class="xrefspec"><a href="../xproc20/">XP</a></sup>.</p></section><section class="section" id="step-errors"><div class="section-titlepage"><h3><span class="deltaxml-old" style="background:#FF5555">3.3</span><span class="deltaxml-new" style="background:#90EE90">2.3</span> Step Errors</h3></div><p>Several of the steps in the standard and option step library can generate dynamic errors.</p><p>For a complete list of the dynamic errors raised by builtin pipeline steps, see <a href="#app.step-errors" title="Step Errors">Appendix A, <i>Step Errors</i></a>.</p></section></section><article id="app.step-errors" class="appendix"><header class="appendix-titlepage"><h2>A Step Errors</h2></header><p>The following <em class="glossterm"><a href="#dt-dynamic-error">dynamic errors</a></em> can be raised by steps in this specification:</p><div id="step-error-summary"><h5>Step Errors</h5><dl class="errs"><dt><a name="err.C0002"></a><code class="errqname">err:XC0002</code></dt><dd><p>It is a dynamic error if the value starts with the string “--”.</p><p>See: <a href="#err.inline.C0002">Request Entity body conversion</a></p></dd><dt><a name="err.C0003"></a><code class="errqname">err:XC0003</code></dt><dd><p>It is a dynamic error if a username or password is specified without specifying an auth-method, if the requested auth-method isn't supported, or the authentication challenge contains an authentication method that isn't supported.</p><p>See: <a href="#err.inline.C0003">Specifying a request</a></p></dd><dt><a name="err.C0004"></a><code class="errqname">err:XC0004</code></dt><dd><p>It is a dynamic error if the status-only attribute has the value true and the detailed attribute does not have the value true.</p><p>See: <a href="#err.inline.C0004">Specifying a request</a></p></dd><dt><a name="err.C0005"></a><code class="errqname">err:XC0005</code></dt><dd><p>It is a dynamic error if the request contains a c:body or c:multipart but the method does not allow for an entity body being sent with the request.</p><p>See: <a href="#err.inline.C0005">Specifying a request</a></p></dd><dt><a name="err.C0006"></a><code class="errqname">err:XC0006</code></dt><dd><p>It is a dynamic error if the method is not specified on a c:request. </p><p>See: <a href="#err.inline.C0006">Specifying a request</a></p></dd><dt><a name="err.C0010"></a><code class="errqname">err:XC0010</code></dt><dd><p>It is a dynamic error if an encoding of base64 is specified and the character set is not specified or if the specified character set is not supported by the implementation.</p><p>See: <a href="#err.inline.C0010">p:unescape-markup</a></p></dd><dt><a name="err.C0012"></a><code class="errqname">err:XC0012</code></dt><dd><p>It is a dynamic error if the contents of the directory path are not available to the step due to access restrictions in the environment in which the pipeline is run.</p><p>See: <a href="#err.inline.C0012">p:directory-list</a></p></dd><dt><a name="err.C0013"></a><code class="errqname">err:XC0013</code></dt><dd><p>It is a dynamic error if the pattern matches a processing instruction and the new name has a non-null namespace.</p><p>See: <a href="#err.inline.C0013">p:rename</a></p></dd><dt><a name="err.C0014"></a><code class="errqname">err:XC0014</code></dt><dd><p>It is a dynamic error if the XML namespace (http://www.w3.org/XML/1998/namespace) or the XMLNS namespace (http://www.w3.org/2000/xmlns/) is the value of either the from option or the to option.</p><p>See: <a href="#err.inline.C0014">p:namespace-rename</a></p></dd><dt><a name="err.C0017"></a><code class="errqname">err:XC0017</code></dt><dd><p>It is a dynamic error if the absolute path does not identify a directory.</p><p>See: <a href="#err.inline.C0017">p:directory-list</a></p></dd><dt><a name="err.C0019"></a><code class="errqname">err:XC0019</code></dt><dd><p>It is a dynamic error if the documents are not equal, and the value of the fail-if-not-equal option is true.</p><p>See: <a href="#err.inline.C0019">p:compare</a></p></dd><dt><a name="err.C0020"></a><code class="errqname">err:XC0020</code></dt><dd><p>It is a dynamic error if the the user specifies a value or values that are inconsistent with each other or with the requirements of the step or protocol.</p><p>See: <a href="#err.inline.C0020">Specifying a request</a></p></dd><dt><a name="err.C0022"></a><code class="errqname">err:XC0022</code></dt><dd><p>it is a dynamic error if the content of the c:body element does not consist of exactly one element, optionally preceded and/or followed by any number of processing instructions, comments or whitespace characters</p><p>See: <a href="#err.inline.C0022">Request Entity body conversion</a></p></dd><dt><a name="err.C0023"></a><code class="errqname">err:XC0023</code></dt><dd><p>It is a dynamic error if the match pattern does not match an element.</p><p>See: <a href="#err.inline.C0023">p:add-attribute</a>, <a href="#err.inline.C0023.1">p:insert</a>, <a href="#err.inline.C0023.2">p:label-elements</a>, <a href="#err.inline.C0023.3">p:make-absolute-uris</a>, <a href="#err.inline.C0023.4">p:rename</a>, <a href="#err.inline.C0023.5">p:replace</a>, <a href="#err.inline.C0023.6">p:set-attributes</a>, <a href="#err.inline.C0023.7">p:unwrap</a>, <a href="#err.inline.C0023.8">p:wrap</a></p></dd><dt><a name="err.C0025"></a><code class="errqname">err:XC0025</code></dt><dd><p>It is a dynamic error if the match pattern matches anything other than an element node and the value of the position option is “first-child” or “last-child”.</p><p>See: <a href="#err.inline.C0025">p:insert</a></p></dd><dt><a name="err.C0026"></a><code class="errqname">err:XC0026</code></dt><dd><p>It is a dynamic error if any XPath expression makes reference to the context node, size, or position when the context item is undefined.</p><p>See: <a href="#err.inline.C0026">p:template</a></p></dd><dt><a name="err.C0027"></a><code class="errqname">err:XC0027</code></dt><dd><p>It is a dynamic error if the document is not valid or the step doesn't support DTD validation.</p><p>See: <a href="#err.inline.C0027">p:load</a></p></dd><dt><a name="err.C0028"></a><code class="errqname">err:XC0028</code></dt><dd><p>it is a dynamic error if the content of the c:body element does not consist entirely of characters</p><p>See: <a href="#err.inline.C0028">Request Entity body conversion</a></p></dd><dt><a name="err.C0029"></a><code class="errqname">err:XC0029</code></dt><dd><p>It is a dynamic error if an XInclude error occurs during processing.</p><p>See: <a href="#err.inline.C0029">p:xinclude</a></p></dd><dt><a name="err.C0030"></a><code class="errqname">err:XC0030</code></dt><dd><p>It is a dynamic error if the override-content-type value cannot be used (e.g. text/plain to override image/png).</p><p>See: <a href="#err.inline.C0030">Managing the response</a></p></dd><dt><a name="err.C0033"></a><code class="errqname">err:XC0033</code></dt><dd><p>It is a dynamic error if the command cannot be run.</p><p>See: <a href="#err.inline.C0033">p:exec</a></p></dd><dt><a name="err.C0034"></a><code class="errqname">err:XC0034</code></dt><dd><p>It is a dynamic error if the current working directory cannot be changed to the value of the cwd option.</p><p>See: <a href="#err.inline.C0034">p:exec</a></p></dd><dt><a name="err.C0035"></a><code class="errqname">err:XC0035</code></dt><dd><p>It is a dynamic error to specify both result-is-xml and wrap-result-lines.</p><p>See: <a href="#err.inline.C0035">p:exec</a></p></dd><dt><a name="err.C0036"></a><code class="errqname">err:XC0036</code></dt><dd><p>It is a dynamic error if the requested hash algorithm is not one that the processor understands or if the value or parameters are not appropriate for that algorithm.</p><p>See: <a href="#err.inline.C0036">p:hash</a></p></dd><dt><a name="err.C0037"></a><code class="errqname">err:XC0037</code></dt><dd><p>It is a dynamic error if the value provided is not a properly x-www-form-urlencoded value.</p><p>See: <a href="#err.inline.C0037">p:www-form-urldecode</a></p></dd><dt><a name="err.C0038"></a><code class="errqname">err:XC0038</code></dt><dd><p>It is a dynamic error if the specified version is not available.</p><p>See: <a href="#err.inline.C0038">p:xslt</a>, <a href="#err.inline.C0038.1">p:validate-with-xml-schema</a>, <a href="#err.inline.C0038.2">p:xquery</a></p></dd><dt><a name="err.C0039"></a><code class="errqname">err:XC0039</code></dt><dd><p>It is a dynamic error if a sequence of documents (including an empty sequence) is provided to an XSLT 1.0 step.</p><p>See: <a href="#err.inline.C0039">p:xslt</a></p></dd><dt><a name="err.C0040"></a><code class="errqname">err:XC0040</code></dt><dd><p>It is a dynamic error if the document element of the document that arrives on the source port is not c:request.</p><p>See: <a href="#err.inline.C0040">p:http-request</a></p></dd><dt><a name="err.C0050"></a><code class="errqname">err:XC0050</code></dt><dd><p>It is a dynamic error if the URI scheme is not supported or the step cannot store to the specified location.</p><p>See: <a href="#err.inline.C0050">p:store</a></p></dd><dt><a name="err.C0051"></a><code class="errqname">err:XC0051</code></dt><dd><p>It is a dynamic error if the content-type specified is not supported by the implementation.</p><p>See: <a href="#err.inline.C0051">p:unescape-markup</a></p></dd><dt><a name="err.C0052"></a><code class="errqname">err:XC0052</code></dt><dd><p>It is a dynamic error if the encoding specified is not supported by the implementation.</p><p>See: <a href="#err.inline.C0052">Request Entity body conversion</a>, <a href="#err.inline.C0052.1">p:unescape-markup</a></p></dd><dt><a name="err.C0053"></a><code class="errqname">err:XC0053</code></dt><dd><p>It is a dynamic error if the assert-valid option is true and the input document is not valid.</p><p>See: <a href="#err.inline.C0053">p:validate-with-relax-ng</a>, <a href="#err.inline.C0053.1">p:validate-with-xml-schema</a></p></dd><dt><a name="err.C0054"></a><code class="errqname">err:XC0054</code></dt><dd><p>It is a dynamic error if the assert-valid option is true and any Schematron assertions fail.</p><p>See: <a href="#err.inline.C0054">p:validate-with-schematron</a></p></dd><dt><a name="err.C0055"></a><code class="errqname">err:XC0055</code></dt><dd><p>It is a dynamic error if the implementation does not support the specified mode.</p><p>See: <a href="#err.inline.C0055">p:validate-with-xml-schema</a></p></dd><dt><a name="err.C0056"></a><code class="errqname">err:XC0056</code></dt><dd><p>It is a dynamic error if the specified initial mode or named template cannot be applied to the specified stylesheet.</p><p>See: <a href="#err.inline.C0056">p:xslt</a></p></dd><dt><a name="err.C0057"></a><code class="errqname">err:XC0057</code></dt><dd><p>It is a dynamic error if the sequence that results from evaluating the XQuery contains items other than documents and elements.</p><p>See: <a href="#err.inline.C0057">p:xquery</a></p></dd><dt><a name="err.C0058"></a><code class="errqname">err:XC0058</code></dt><dd><p>It is a dynamic error if the all and relative options are both true.</p><p>See: <a href="#err.inline.C0058">p:add-xml-base</a></p></dd><dt><a name="err.C0059"></a><code class="errqname">err:XC0059</code></dt><dd><p>It is a dynamic error if the QName value in the attribute-name option uses the prefix “xmlns” or any other prefix that resolves to the namespace name “http://www.w3.org/2000/xmlns/”. </p><p>See: <a href="#err.inline.C0059">p:add-attribute</a></p></dd><dt><a name="err.C0060"></a><code class="errqname">err:XC0060</code></dt><dd><p>It is a dynamic error if the processor does not support the specified version of the UUID algorithm.</p><p>See: <a href="#err.inline.C0060">p:uuid</a></p></dd><dt><a name="err.C0061"></a><code class="errqname">err:XC0061</code></dt><dd><p>It is a dynamic error if the name of any encoded parameter name is not a valid xs:NCName.</p><p>See: <a href="#err.inline.C0061">p:www-form-urldecode</a></p></dd><dt><a name="err.C0062"></a><code class="errqname">err:XC0062</code></dt><dd><p>It is a dynamic error if the match option matches a namespace node.</p><p>See: <a href="#err.inline.C0062">p:delete</a></p></dd><dt><a name="err.C0063"></a><code class="errqname">err:XC0063</code></dt><dd><p>It is a dynamic error if the path-separator option is specified and is not exactly one character long.</p><p>See: <a href="#err.inline.C0063">p:exec</a></p></dd><dt><a name="err.C0064"></a><code class="errqname">err:XC0064</code></dt><dd><p>It is a dynamic error if the exit code from the command is greater than the specified failure-threshold value.</p><p>See: <a href="#err.inline.C0064">p:exec</a></p></dd><dt><a name="err.C0066"></a><code class="errqname">err:XC0066</code></dt><dd><p>It is a dynamic error if the arg-separator option is specified and is not exactly one character long.</p><p>See: <a href="#err.inline.C0066">p:exec</a></p></dd><dt><a name="err.C0067"></a><code class="errqname">err:XC0067</code></dt><dd><p>It is a dynamic error to encounter a single closing curly brace “}” that is not immediately followed by another closing curly brace.</p><p>See: <a href="#err.inline.C0067">p:template</a>, <a href="#err.inline.C0067.1">p:template</a>, <a href="#err.inline.C0067.2">p:template</a></p></dd><dt><a name="err.C0068"></a><code class="errqname">err:XC0068</code></dt><dd><p>It is a dynamic error if more than one document appears on the source port.</p><p>See: <a href="#err.inline.C0068">p:template</a></p></dd><dt><a name="err.C1001"></a><code class="errqname">err:XC1001</code></dt><dd><p>It is a dynamic error if the properties map contains a key equal to the string “content-type”.</p><p>See: <a href="#err.inline.C1001">p:set-properties</a></p></dd><dt><a name="err.C1002"></a><code class="errqname">err:XC1002</code></dt><dd><p>It is a dynamic error if the supplied content-type is not a valid media type of the form “type/subtype+ext”.</p><p>See: <a href="#err.inline.C1002">p:cast-content-type</a></p></dd><dt><a name="err.C1003"></a><code class="errqname">err:XC1003</code></dt><dd><p>It is a dynamic error if the p:cast-content-type step cannot perform the requested cast.</p><p>See: <a href="#err.inline.C1003">p:cast-content-type</a></p></dd><dt><a name="err.C1004"></a><code class="errqname">err:XC1004</code></dt><dd><p>It is a dynamic error if the c:data contains content is not a valid base64 string.</p><p>See: <a href="#err.inline.C1004">p:cast-content-type</a></p></dd><dt><a name="err.C1005"></a><code class="errqname">err:XC1005</code></dt><dd><p>It is a dynamic error if the c:data element does not have a content-type attribute.</p><p>See: <a href="#err.inline.C1005">p:cast-content-type</a></p></dd><dt><a name="err.C1006"></a><code class="errqname">err:XC1006</code></dt><dd><p>It is a dynamic error if the content-type is supplied and is not the same as the content-type specified on the c:data element.</p><p>See: <a href="#err.inline.C1006">p:cast-content-type</a></p></dd><dt><a name="err.C1007"></a><code class="errqname">err:XC1007</code></dt><dd><p>In all cases except when the input document is a c:data element, it is a dynamic error if the content-type is not supplied.</p><p>See: <a href="#err.inline.C1007">p:cast-content-type</a></p></dd></dl></div></article><article id="references" class="appendix"><header class="appendix-titlepage"><h2>B References</h2></header><section class="section" id="normative-references"><div class="section-titlepage"><h2>1 Normative References</h2></div><div class="bibliolist"><div id="xproc20" class="bibliomixed"><p><span class="deltaxml-new" style="background:#90EE90">[</span><span class="abbrev"><span class="deltaxml-new" style="background:#90EE90">XProc 2.0</span></span><span class="deltaxml-new" style="background:#90EE90">] </span><a href="http://www.w3.org/TR/xproc20/"><span class="citetitle"><cite><span class="deltaxml-new" style="background:#90EE90">XProc 2.0: An XML Pipeline Language</span></cite></span></a><span class="deltaxml-new" style="background:#90EE90">. Norman Walsh, Alex Milowski, and Henry Thompson, editors. W3C Working Draft 15 December 2014. </span></p></div><div id="xslt10" class="bibliomixed"><p>[<span class="abbrev">XSLT 1.0</span>] <a href="http://www.w3.org/TR/xslt"><span class="citetitle"><cite>XSL Transformations (XSLT) Version 1.0</cite></span></a>. James Clark, editor. W3C Recommendation. 16 November 1999.</p></div><div id="xpath-functions" class="bibliomixed"><p>[<span class="abbrev">XPath 2.0 Functions and Operators</span>] <a href="http://www.w3.org/TR/xpath-functions/"><span class="citetitle"><cite>XQuery 1.0 and XPath 2.0 Functions and Operators</cite></span></a>. Ashok Malhotra, Jim Melton, and Norman Walsh, editors. W3C Recommendation. 23 January 2007.</p></div><div id="xslt20" class="bibliomixed"><p>[<span class="abbrev">XSLT 2.0</span>] <a href="http://www.w3.org/TR/xslt20/"><span class="citetitle"><cite>XSL Transformations (XSLT) Version 2.0</cite></span></a>. Michael Kay, editor. W3C Recommendation. 23 January 2007.</p></div><div id="xsl11" class="bibliomixed"><p>[<span class="abbrev">XSL 1.1</span>] <a href="http://www.w3.org/TR/xsl/"><span class="citetitle"><cite>Extensible Stylesheet Language (XSL) Version 1.1</cite></span></a>. Anders Berglund, editor. W3C Recommendation. 5 December 2006.</p></div><div id="xquery10" class="bibliomixed"><p>[<span class="abbrev">XQuery 1.0</span>] <a href="http://www.w3.org/TR/xquery/"><span class="citetitle"><cite>XQuery 1.0: An XML Query Language</cite></span></a>. Scott Boag, Don Chamberlin, Mary Fernández, et. al., editors. W3C Recommendation. 23 January 2007.</p></div><div id="iso19757-2" class="bibliomixed"><p>[<span class="abbrev">RELAX NG</span>] ISO/IEC JTC 1/SC 34. <a href="http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=52348"><span class="citetitle"><cite>ISO/IEC 19757-2:2008(E) Document Schema Definition Language (DSDL) -- Part 2: Regular-grammar-based validation -- RELAX NG</cite></span></a> 2008. </p></div><div id="relaxng-compact-syntax" class="bibliomixed"><p>[<span class="abbrev">RELAX NG Compact Syntax</span>] ISO/IEC JTC 1/SC 34. <span class="citetitle"><cite>ISO/IEC 19757-2:2003/Amd 1:2006 Document Schema Definition Languages (DSDL) — Part 2: Grammar-based validation — RELAX NG AMENDMENT 1 Compact Syntax</cite></span> 2006. </p></div><div id="relaxng-dtd-compat" class="bibliomixed"><p>[<span class="abbrev">RELAX NG DTD Compatibility</span>] <span class="citetitle"><cite>RELAX NG DTD Compatibility</cite></span>. OASIS Committee Specification. 3 December 2001. </p></div><div id="iso19757-3" class="bibliomixed"><p>[<span class="abbrev">Schematron</span>] ISO/IEC JTC 1/SC 34. <span class="citetitle"><cite>ISO/IEC 19757-3:2006(E) Document Schema Definition Languages (DSDL) — Part 3: Rule-based validation — Schematron</cite></span> 2006. </p></div><div id="xmlschema-1" class="bibliomixed"><p>[<span class="abbrev">W3C XML Schema: Part 1</span>] <a href="http://www.w3.org/TR/xmlschema-1/"><span class="citetitle"><cite>XML Schema Part 1: Structures Second Edition</cite></span></a>. Henry S. Thompson, David Beech, Murray Maloney, et. al., editors. World Wide Web Consortium, 28 October 2004. </p></div><div id="xinclude" class="bibliomixed"><p>[<span class="abbrev">XInclude</span>] <a href="http://www.w3.org/TR/xinclude/"><span class="citetitle"><cite>XML Inclusions (XInclude) Version 1.0 (Second Edition)</cite></span></a>. Jonathan Marsh, David Orchard, and Daniel Veillard, editors. W3C Recommendation. 15 November 2006.</p></div><div id="xml-serialization" class="bibliomixed"><p>[<span class="abbrev">Serialization</span>] <a href="http://www.w3.org/TR/xslt-xquery-serialization/"><span class="citetitle"><cite>XSLT 2.0 and XQuery 1.0 Serialization</cite></span></a>. Scott Boag, Michael Kay, Joanne Tong, Norman Walsh, and Henry Zongaro, editors. W3C Recommendation. 23 January 2007.</p></div><div id="rfc1321" class="bibliomixed"><p>[<span class="abbrev">MD5</span>] <a href="http://www.ietf.org/rfc/rfc1321.txt"><span class="citetitle"><cite>RFC 1321: The MD5 Message-Digest Algorithm</cite></span></a>. R. Rivest. Network Working Group, IETF, April 1992.</p></div><div id="rfc1521" class="bibliomixed"><p>[<span class="abbrev">RFC 1521</span>] <a href="http://www.ietf.org/rfc/rfc1521.txt"><span class="citetitle"><cite>RFC 1521: MIME (Multipurpose Internet Mail Extensions) Part One: Mechanisms for Specifying and Describing the Format of Internet Message Bodies</cite></span></a>. N. Borenstein, N. Freed, editors. Internet Engineering Task Force. September, 1993.</p></div><div id="rfc2616" class="bibliomixed"><p>[<span class="abbrev">RFC 2616</span>] <a href="http://www.ietf.org/rfc/rfc2616.txt"><span class="citetitle"><cite>RFC 2616: Hypertext Transfer Protocol — HTTP/1.1</cite></span></a>. R. Fielding, J. Gettys, J. Mogul, et. al., editors. Internet Engineering Task Force. June, 1999.</p></div><div id="rfc2617" class="bibliomixed"><p>[<span class="abbrev">RFC 2617</span>] <a href="http://www.ietf.org/rfc/rfc2617.txt"><span class="citetitle"><cite>RFC 2617: HTTP Authentication: Basic and Digest Access Authentication</cite></span></a>. J. Franks, P. Hallam-Baker, J. Hostetler, S. Lawrence, P. Leach, A. Luotonen, L. Stewart. June, 1999 .</p></div><div id="unicodetr17" class="bibliomixed"><p>[<span class="abbrev">Unicode TR#17</span>] <a href="http://unicode.org/reports/tr17/"><span class="citetitle"><cite>Unicode Technical Report #17: Character Encoding Model</cite></span></a>. Ken Whistler, Mark Davis, and Asmus Freytag, authors. The Unicode Consortium. 11 November 2008.</p></div><div id="media-types" class="bibliomixed"><p>[<span class="abbrev">IANA Media Types</span>] <a href="http://www.iana.org/assignments/media-types/"><span class="citetitle"><cite>IANA MIME Media Types</cite></span></a>. Internet Engineering Task Force. </p></div><div id="tidy" class="bibliomixed"><p>[<span class="abbrev">HTML Tidy</span>] <a href="http://tidy.sourceforge.net/"><span class="citetitle"><cite>HTML Tidy Library Project</cite></span></a>. SourceForge project. </p></div><div id="tagsoup" class="bibliomixed"><p>[<span class="abbrev">TagSoup</span>] <a href="http://ccil.org/~cowan/XML/tagsoup/"><span class="citetitle"><cite>TagSoup - Just Keep On Truckin'</cite></span></a>. John Cowan. </p></div><div id="bib.uuid" class="bibliomixed"><p>[<span class="abbrev">UUID</span>] <a href="http://www.itu.int/ITU-T/studygroups/com17/oid.html"><span class="citetitle"><cite>ITU X.667: Information technology - Open Systems Interconnection - Procedures for the operation of OSI Registration Authorities: Generation and registration of Universally Unique Identifiers (UUIDs) and their use as ASN.1 Object Identifier components</cite></span></a>. 2004.</p></div><div id="bib.sha" class="bibliomixed"><p>[<span class="abbrev">SHA1</span>] <a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm"><span class="citetitle"><cite>Federal Information Processing Standards Publication 180-1: Secure Hash Standard</cite></span></a>. 1995.</p></div></div></section><section id="informative-references" class="section"><div class="section-titlepage"><h2>2 Informative References</h2></div><div class="bibliolist"><div id="bib.crc" class="bibliomixed"><p>[<span class="abbrev">CRC32</span>] “32-Bit Cyclic Redundancy Codes for Internet Applications”, <span class="citetitle"><cite>The International Conference on Dependable Systems and Networks: 459</cite></span>. <span class="biblioid">10.1109/DSN.2002.1028931</span>. P. Koopman. June 2002. </p></div></div></section></article></div><script src="prism.js"></script></body></html>